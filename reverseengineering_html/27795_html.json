{
    "title": "ARM Cortex-M0 - How to either (non-intrusively) extract firmware or modify downloadable firmware (NuMicro NUC126)",
    "link": "https://reverseengineering.stackexchange.com/questions/27795/arm-cortex-m0-how-to-either-non-intrusively-extract-firmware-or-modify-downl",
    "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  As a hands-on introduction into RE, I've decided to take on a small, simple embedded device. In hindsight, it was probably a mistake. This \"project\" has consumed me for about 2 weeks. However, I'm determined to see this through, by god.\n </p>\n <p>\n  <strong>\n   Here's what I've got so far:\n  </strong>\n </p>\n <ul>\n  <li>\n   <p>\n    The brain of the device is a NuMicro NUC126 (Cortex-M0) microcontroller. (\n    <a href=\"https://www.nuvoton.com/export/resource-files/DS_NUC126_Series_EN_Rev1.04.pdf\" rel=\"nofollow noreferrer\">\n     datasheet\n    </a>\n    )\n   </p>\n  </li>\n  <li>\n   <p>\n    The device also houses a BY25Q64ASSIG SPI NOR Flash (irrelevant?) (\n    <a href=\"https://datasheet.lcsc.com/szlcsc/2001181032_BOYAMICRO-BY25Q64ASSIG-T_C484306.pdf\" rel=\"nofollow noreferrer\">\n     datasheet\n    </a>\n    )\n   </p>\n  </li>\n  <li>\n   <p>\n    The firmware download is a single .bin file (available if requested).\n   </p>\n  </li>\n  <li>\n   <p>\n    The firmware is loaded to the device over USB via the (custom?) device-in-question vendor's ISP tool. (\n    <a href=\"https://www.nuvoton.com/tool-and-software/software-development-tool/programmer/\" rel=\"nofollow noreferrer\">\n     official non-vendor tool\n    </a>\n    ).\n    <em>\n     Even the source is available for the ISP tool.\n    </em>\n   </p>\n  </li>\n  <li>\n   <p>\n    Output of\n    <code>\n     binwalk -B\n    </code>\n    :\n    <em>\n     97640 0x17D68 CRC32 polynomial table, little endian\n    </em>\n    . Nothing else.\n   </p>\n  </li>\n  <li>\n   <p>\n    <code>\n     binwalk -E\n    </code>\n    indicates no compression/encryption:\n   </p>\n   <p>\n    <a href=\"https://i.sstatic.net/bDUOD.png\" rel=\"nofollow noreferrer\">\n     <img alt=\"binwalk\" src=\"https://i.sstatic.net/bDUOD.png\"/>\n    </a>\n   </p>\n   <p>\n    as does binvis.io:\n   </p>\n   <p>\n    <a href=\"https://i.sstatic.net/jzTAo.png\" rel=\"nofollow noreferrer\">\n     <img alt=\"enter image description here\" src=\"https://i.sstatic.net/jzTAo.png\"/>\n    </a>\n   </p>\n  </li>\n  <li>\n   <p>\n    <code>\n     strings\n    </code>\n    indeed finds strings visible when using the device\n   </p>\n  </li>\n  <li>\n   <p>\n    <code>\n     dfu-util -l\n    </code>\n    and\n    <code>\n     dfu-util -d <VID:PID>\n    </code>\n    doesn't appear to be able to find the device, which tells me that it does not utilize DFU. Even more likely, I'm just using it wrong. Perhaps the ISP tool puts it into DFU mode before flashing? I was hoping to perhaps extract the firmware this way.\n   </p>\n  </li>\n  <li>\n   <p>\n    Applied segment maps in IDA, aligned vectors, analyzed at reset vector, ???, no profit (yet).\n   </p>\n  </li>\n </ul>\n <p>\n  <strong>\n   My intentions:\n  </strong>\n </p>\n <p>\n  The device comes with 3 \"themes\". I either want to replace/edit, or add more. The problem is, while I (think I) have disassembled the firmware correctly, as noted above, I don't know where to go from there.\n </p>\n <p>\n  <strong>\n   Questions:\n  </strong>\n </p>\n <ol>\n  <li>\n   Since I feel like I'm (somewhat) close to a solution, is there something I'm missing? Reading assembly, sure. But I mean, are the themes simply bitmap style images? Are they vector? How would I know? After scanning the file using a resource extractor, it didn't find any embedded images. Though I'm curious as to whether disassembling the downloaded firmware would yield the same results as if I were to actually pull the firmware from the chip and disassembling it that way.\n  </li>\n  <li>\n   Is JTAG/UART absolutely necessary? The reason I ask is because practically all guides I've found utilize something similar. I've looked into OpenOCD, Segger, etc. and I'm really trying to avoid purchasing extra stuff, but will if necessary.\n  </li>\n </ol>\n <hr/>\n <p>\n  Thank you all for the help! If you require more information, please ask!\n </p>\n</div>\n</body></html>",
    "votes": "1",
    "answers": 0,
    "views": "509",
    "tags": [
        "firmware",
        "arm",
        "patching",
        "embedded"
    ],
    "user": "Steve",
    "time": "Jun 6, 2021 at 2:38",
    "comments": [
        {
            "user": "Karol Kowalewski",
            "text": "<html><body><span class=\"comment-copy\">\n hello I've been working on this for a year, and I can't find anything meaningful. the only thing i did you have below\n <a href=\"https://www.youtube.com/watch?v=1659stkBegE&t=40s\" rel=\"nofollow noreferrer\">\n  youtube.com/watch?v=1659stkBegE&t=40s\n </a>\n</span>\n</body></html>",
            "time": null
        }
    ],
    "answers_data": []
}