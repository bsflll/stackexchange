{
    "title": "Problem with deobfuscation .NET-file, protected with XerinObfuscator, Anti-dnSpy and Anti-Debug",
    "link": "https://reverseengineering.stackexchange.com/questions/33412/problem-with-deobfuscation-net-file-protected-with-xerinobfuscator-anti-dnspy",
    "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  I am trying to analyze a .NET file that I suspect is malicious. The file is protected by XerinObfuscator and also has Anti-dnSpy and Anti-debug protection. I tried to use de4dot to deobfuscate it, but encountered an error. Here are the details: (Sorry for my english)\n </p>\n <p>\n  File info:\n </p>\n <pre><code>File name: WIN.exe\nFile size: 10.24 MB\nBase address: 0000000000400000\nEntry point: 0000000000400000\nMIME type: application/x-dosexec\n</code></pre>\n <p>\n  Protection and obfuscation:\n </p>\n <pre><code>Obfuscator: XerinObfuscator\nProtection:\n    Anti-debug\n    Anti-dnSpy\n    Obfuscation (Modified EP + CLR constructor + Strange EP position + Strange sections)\n    Packer: Compressed or packed data (High entropy + Section 0 compressed)\n</code></pre>\n <p>\n  Tools used:\n </p>\n <pre><code>de4dot: An error occurs when attempting to deobfuscate:\n    Copy\n\n    Unhandled exception: System.ApplicationException: Invalid new target, it's null\n    in de4dot.blocks.Block.ReplaceLastInstrsWithBranch(Int32 numInstrs, Block target)\n\n    The file is recognized as protected by an unknown obfuscator, but the deobfuscation terminates with an error.\n\nDetect It Easy: Confirms the presence of obfuscation and protection mechanisms.\n\n    Additional details:\n\n        Linker: Microsoft Linker\n        Language: C#\n        Libraries: .NET Framework 4.8, Costura.Fody, Guna UI\n        Tool: Visual Studio\n        Protectors: ByteGuard, XerinObfuscator\n</code></pre>\n <p>\n  What I tried:\n </p>\n <ul>\n  <li>\n   Using de4dot (de4dot-cex).\n  </li>\n  <li>\n   Using dnSpy (but the file has Anti-dnSpy protection, and I got many errors).\n  </li>\n  <li>\n   Using ExtremeDumper, the file closes immediately even if I open it without other programs running.\n  </li>\n  <li>\n   Analyzed via VirusTotal - see\n   <a href=\"https://www.virustotal.com/gui/file/b7d7b3ffcff7b9574369aa9af6e9f155861f9bcf3c55434c8b89a6ffef6f8d6f\" rel=\"nofollow noreferrer\">\n    https://www.virustotal.com/gui/file/b7d7b3ffcff7b9574369aa9af6e9f155861f9bcf3c55434c8b89a6ffef6f8d6f\n   </a>\n  </li>\n  <li>\n   Analyzing via Install and Follow in Uninstall Tool (Found only that the file saves the screenshot to a randomly named folder in the images folder and has a random name and .jpeg format).\n  </li>\n </ul>\n <p>\n  Question:\n </p>\n <ul>\n  <li>\n   Is there any way to bypass XerinObfuscator and Anti-dnSpy protection?\n  </li>\n  <li>\n   What tools or methods can be used to deobfuscate such a file?\n  </li>\n  <li>\n   How can I analyze the behavior of a program if it is protected by Anti-debug?\n  </li>\n </ul>\n <p>\n  Additional information:\n </p>\n <ul>\n  <li>\n   The file is probably malicious (stiller) as it saves screenshots to a hidden folder.\n  </li>\n  <li>\n   Screenshot from DIE:\n   <a href=\"https://ibb.co/cH70Kb7\" rel=\"nofollow noreferrer\">\n    https://ibb.co/cH70Kb7\n   </a>\n  </li>\n  <li>\n   On the\n   <a href=\"https://github.com/SmokeLoader/Xerin-v3.0.0.29\" rel=\"nofollow noreferrer\">\n    Xerin's Github\n   </a>\n   , I found a Telegram channel where there was a link to some stiller, and the author (Repo's author) is SmokeLoader.\n  </li>\n  <li>\n   Screenshot with errors and files that dnSpy was able to get (I apologize that in Russian):\n   <a href=\"https://ibb.co/HLr3ZQsH\" rel=\"nofollow noreferrer\">\n    https://ibb.co/HLr3ZQsH\n   </a>\n   ,\n   <a href=\"https://ibb.co/W4kZS957\" rel=\"nofollow noreferrer\">\n    https://ibb.co/W4kZS957\n   </a>\n   .\n  </li>\n  <li>\n   File download (30 days):\n   <a href=\"https://easyupload.io/ht0xzt\" rel=\"nofollow noreferrer\">\n    https://easyupload.io/ht0xzt\n   </a>\n  </li>\n  <li>\n   File found in Telegram channel -\n   <a href=\"https://t.me/+KxxtvBVmA25mYzhi\" rel=\"nofollow noreferrer\">\n    https://t.me/+KxxtvBVmA25mYzhi\n   </a>\n   (@SATURN_SOFTWARE), message link -\n   <a href=\"https://t.me/c/2053026588/8893\" rel=\"nofollow noreferrer\">\n    https://t.me/c/2053026588/8893\n   </a>\n  </li>\n  <li>\n   .NET Deobfuscators list -\n   <a href=\"https://github.com/NotPrab/.NET-Deobfuscator\" rel=\"nofollow noreferrer\">\n    https://github.com/NotPrab/.NET-Deobfuscator\n   </a>\n  </li>\n </ul>\n</div>\n</body></html>",
    "votes": "0",
    "answers": 0,
    "views": "44",
    "tags": [
        "windows",
        "debugging",
        "malware",
        "deobfuscation",
        ".net"
    ],
    "user": "Nazar",
    "time": "Mar 31 at 11:45",
    "comments": [],
    "answers_data": []
}