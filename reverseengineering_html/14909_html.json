{
    "title": "How to display .text section of a PE in radare2?",
    "link": "https://reverseengineering.stackexchange.com/questions/14909/how-to-display-text-section-of-a-pe-in-radare2",
    "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  I used\n  <code>\n   rabin2 -Sr myfilename\n  </code>\n  to get the size of the\n  <code>\n   .text\n  </code>\n  section of\n  <code>\n   myfilename\n  </code>\n  .\n </p>\n <p>\n  But, how can I dump the whole hexadecimal section of the\n  <code>\n   .text\n  </code>\n  onto an output file? My purpose is to read the byte code of the\n  <code>\n   .text\n  </code>\n  section of a PE file.\n </p>\n</div>\n</body></html>",
    "votes": "2",
    "answers": 2,
    "views": "6k",
    "tags": [
        "pe",
        "radare2"
    ],
    "user": "lsamarahan",
    "time": "Mar 15, 2017 at 10:36",
    "comments": [
        {
            "user": "lsamarahan",
            "text": "<html><body><span class=\"comment-copy\">\n I managed to use 'pxw', but when I extract it to a text file, all the lines concatenated. How to keep the same display in a text file? Thanks.\n</span>\n</body></html>",
            "time": null
        }
    ],
    "answers_data": [
        {
            "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  In fact, this is quite easy:\n </p>\n <ol>\n  <li>\n   <p>\n    First list the sections with\n    <code>\n     S\n    </code>\n    (see\n    <code>\n     S?\n    </code>\n    to know all the commands about the sections).\n   </p>\n   <pre><code>[0x00005430]> S\n[00] . 0x00000238 -r-- va=0x00000238 sz=0x001c vsz=0x001c .interp\n[01] . 0x00000254 -r-- va=0x00000254 sz=0x0020 vsz=0x0020 .note.ABI_tag\n[02] . 0x00000274 -r-- va=0x00000274 sz=0x0024 vsz=0x0024 .note.gnu.build_id\n[03] . 0x00000298 -r-- va=0x00000298 sz=0x00b4 vsz=0x00b4 .gnu.hash\n[04] . 0x00000350 -r-- va=0x00000350 sz=0x0cc0 vsz=0x0cc0 .dynsym\n[05] . 0x00001010 -r-- va=0x00001010 sz=0x05dd vsz=0x05dd .dynstr\n[06] . 0x000015ee -r-- va=0x000015ee sz=0x0110 vsz=0x0110 .gnu.version\n[07] . 0x00001700 -r-- va=0x00001700 sz=0x0070 vsz=0x0070 .gnu.version_r\n[08] . 0x00001770 -r-- va=0x00001770 sz=0x1368 vsz=0x1368 .rela.dyn\n[09] . 0x00002ad8 -r-- va=0x00002ad8 sz=0x09f0 vsz=0x09f0 .rela.plt\n[10] . 0x000034c8 -r-x va=0x000034c8 sz=0x0017 vsz=0x0017 .init\n[11] . 0x000034e0 -r-x va=0x000034e0 sz=0x06b0 vsz=0x06b0 .plt\n[12] . 0x00003b90 -r-x va=0x00003b90 sz=0x0020 vsz=0x0020 .plt.got\n[13] * 0x00003bb0 -r-x va=0x00003bb0 sz=0x12099 vsz=0x12099 .text\n[14] . 0x00015c4c -r-x va=0x00015c4c sz=0x0009 vsz=0x0009 .fini\n[15] . 0x00015c60 -r-- va=0x00015c60 sz=0x4f14 vsz=0x4f14 .rodata\n...\n</code></pre>\n  </li>\n  <li>\n   <p>\n    You may have noticed the\n    <code>\n     *\n    </code>\n    on section 13 (\n    <code>\n     .text\n    </code>\n    ), so we have already selected the\n    <code>\n     .text\n    </code>\n    section (this is the default). To be sure:\n   </p>\n   <pre><code>[0x00005430]> S.\n0x00007760 0x000197f9 .text\n</code></pre>\n   <p>\n    Currently, I do not know how to change this\n    <em>\n     current section\n    </em>\n    .\n   </p>\n  </li>\n  <li>\n   <p>\n    Then, you can print the whole section with the\n    <code>\n     px\n    </code>\n    command:\n   </p>\n   <pre><code>[0x00005430]> px 0x00007760\nDo you want to print 1911 lines? (y/N)\n- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF\n0x00007760  0000 00e8 f8e0 ffff 84c0 0f84 c000 0000  ................\n0x00007770  b910 0100 00e9 56fd ffff 660f 1f44 0000  ......V...f..D..\n0x00007780  418b 97bc 0000 0048 8b35 c28d 2100 4183  A......H.5..!.A.\n0x00007790  f401 4d89 e945 0fb6 c431 c948 89ef e82d  ..M..E...1.H...-\n...\n</code></pre>\n  </li>\n  <li>\n   <p>\n    Finally, you can dump the content of the whole\n    <code>\n     .text\n    </code>\n    section in a file like this:\n   </p>\n   <pre><code>[0x00005430]> Sd text.bin\nDumped 73881 bytes into text.bin\n</code></pre>\n  </li>\n </ol>\n <p>\n  Hope this helped.\n </p>\n</div>\n</body></html>",
            "votes": "2",
            "user": "perror",
            "time": "Mar 15, 2017 at 10:13",
            "is_accepted": true,
            "comments": [
                {
                    "user": "lsamarahan",
                    "text": "<span class=\"comment-copy\">Thank you so much!! I followed your step above, to dump the .text section, and I can read my section is at 0x00401000 0x00401a00 .text, but now it keeps going down to 0x008xxxxx, ...though... have to kill me command prompt to stop it :-(</span>",
                    "time": null
                },
                {
                    "user": "perror",
                    "text": "<span class=\"comment-copy\">You can limit the size of the displayed dump by giving a size in the arguments like this: <code>px size start_address</code>. For example, it could be: <code>px 1000 0x00007760</code>. But, I do not know how to add a page break like in <code>gdb</code>.</span>",
                    "time": null
                },
                {
                    "user": "lsamarahan",
                    "text": "<span class=\"comment-copy\">I will give it a try. But when I open the text.bin in notepad, it gives me weird char like '冹h? 0@ 3膲D$d  @ 吚u|V??@ h?@ 謲D$Ph?@ ?@ 兡锅 @ 岲$?:u勔t奝:Qu兝兞勔u?离纼?吚uh!@ 謍?@ h&lt;!@ 謨??hX!@ 謨??@ ^婰$d3?' is it something wrong with my editor? thanks!</span>",
                    "time": null
                },
                {
                    "user": "perror",
                    "text": "<span class=\"comment-copy\">It is a binary dump, so do not expect to read it with an ASCII text editor.</span>",
                    "time": null
                },
                {
                    "user": "lsamarahan",
                    "text": "<span class=\"comment-copy\">I see. Well, i was hoping to get the hexdump. I managed to read the dump file in a hex editor. Thanks for your help!</span>",
                    "time": null
                }
            ]
        },
        {
            "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  In accordance with the\n  <a href=\"https://radare.gitbooks.io/radare2book/content/basic_commands/sections.html\" rel=\"nofollow noreferrer\">\n   manual of radare\n  </a>\n  , I notice that the command\n  <code>\n   S\n  </code>\n  and\n  <code>\n   Sd\n  </code>\n  of radare2 are depreciated. You can have a few issues with using it in some ways such as use it on a elf file. Use\n  <code>\n   iS\n  </code>\n  and\n  <code>\n   iO\n  </code>\n  instead.\n </p>\n <p>\n  If you want to launch the command in rabin2 then simply type:\n </p>\n <pre><code>rabin2 -O d/S/.text hello-world > text.bin\n</code></pre>\n <p>\n  Else, if you prefer to the radare2 console, then in the aim to provide an usage example of how to get a whole hexadecimal representation of the\n  <code>\n   .text\n  </code>\n  section, I am going to give an example based on the case given by perror. Let's have a look.\n </p>\n <p>\n  First, use\n  <code>\n   iS\n  </code>\n  instead to list the sections.\n </p>\n <pre><code>$ r2 hello\n-- Wrong argument\n[0x00000580]> iS\n[Sections]\n00 0x00000000     0 0x00000000     0 ---- \n01 0x00000238    28 0x00000238    28 -r-- .interp\n02 0x00000254    32 0x00000254    32 -r-- .note.ABI_tag\n03 0x00000274    36 0x00000274    36 -r-- .note.gnu.build_id\n04 0x00000298    28 0x00000298    28 -r-- .gnu.hash\n05 0x000002b8   192 0x000002b8   192 -r-- .dynsym\n06 0x00000378   150 0x00000378   150 -r-- .dynstr\n07 0x0000040e    16 0x0000040e    16 -r-- .gnu.version\n08 0x00000420    32 0x00000420    32 -r-- .gnu.version_r\n09 0x00000440   216 0x00000440   216 -r-- .rela.dyn\n10 0x00000518    24 0x00000518    24 -r-- .rela.plt\n11 0x00000530    23 0x00000530    23 -r-x .init\n12 0x00000550    32 0x00000550    32 -r-x .plt\n13 0x00000570     8 0x00000570     8 -r-x .plt.got\n14 0x00000580   466 0x00000580   466 -r-x .text\n15 0x00000754     9 0x00000754     9 -r-x .fini\n16 0x00000760    16 0x00000760    16 -r-- .rodata\n17 0x00000770    60 0x00000770    60 -r-- .eh_frame_hdr\n18 0x000007b0   268 0x000007b0   268 -r-- .eh_frame\n19 0x00000dd8     8 0x00200dd8     8 -rw- .init_array\n20 0x00000de0     8 0x00200de0     8 -rw- .fini_array\n21 0x00000de8     8 0x00200de8     8 -rw- .jcr\n22 0x00000df0   480 0x00200df0   480 -rw- .dynamic\n23 0x00000fd0    48 0x00200fd0    48 -rw- .got\n24 0x00001000    32 0x00201000    32 -rw- .got.plt\n25 0x00001020    16 0x00201020    16 -rw- .data\n26 0x00001030     0 0x00201030     8 -rw- .bss\n27 0x00001030    45 0x00000000    45 ---- .comment\n28 0x00001060  1632 0x00000000  1632 ---- .symtab\n29 0x000016c0   565 0x00000000   565 ---- .strtab\n30 0x000018f5   268 0x00000000   268 ---- .shstrtab\n</code></pre>\n <p>\n  Second, use\n  <code>\n   iS\n  </code>\n  to check if we are nicely using the current section by printing the current section.\n </p>\n <pre><code>[0x00000580]> iS.\nCurrent section\n00 0x00000580   466 0x00000580   466 -r-x .text\n</code></pre>\n <p>\n  Thirdly fill free to do\n  <code>\n   px 0x00000580\n  </code>\n  to display the whole content.\n </p>\n <pre><code>[0x00000580]> px 0x00000580\n- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF\n0x00000580  31ed 4989 d15e 4889 e248 83e4 f050 544c  1.I..^H..H...PTL\n0x00000590  8d05 ba01 0000 488d 0d43 0100 0048 8d3d  ......H..C...H.=\n0x000005a0  0c01 0000 ff15 2e0a 2000 f40f 1f44 0000  ........ ....D..\n0x000005b0  488d 3d79 0a20 0048 8d05 790a 2000 5548  H.=y. .H..y. .UH\n0x000005c0  29f8 4889 e548 83f8 0e76 1548 8b05 fe09  ).H..H...v.H....\n0x000005d0  2000 4885 c074 095d ffe0 660f 1f44 0000   .H..t.]..f..D..\n0x000005e0  5dc3 0f1f 4000 662e 0f1f 8400 0000 0000  ]...@.f.........\n0x000005f0  488d 3d39 0a20 0048 8d35 320a 2000 5548  H.=9. .H.52. .UH\n0x00000600  29fe 4889 e548 c1fe 0348 89f0 48c1 e83f  ).H..H...H..H..?\n0x00000610  4801 c648 d1fe 7418 488b 05d1 0920 0048  H..H..t.H.... .H\n0x00000620  85c0 740c 5dff e066 0f1f 8400 0000 0000  ..t.]..f........\n0x00000630  5dc3 0f1f 4000 662e 0f1f 8400 0000 0000  ]...@.f.........\n0x00000640  803d e909 2000 0075 2748 833d a709 2000  .=.. ..u'H.=.. .\n0x00000650  0055 4889 e574 0c48 8b3d ca09 2000 e80d  .UH..t.H.=.. ...\n0x00000660  ffff ffe8 48ff ffff 5dc6 05c0 0920 0001  ....H...].... ..\n0x00000670  f3c3 0f1f 4000 662e 0f1f 8400 0000 0000  ....@.f.........\n0x00000680  488d 3d61 0720 0048 833f 0075 0be9 5eff  H.=a. .H.?.u..^.\n0x00000690  ffff 660f 1f44 0000 488b 0549 0920 0048  ..f..D..H..I. .H\n0x000006a0  85c0 74e9 5548 89e5 ffd0 5de9 40ff ffff  ..t.UH....].@...\n0x000006b0  5548 89e5 4883 ec10 897d fc48 8975 f048  UH..H....}.H.u.H\n0x000006c0  8d3d 9e00 0000 e895 feff ffb8 0000 0000  .=..............\n0x000006d0  c9c3 662e 0f1f 8400 0000 0000 0f1f 4000  ..f...........@.\n0x000006e0  4157 4156 4189 ff41 5541 544c 8d25 e606  AWAVA..AUATL.%..\n0x000006f0  2000 5548 8d2d e606 2000 5349 89f6 4989   .UH.-.. .SI..I.\n0x00000700  d54c 29e5 4883 ec08 48c1 fd03 e81f feff  .L).H...H.......\n0x00000710  ff48 85ed 7420 31db 0f1f 8400 0000 0000  .H..t 1.........\n0x00000720  4c89 ea4c 89f6 4489 ff41 ff14 dc48 83c3  L..L..D..A...H..\n0x00000730  0148 39dd 75ea 4883 c408 5b5d 415c 415d  .H9.u.H...[]A\\A]\n0x00000740  415e 415f c390 662e 0f1f 8400 0000 0000  A^A_..f.........\n0x00000750  f3c3 0000 4883 ec08 4883 c408 c300 0000  ....H...H.......\n0x00000760  0100 0200 6865 6c6c 6f20 776f 726c 6400  ....hello world.\n0x00000770  011b 033b 3c00 0000 0600 0000 e0fd ffff  ...;<...........\n0x00000780  8800 0000 00fe ffff b000 0000 10fe ffff  ................\n0x00000790  5800 0000 40ff ffff c800 0000 70ff ffff  X...@.......p...\n0x000007a0  e800 0000 e0ff ffff 3001 0000 0000 0000  ........0.......\n0x000007b0  1400 0000 0000 0000 017a 5200 0178 1001  .........zR..x..\n0x000007c0  1b0c 0708 9001 0710 1400 0000 1c00 0000  ................\n0x000007d0  b0fd ffff 2b00 0000 0000 0000 0000 0000  ....+...........\n0x000007e0  1400 0000 0000 0000 017a 5200 0178 1001  .........zR..x..\n0x000007f0  1b0c 0708 9001 0000 2400 0000 1c00 0000  ........$.......\n0x00000800  50fd ffff 2000 0000 000e 1046 0e18 4a0f  P... ......F..J.\n0x00000810  0b77 0880 003f 1a3b 2a33 2422 0000 0000  .w...?.;*3$\"....\n0x00000820  1400 0000 4400 0000 48fd ffff 0800 0000  ....D...H.......\n0x00000830  0000 0000 0000 0000 1c00 0000 5c00 0000  ............\\...\n0x00000840  70fe ffff 2200 0000 0041 0e10 8602 430d  p...\"....A....C.\n0x00000850  065d 0c07 0800 0000 4400 0000 7c00 0000  .]......D...|...\n0x00000860  80fe ffff 6500 0000 0042 0e10 8f02 420e  ....e....B....B.\n0x00000870  188e 0345 0e20 8d04 420e 288c 0548 0e30  ...E. ..B.(..H.0\n0x00000880  8606 480e 3883 074d 0e40 720e 3841 0e30  ..H.8..M.@r.8A.0\n0x00000890  410e 2842 0e20 420e 1842 0e10 420e 0800  A.(B. B..B..B...\n0x000008a0  1400 0000 c400 0000 a8fe ffff 0200 0000  ................\n0x000008b0  0000 0000 0000 0000 0000 0000 ffff ffff  ................\n0x000008c0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x000008d0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x000008e0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x000008f0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000900  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000910  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000920  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000930  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000940  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000950  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000960  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000970  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000980  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000990  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x000009a0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x000009b0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x000009c0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x000009d0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x000009e0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x000009f0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000a00  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000a10  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000a20  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000a30  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000a40  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000a50  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000a60  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000a70  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000a80  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000a90  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000aa0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000ab0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000ac0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000ad0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000ae0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n0x00000af0  ffff ffff ffff ffff ffff ffff ffff ffff  ................\n</code></pre>\n <p>\n  And last but not least, do not use\n  <code>\n   Sd text.bin\n  </code>\n </p>\n <p>\n  Instead use:\n </p>\n <pre><code>[0x00000580]> iO d/S/.text > text.bin\n</code></pre>\n</div>\n</body></html>",
            "votes": "4",
            "user": "ultimate-anti-reversing",
            "time": "Feb 22, 2020 at 16:00",
            "is_accepted": false,
            "comments": [
                {
                    "user": "Evan Carroll",
                    "text": "<span class=\"comment-copy\">If <code>S</code> doesn't work, why would <code>Sd</code> work?</span>",
                    "time": null
                },
                {
                    "user": "ultimate-anti-reversing",
                    "text": "<span class=\"comment-copy\">I noticed your comment @EvanCarroll and I modified my post.</span>",
                    "time": null
                },
                {
                    "user": "jsaigle",
                    "text": "<span class=\"comment-copy\">This should be the accepted answer. The old commands are deprecated.</span>",
                    "time": null
                }
            ]
        }
    ]
}