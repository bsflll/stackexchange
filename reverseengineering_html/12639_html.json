{
    "title": "help getting at encrypted firmware [includes .SMIME and .gz.aes files]",
    "link": "https://reverseengineering.stackexchange.com/questions/12639/help-getting-at-encrypted-firmware-includes-smime-and-gz-aes-files",
    "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  I found firmware for Slingbox 500 by sniffing the outgoing connections it is making. Having trouble making heads or tails of it though. I'd really love to see the filesystem because it's running dropbear ssh server!\n </p>\n <p>\n  files as follow, were obtained from\n  <a href=\"http://mdconfig.sling.com/config/v2/type/ngsb/product/intrepidCbfu/version/01.10.095.json\" rel=\"nofollow\">\n   http://mdconfig.sling.com/config/v2/type/ngsb/product/intrepidCbfu/version/01.10.095.json\n  </a>\n  --\n </p>\n <pre><code>{\n\"payload\":\n    \"{\"config\":\n        {\n         \"updateVersion\":\"01.10.102\",\n         \"rebootTimeMsec\":68000,\n         \"firmwareComponents\":\n            {\n            \"appfsRecovery\":\n                {\n                    \"critical\":false,\n                    \"crc\":123,\n                    \"order\":1,\n                    \"reboot\":false,\n                    \"url\":\"www.navjit.com\",\n                    \"size\":123,\n                    \"version\":\"0.5.102\"\n                },\n            \"uImageMain\":\n                {\n                    \"critical\":false,\n                    \"crc\":1863698014,\n                    \"order\":2,\n                    \"reboot\":false,\n                    \"url\":\"http://cbfu-prod.slingbox.com/Intrepid/Intrepid_FW_01_10_102/s_fw4_uImage_mips_gz_118.bin\",\n                    \"size\":5463888,\n                    \"version\":\"1.9.118\"\n                },\n            \"FW3\":\n                {\n                    \"critical\":false,\n                    \"crc\":2050778634,\n                    \"order\":3,\n                    \"reboot\":false,\n                    \"url\":\"http://cbfu-prod.slingbox.com/Intrepid/Intrepid_FW_01_10_102/intrepid_fw3_f_p_1_5_432.bin\",\n                    \"size\":262144,\n                    \"version\":\"1.5.432\"\n                },\n            \"FW2\":\n                {\n                    \"critical\":false,\n                    \"crc\":2050778634,\n                    \"order\":4,\n                    \"reboot\":false,\n                    \"url\":\"www.navjit.com\",\n                    \"size\":123,\n                    \"version\":\"0.5.472\"\n                },\n            \"FW1\":\n                {\n                    \"critical\":false,\n                    \"crc\":123,\n                    \"order\":5,\n                    \"reboot\":false,\n                    \"url\":\"www.navjit.com\",\n                    \"size\":123,\n                    \"version\":\"0.5.472\"\n                },\n            \"uImageRecovery\":\n                {\n                    \"critical\":false,\n                    \"crc\":123,\n                    \"order\":0,\n                    \"reboot\":false,\n                    \"url\":\"www.navjit.com\",\n                    \"size\":123,\n                    \"version\":\"1.5.002\"\n                }\n            },\n        \"applications\":\n            {\n                \"sbCore\":\n                    {\n                        \"urlMeta\":\"http://cbfu-prod.slingbox.com/Intrepid/Intrepid_FW_01_10_102/FW5_SIG_01_10_102.tar\",\n                        \"critical\":false,\n                        \"sizeMeta\":10240,\n                        \"reboot\":true,\n                        \"type\":\"file_system\",\n                        \"url\":\"http://cbfu-prod.slingbox.com/Intrepid/Intrepid_FW_01_10_102/intrepid_fw5_full_01.10.102_nand.ubi.gz.aes\",\n                        \"version\":\"01.10.102\",\n                        \"size\":99865328\n                    }\n            }\n        }\n    }\",\n\n        \"header\":\n            {\n                \"signatureEncoding\":\"base64\",\n                \"msgType\":\"plain\",\n                \"signature\":\" MIAGCSqGSIb3DQEHAqCAMIACAQExDzANBglghkgBZQMEAgEFADCABgkqhkiG9w0BBwEAADGCAg8wggILAgEBMHkwdDELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFDASBgNVBAoTC1NsaW5nIE1lZGlhMRMwEQYDVQQDEwpNRCBET1dOIENBMSUwIwYJKoZIhvcNAQkBFhZtZGFkbWluQHNsaW5nbWVkaWEuY29tAgEDMA0GCWCGSAFlAwQCAQUAoGkwGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTYwNDI3MDYxNzIyWjAvBgkqhkiG9w0BCQQxIgQgdMg3fnkpkxTXkZzmAgvCH613L0YpH70/9yGDYSN0D7YwDQYJKoZIhvcNAQEBBQAEggEApKOkHp4k8EgaMxPIxelQX2E2iKP91HgUnx4lkYkffirQU5ObvIFWd4DAyEmb6QO8X3BVA/tWnDDaIwunUy/2WVjgcwyTiSLr20tPlEPDJcACEQERx2xzAss3Y+voeXmwBrmDWFXn5ILNUN86GsL3mUyfySR6ZPly4Wu2Krb55e58FIu9WqS6ynCD1Qdt4djQ6VgeG+2+CBmUp7mvoemgr+Kzs0wNCOOm9/561Cqsl3MCbHrt8hXikcb2lTyH3UkNRlBmYt66hb7MB1r1osT8KLLERuJ1kFOhYf6edefTFjyQVM/EUUwK5TO5NzFGB8wosG9jzbLpbE9qXQrj62j6tAAAAAAAAA==\",\n\"configEncoding\":\"none\"\n            }\n}\n</code></pre>\n <p>\n  Binwalk is blank on both of these files:\n </p>\n <blockquote>\n  <ul>\n   <li>\n    <a href=\"http://cbfu-prod.slingbox.com/Intrepid/Intrepid_FW_01_10_102/s_fw4_uImage_mips_gz_118.bin\" rel=\"nofollow\">\n     http://cbfu-prod.slingbox.com/Intrepid/Intrepid_FW_01_10_102/s_fw4_uImage_mips_gz_118.bin\n    </a>\n   </li>\n   <li>\n    <a href=\"http://cbfu-prod.slingbox.com/Intrepid/Intrepid_FW_01_10_102/intrepid_fw3_f_p_1_5_432.bin\" rel=\"nofollow\">\n     http://cbfu-prod.slingbox.com/Intrepid/Intrepid_FW_01_10_102/intrepid_fw3_f_p_1_5_432.bin\n    </a>\n   </li>\n  </ul>\n </blockquote>\n <p>\n  The following tar file expands into three separate files:\n </p>\n <blockquote>\n  <ul>\n   <li>\n    <a href=\"http://cbfu-prod.slingbox.com/Intrepid/Intrepid_FW_01_10_102/FW5_SIG_01_10_102.tar\" rel=\"nofollow\">\n     http://cbfu-prod.slingbox.com/Intrepid/Intrepid_FW_01_10_102/FW5_SIG_01_10_102.tar\n    </a>\n    <ol>\n     <li>\n      FW5_sig.smime <-- don't know how to decode these smime files, but the contain strings like \"Intrepid pkg key\", \"Intrepid pkg signer\", and \"OpenSSL Generated Certificate\", and have interesting names which might be useful!\n     </li>\n     <li>\n      FW5_enc_params.smime\n     </li>\n     <li>\n      ubi_fw_size --> \"128057344\"\n     </li>\n    </ol>\n   </li>\n  </ul>\n </blockquote>\n <p>\n  And probably the most interesting file which appears thoroughly encrypted (95 MB):\n </p>\n <blockquote>\n  <ul>\n   <li>\n    <a href=\"http://cbfu-prod.slingbox.com/Intrepid/Intrepid_FW_01_10_102/intrepid_fw5_full_01.10.102_nand.ubi.gz.aes\" rel=\"nofollow\">\n     http://cbfu-prod.slingbox.com/Intrepid/Intrepid_FW_01_10_102/intrepid_fw5_full_01.10.102_nand.ubi.gz.aes\n    </a>\n   </li>\n  </ul>\n </blockquote>\n <p>\n  So here I am wondering if there is a chance to get further or if I'm stuck. I'm not against hardware tinkering, though I would certainly be clumsy with it and would require some handholding. Any thoughts? Thanks.\n </p>\n</div>\n</body></html>",
    "votes": "2",
    "answers": 1,
    "views": "472",
    "tags": [
        "firmware",
        "encryption"
    ],
    "user": "justin",
    "time": "May 12, 2016 at 2:25",
    "comments": [],
    "answers_data": [
        {
            "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  Most likely the decryption key is hardcoded in the firmware on the device or in some storage there. You will probably need to get into the device somehow to figure out how it does the firmware update decryption.\n </p>\n</div>\n</body></html>",
            "votes": "1",
            "user": "Igor Skochinsky",
            "time": "May 12, 2016 at 10:04",
            "is_accepted": true,
            "comments": []
        }
    ]
}