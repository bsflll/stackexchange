{
    "title": "What are my next options for firmware reversing?",
    "link": "https://reverseengineering.stackexchange.com/questions/33411/what-are-my-next-options-for-firmware-reversing",
    "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  I have an old action camera (gopro cheap clone) and it still works fine, so I used this hardware to learn reverse engineering.\n </p>\n <h2>\n  Firmware\n </h2>\n <p>\n  flash chip on board is W25Q64BV is 8 MB spi which I dumped with\n  \n\n  ch341 moded to 3.3v and capacitor at VCC\n </p>\n <p>\n  <a href=\"https://i.sstatic.net/QSCt7Mynm.png\" rel=\"nofollow noreferrer\">\n   <img alt=\"photo of my beast!\" src=\"https://i.sstatic.net/QSCt7Mynm.png\"/>\n  </a>\n </p>\n <p>\n  Here is the\n  <a href=\"https://www.dropbox.com/scl/fi/lfdhdwz8hzw96keummdyv/original.bin?rlkey=tf6qj1jzvgz9yye7jl7yxuop3&st=vt9lbd77&dl=0\" rel=\"nofollow noreferrer\">\n   original dump\n  </a>\n </p>\n <p>\n  I was able to change wifi password in AsProgrammer by searching for a string\n\"actionCamera\" which is a default access point name. So password was 1234567890. Worked great!\n </p>\n <p>\n  Then I learned about tool - binwalk :\n </p>\n <pre><code>binwalk original.bin\n\n------------------------------------------------------------------------------------------------------------------------------\nDECIMAL                            HEXADECIMAL                        DESCRIPTION\n------------------------------------------------------------------------------------------------------------------------------\n1614336                            0x18A200                           JPEG image, total size: 5026 bytes\n1631232                            0x18E400                           JPEG image, total size: 4076 bytes\n1641984                            0x190E00                           JPEG image, total size: 3539 bytes\n1648146                            0x192612                           Copyright text: \"Copyright (c) 1998 Hewlett-Packard \n                                                                      Company\"\n1666560                            0x196E00                           JPEG image, total size: 2641 bytes\n1670144                            0x197C00                           JPEG image, total size: 4126 bytes\n1674752                            0x198E00                           JPEG image, total size: 3539 bytes\n1680914                            0x19A612                           Copyright text: \"Copyright (c) 1998 Hewlett-Packard \n                                                                      Company\"\n1699328                            0x19EE00                           JPEG image, total size: 9078 bytes\n1716530                            0x1A3132                           Copyright text: \"Copyright (c) 1998 Hewlett-Packard     \n                                                                      Company\"\n7364292                            0x705EC4                           Copyright text: \"Copyright 2008\"\n7465807                            0x71EB4F                           Copyright text: \"Copyright (c) 2004-2011, Jouni Malinen \n                                                                      <j@w1.fi> and contributors\"\n7467537                            0x71F211                           Copyright text: \"copyright notice, this list of\n                                                                      conditions and the following disclaimer. 2.\n                                                                      Redistributions in bi\"\n7645020                            0x74A75C                           AES S-Box\n7689144                            0x7553B8                           AES S-Box\n8077704                            0x7B4188                           AES S-Box\n8304960                            0x7EB940                           Copyright text: \"Copyright (c) 1996-2005 Express Logic  \n                                                                      Inc. * ThreadX MIPS32_4Kx/GNU Version G4.0c.4.0 *\"      \n------------------------------------------------------------------------------------------------------------------------------\n</code></pre>\n <p>\n  Then I used binwalk -e option and only one picture opened without error (settings menu background at 0x197C00), so I decided to  change it.\nFrom what I understand it has length 4126 bytes, hovewer I see that the next picture starting only at 0x198E00. There is some zero padding for some reason and I have 4608 bytes for new picture to write.\n </p>\n <p>\n  So just to try I am extracting picture using dd (1670144 is decimal 0x197C00):\n </p>\n <pre><code>dd if=original.bin of=img_mod.jpg bs=1 skip=1670144 count=4126\n</code></pre>\n <p>\n  I filled original firmware with zeros where picture located (not sure if this required)\n </p>\n <pre><code>dd if=/dev/zero of=modified.bin bs=1 seek=1670144 count=4126 conv=notrunc\n</code></pre>\n <p>\n  Putting it back :\n </p>\n <pre><code>dd if=img_mod.jpg of=modified.bin bs=1 seek=1670144 conv=notrunc\n</code></pre>\n <p>\n  After uploading it worked!\n </p>\n <h2>\n  UART\n </h2>\n <p>\n  On the board there is a lot of test points\nso I found UART with baud 115200.\n </p>\n <p>\n  <a href=\"https://www.dropbox.com/scl/fi/tyeiuob3tin1lzu8ncci0/uart_dump.txt?rlkey=qmextoan5mkk58r7rwxoy1a3w&st=xgi35pj1&dl=0\" rel=\"nofollow noreferrer\">\n   output on initialization of camera\n  </a>\n </p>\n <p>\n  I wasn't able to find RX pin on the board at least my bets didn't have any response from the console.\n </p>\n <h2>\n  Other search\n </h2>\n <ul>\n  <li>\n   <p>\n    The main chip is SPCA6330A\n    <a href=\"https://www.datasheetarchive.com/datasheet/8123800c3f6e3fe7?type=N&term=spca6330a\" rel=\"nofollow noreferrer\">\n     datasheet\n    </a>\n    no pinout unfortunately.\n   </p>\n  </li>\n  <li>\n   <p>\n    Tried OFRAK with angr backend but it always says \"generic binary\"\n   </p>\n  </li>\n </ul>\n <pre><code>ofrak unpack -x --gui -r --backend angr ./original.bin\n</code></pre>\n <ul>\n  <li>\n   folder with\n   <a href=\"https://www.dropbox.com/scl/fo/nncofyup5yoiuk2yqnps8/ADvbARF8NTQuhNysO51Xab8?rlkey=r5gxksez08w6xmfi9ejzbje2u&st=w8kf2am5&dl=0\" rel=\"nofollow noreferrer\">\n    files\n   </a>\n  </li>\n </ul>\n <p>\n  So my question where should I go next from here . No doubt there is an operating system of some sort and I want to see it! Maybe modify it??? That would be awesome!\n </p>\n</div>\n</body></html>",
    "votes": "1",
    "answers": 0,
    "views": "61",
    "tags": [
        "firmware-analysis"
    ],
    "user": "Askhento",
    "time": "Mar 23 at 15:18",
    "comments": [],
    "answers_data": []
}