{
    "title": "Why does IDA identify so many non-existent methods in this binary?",
    "link": "https://reverseengineering.stackexchange.com/questions/15908/why-does-ida-identify-so-many-non-existent-methods-in-this-binary",
    "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  The decompilation and auto-analysis of this binary is grossly inaccurate. I am providing the\n  <a href=\"http://www.mediafire.com/file/2c922amt64d0rym/bug_manage_system\" rel=\"nofollow noreferrer\">\n   binary\n  </a>\n  as well as the\n  <a href=\"http://www.mediafire.com/file/938tb37emkkxifz/bug_manage_system.idb\" rel=\"nofollow noreferrer\">\n   IDB\n  </a>\n  . IDA v6.95, 32 bit was used for the analysis. Can anyone take a look and suggest how I can improve the accuracy of IDA's analysis in this case?\n </p>\n</div>\n</body></html>",
    "votes": "0",
    "answers": 1,
    "views": "428",
    "tags": [
        "ida",
        "hexrays"
    ],
    "user": "sherlock",
    "time": "Jul 25, 2017 at 7:16",
    "comments": [],
    "answers_data": [
        {
            "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  Would you mind ellaborating which functions you are refering to? The ones I see (IDA 6.95, 32bit, linux) seem pretty normal to me. Here is the list:\n </p>\n <p>\n  <a href=\"https://i.sstatic.net/NwoKd.png\" rel=\"nofollow noreferrer\">\n   <img alt=\"function list\" src=\"https://i.sstatic.net/NwoKd.png\"/>\n  </a>\n </p>\n <p>\n  Generally, IDA adds functions as soon as it finds any referal of control flow, so broken functions are often generated by opaque predicates and falsely parsed jump tables.\n </p>\n <p>\n  <strong>\n   edit:\n  </strong>\n  The functions you are referring to (\n  <code>\n   sub_6C8\n  </code>\n  ,\n  <code>\n   sub_6D0\n  </code>\n  ,\n  <code>\n   sub_6D8\n  </code>\n  ) are functions related to the global offset table (see segment name). These are basically trampoline functions redirecting the control flow.\n </p>\n <p>\n  (PLT stands for procedure linkage table)\n </p>\n <p>\n  I'm not completely certain why IDA treats them as functions, but the functionality is no mistery.\n </p>\n <p>\n  You may try commands like:\n </p>\n <pre><code>readelf --relocs bug_manage_system\n</code></pre>\n <p>\n  or\n </p>\n <pre><code>objdump -T bug_manage_system\n</code></pre>\n <p>\n  Also, it may help to have a look at raw disassembler output of\n  <code>\n   .plt.got\n  </code>\n  using objdump or any other tool.\n </p>\n <p>\n  Reading an article about the linking procedure of elf files may certainly help:\n  <a href=\"https://www.technovelty.org/linux/plt-and-got-the-key-to-code-sharing-and-dynamic-libraries.html\" rel=\"nofollow noreferrer\">\n   PLT and GOT - the key to code sharing and dynamic libraries\n  </a>\n  <a href=\"https://systemoverlord.com/2017/03/19/got-and-plt-for-pwning.html\" rel=\"nofollow noreferrer\">\n   GOT and PLT for pwning.\n  </a>\n  <a href=\"https://reverseengineering.stackexchange.com/questions/1992/what-is-plt-got/1993\">\n   What is PLT/GOT?\n  </a>\n </p>\n</div>\n</body></html>",
            "votes": "1",
            "user": "Nordwald",
            "time": "Jul 27, 2017 at 5:38",
            "is_accepted": false,
            "comments": [
                {
                    "user": "sherlock",
                    "text": "<span class=\"comment-copy\">There are many e.g. <code>sub_6C8</code>, <code>sub_6D0</code>, <code>sub_6D8</code> etc. Also, I seem to be not able to find any cross reference to <code>malloc</code></span>",
                    "time": null
                },
                {
                    "user": "sherlock",
                    "text": "<span class=\"comment-copy\">Look at the decompiler's output of the functions above.</span>",
                    "time": null
                },
                {
                    "user": "Nordwald",
                    "text": "<span class=\"comment-copy\">@Holmes.Sherlock any other functions? See my updated answer</span>",
                    "time": null
                }
            ]
        }
    ]
}