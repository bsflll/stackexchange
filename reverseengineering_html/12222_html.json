{
    "title": "Reading stp (Designaknit Stitch Pattern)-Files",
    "link": "https://reverseengineering.stackexchange.com/questions/12222/reading-stp-designaknit-stitch-pattern-files",
    "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  I want to write a small knitting program for my wife. In it, I will also read * .stp files (Stitch pattern). These are small files containing a graphic created by the program DesignaKnit and many of which are files on the Internet. (Examples z. B. to\n  <a href=\"http://www.stricknetz.net/muster/dateien/\" rel=\"nofollow\">\n   http://www.stricknetz.net/muster/dateien/\n  </a>\n  ).\nTo read it I need of course the format. Since I found it nowhere I tried to decipher. I have found much, but not get ahead now and hope to help.\n </p>\n <p>\n  Here what I found out:\n </p>\n <pre><code>Byte 0-2: D7C\nByte 3-4: width\nByte 5-6: Height\nByte 7-8: width\nByte 9-10: Height\nByte 11-12: number of pattern repeats Horizontal\nByte 13-14: Number of vertical pattern repeats\nByte 44: 'Knitting technique:\n    '0 = different - see the pattern ????\n    '1 = marquetry\n    '2 = 2-color jacquard\n    '3 = 3-color jacquard\n    '4 = 4-color jacquard\n    '12 = Handstrick\n    '14 = Structure pattern right side\n    '15 = Textured pattern left\n\nByte 177-209: Font name - padded with 0 (209 = End 0)\n248-249 = height (number of rows)\n250-251 = size image data in bytes\n252 - (252 + image data size) = image data - (somehow RLE - compressed)\nThen: 2 bytes = height (number of rows or number ???)\nthen 2 bytes Size of data\nthen ending bytes\nthen unknown data\nthen pallet (48 colors - if color is not used to zero)\nColor 1 = 25 bytes\n    Byte 0: number?\n    Byte 1: message numbers\n    Byte 3: Number\n    Byte 6-8: RGB color\n    Byte 9: Length Color Name\n    Byte 10-24: color name with a final 0 (at length 15 without 0)\n</code></pre>\n <p>\n  But I'm stuck with the RLE encoding of data. They are somehow specially coded. The figures (for number the same color, but also for the number in the range) switch repeatedly. z. B.\n </p>\n <pre><code>00h 05h 21h 00h 22h 02h 29h 0Ch\nColor 1 | 2 Color | Color 1 | 2 Color | Color 1 | 2 Color | Color 1 | Colour 2 | etc.\n</code></pre>\n <p>\n  Thus, the position changes in the pallet continuously (or to re-calculate - for example color 1 in the example. 00h, 21h, 22h, 29h ...)\n </p>\n <p>\n  But the number of same-colored pixels in the RLE-encoded bytes changes constantly. So 2 is the same color pixels once B3h, then B9H, then again B9H, then B4h etc.\nIn tests I found out that it is connected with any bytes from position 35h (decimal 53).\nBut I do not come on.\nI tried to look in a program that they can read files with IDA (SilverKnit Utility (www.silverknit.nl/download/) -. But since I speak no assembler I not get Perhaps someone can help me the riddle of STP to solve files (if at all possible) ??????????????????\n </p>\n <p>\n  Alfred\n </p>\n</div>\n</body></html>",
    "votes": "1",
    "answers": 0,
    "views": "324",
    "tags": [
        "ida",
        "file-format"
    ],
    "user": "Alfred",
    "time": "Mar 16, 2016 at 9:08",
    "comments": [],
    "answers_data": []
}