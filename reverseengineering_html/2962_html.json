{
    "title": "Intercepting GSM communications with an USRP and Gnu Radio",
    "link": "https://reverseengineering.stackexchange.com/questions/2962/intercepting-gsm-communications-with-an-usrp-and-gnu-radio",
    "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  I would like to know what is needed to intercept GSM communications with an\n  <a href=\"http://en.wikipedia.org/wiki/Universal_Software_Radio_Peripheral\">\n   USRP\n  </a>\n  (Universal Software Radio Peripheral) and using\n  <a href=\"http://gnuradio.org/\">\n   Gnu Radio\n  </a>\n  .\n </p>\n <ul>\n  <li>\n   Is there tutorial about that ?\n  </li>\n  <li>\n   What type of USRP is recommended ?\n  </li>\n  <li>\n   Where to find technical documentation about the GSM protocols ?\n  </li>\n  <li>\n   Is there already existing tools to break the A5/1 encryption ?\n  </li>\n  <li>\n   ...\n  </li>\n </ul>\n <p>\n  All in one, my question is more about looking for advices about \"\n  <strong>\n   where to start ?\n  </strong>\n  \" when trying to understand GSM communication.\n </p>\n</div>\n</body></html>",
    "votes": "17",
    "answers": 2,
    "views": "14k",
    "tags": [
        "radio-interception",
        "gnu-radio"
    ],
    "user": "perror",
    "time": "Oct 28, 2013 at 8:40",
    "comments": [],
    "answers_data": [
        {
            "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  As mentioned above by 0xea,\n  <a href=\"https://twitter.com/domi007\">\n   @domi007\n  </a>\n  published 4 blog posts (\n  <a href=\"http://domonkos.tomcsanyi.net/?p=418\">\n   1\n  </a>\n  ,\n  <a href=\"http://domonkos.tomcsanyi.net/?p=422\">\n   2\n  </a>\n  ,\n  <a href=\"http://domonkos.tomcsanyi.net/?p=425\">\n   3\n  </a>\n  ,\n  <a href=\"http://domonkos.tomcsanyi.net/?p=428\">\n   4\n  </a>\n  ) detailing his experience with GSM sniffing and cracking. He also published his\n  <a href=\"https://www.youtube.com/watch?v=3cnnQFP3VqE\">\n   recorded presentation\n  </a>\n  about GSM security (\n  <a href=\"http://camp.hsbp.org/2013/zer0/gsm.pdf\">\n   slides\n  </a>\n  ). \nOn the same topic, there's also\n  <a href=\"http://binaryrf.com/viewtopic.php?t=6&f=9\">\n   Sniffing GSM with HackRF\n  </a>\n  ,\n  <a href=\"http://www.rtl-sdr.com/rtl-sdr-tutorial-analyzing-gsm-with-airprobe-and-wireshark/\">\n   Analyzing GSM with Airprobe and Wireshark\n  </a>\n  , three Chaos Computer Club presentations (One discussing\n  <a href=\"https://www.youtube.com/watch?v=ZrbatnnRxFc\">\n   Wideband GSM sniffing\n  </a>\n  , another discussing the\n  <a href=\"https://www.youtube.com/watch?v=9wwco24EsHs\">\n   functioning of GSM networks\n  </a>\n  ) and the one mentioned\n  <a href=\"https://events.ccc.de/congress/2009/Fahrplan/events/3654.en.html\">\n   above\n  </a>\n  about GSM Cracking. Last but not least, there's also a Black Hat 2008 Presentation called \"Intercepting Mobile Phone/GSM Traffic\", by David Hulton and Steve\n  <a href=\"http://www.blackhat.com/html/featured_media/bh08-002-Stream-1.mov\">\n   video (.mov)\n  </a>\n  .\nObservation : There's also\n  <a href=\"https://srlabs.de/airprobe-how-to/\">\n   this tutorial by Srlabs\n  </a>\n  , which uses their own tool, Kraken, that covers decrypting GSM using Airprobe and the\n  <a href=\"https://svn.berlin.ccc.de/projects/airprobe/wiki/A\">\n   Airprobe's own tutorial\n  </a>\n  on decoding GSM.\nWhen choosing your SDR, I suggest you read\n  <a href=\"http://www.taylorkillian.com/2013/08/sdr-showdown-hackrf-vs-bladerf-vs-usrp.html\">\n   this comparison\n  </a>\n  about\n  <a href=\"http://greatscottgadgets.com/hackrf/\">\n   HackRF\n  </a>\n  ,\n  <a href=\"http://nuand.com/\">\n   bladeRF\n  </a>\n  and the\n  <a href=\"https://www.ettus.com/product/details/UB210-KIT\">\n   USRP B210\n  </a>\n  . There is also\n  <a href=\"http://sdr.osmocom.org/trac/wiki/rtl-sdr\">\n   RTL-SDR\n  </a>\n  . They are all quite nice. I also suggest using\n  <a href=\"http://gqrx.dk/\">\n   Gqrx\n  </a>\n  as it's built on Gnuradio and has a neat interface.\n </p>\n <p>\n  Architecture and theory wise, I'd recommend\n  <a href=\"https://docs.google.com/viewer?url=http://www2.informatik.hu-berlin.de/~goeller/isdn/GSMDmChannels.pdf\">\n   About GSM Dm Channels\n  </a>\n  , which is a quite complete and detailed beginner paper that explains the GSM Architecture and how it works. I also recommend\n  <a href=\"http://rads.stackoverflow.com/amzn/click/0470030704\">\n   GSM - Architecture, Protocols and Services\n  </a>\n  and\n  <a href=\"http://rads.stackoverflow.com/amzn/click/B004W7DNWY\">\n   4G: LTE/LTE-Advanced for Mobile Broadband\n  </a>\n  (if considering LTE), which provide further information and details about the functioning of GSM for those that want to delve into it.\n </p>\n <p>\n  Regarding GSM Encryption and its flaws, I suggest\n  <a href=\"https://docs.google.com/viewer?url=http%3A%2F%2Fwww.cs.technion.ac.il%2Fusers%2Fwwwb%2Fcgi-bin%2Ftr-get.cgi%2F2006%2FCS%2FCS-2006-07.pdf\">\n   Instant Ciphertext-Only Cryptanalysis of GSM Encrypted Communication\n  </a>\n  , which discusses ciphertext attacks on A5/(1,2,3),\n  <a href=\"https://docs.google.com/viewer?url=http://www.emsec.rub.de/media/crypto/attachments/files/2010/04/da_gendrullis.pdf\">\n   Hardware-based Cryptanalysis of the GSM A5/1 Encryption Algorithm\n  </a>\n  - includes a 2 page brief on A5/1 and then goes on to the cryptoanalysis - and\n  <a href=\"https://docs.google.com/viewer?url=http://cryptome.org/a5-3-attack.pdf\">\n   A Practical-Time Attack on the A5/3 Cryptosystem Used in Third Generation GSM Telephony\n  </a>\n  - discusses attacks on A5/3. Finally, there is also\n  <a href=\"http://cryptome.org/a51-bsw.htm\">\n   Real Time Cryptanalysis of A5/1 on a PC\n  </a>\n  , a very nice document called\n  <a href=\"http://www.researchgate.net/publication/235339185_Security_of_3G_and_LTE\">\n   Security of 3G and LTE\n  </a>\n  that discusses the security architecture and the attacks on it's flaws, and\n  <a href=\"https://docs.google.com/viewer?url=http://www.bolet.org/~pornin/2000-ches-pornin%2bstern.pdf\">\n   Software Hardware Trade-offs - Applications to A5/1 Cryptanalysis\n  </a>\n  - another nice paper on A5/1. Observations : You can find the specifications for A5/3 in the\n  <a href=\"http://www.3gpp.org/Confidentiality-Algorithms\">\n   middle of this page\n  </a>\n  . There are also two Blackhat presentions that cover part of those papers in a succinct way\n  <a href=\"https://docs.google.com/viewer?url=https://srlabs.de/blog/wp-content/uploads/2010/07/Attacking.Phone_.Privacy_Karsten.Nohl_1.pdf\">\n   Attacking Phone Privacy\n  </a>\n  and\n  <a href=\"https://docs.google.com/viewer?url=https://srlabs.de/blog/wp-content/uploads/2010/07/100729.Breaking.GSM_.Privacy.BlackHat1.pdf\">\n   Breaking Phone Privacy\n  </a>\n  . If you like animations, there is an\n  <a href=\"https://www.youtube.com/embed/LgZAI3DdUA4\">\n   A5/1 Cipher Animation\n  </a>\n  on YouTube.\n  <a href=\"https://twitter.com/matthew_d_green\">\n   @matthew_d_green\n  </a>\n  deserves to be mentioned, considering he wrote a small synthesis of cellular communications crypto flaws in his\n  <a href=\"http://blog.cryptographyengineering.com/2013/05/a-few-thoughts-on-cellular-encryption.html\">\n   blog\n  </a>\n  .\n </p>\n <p>\n  Important observation : The GSM specifications are located in\n  <a href=\"http://www.3gpp.org/\">\n   3GPP's website\n  </a>\n  . To find them, you need to determine the\n  <a href=\"http://www.3gpp.org/Specification-Numbering\">\n   numbering\n  </a>\n  of the part you're looking for. Then, you browse into\n  <a href=\"ftp://ftp.3gpp.org/specs/\">\n   their ftp server\n  </a>\n  and look for the date and release you fancy. (Releases prior to 2012-13 need to be solicited through their contact mail). Supposing you want the latest \"3G and Beyond / GSM\" Signalling Protocols specifications, you'll need to browse to their \"latest\" folder, descend to the release you're looking for (i.e. Release 12), and finally download the \"Series\" that contain the information you need - which in this case would be \"Series 24\". Therefore, the result of your endeavor would be :\n  <a href=\"ftp://ftp.3gpp.org/specs/latest/Rel-12/24_series/\">\n   ftp://ftp.3gpp.org/specs/latest/Rel-12/24_series/\n  </a>\n  .\nIt's not a good user experience, especially because there are several empty directories, but with patience, you can find what you're looking for.\n </p>\n <p>\n  <a href=\"https://twitter.com/gat3way\">\n   @gat3way\n  </a>\n  deserves a special mention for documenting his experiments in cracking GSM A5/1 in his blog (\n  <a href=\"http://www.gat3way.eu/index.php?mact=News,cntnt01,detail,0&cntnt01articleid=199&cntnt01returnid=57\">\n   1\n  </a>\n  ,\n  <a href=\"http://www.gat3way.eu/index.php?mact=News,cntnt01,detail,0&cntnt01articleid=200&cntnt01returnid=57\">\n   2\n  </a>\n  ,\n  <a href=\"http://www.gat3way.eu/index.php?mact=News,cntnt01,detail,0&cntnt01articleid=201&cntnt01returnid=57\">\n   3\n  </a>\n  )  - includes a brief description of the A5/1 mechanism - and the fact that he has implemented support for cracking A5/1 using Pornin's attack in his password recovery tool,\n  <a href=\"http://www.gat3way.eu/hashkill/index.php\">\n   hashkill\n  </a>\n  -\n  <a href=\"https://github.com/gat3way/hashkill/commit/d43fdd2ce042d75862930044fd0b4570bee56cf0\">\n   git commit\n  </a>\n  .\n </p>\n <p>\n  An existing tool to crack A5/1 is Kraken, by srlabs (available through git://git.srlabs.de/kraken.git), which should be used after recording the data with Gnuradio/Gqrx and parsing it with\n  <a href=\"https://svn.berlin.ccc.de/projects/airprobe/\">\n   Airprobe\n  </a>\n  . It needs GSM rainbow tables, available at the\n  <a href=\"https://opensource.srlabs.de/projects/a51-decrypt/files\">\n   jump\n  </a>\n  .\n </p>\n <p>\n  Another tool that can be considered is\n  <a href=\"https://github.com/gat3way/hashkill/\">\n   hashkill\n  </a>\n  , which takes the key to be cracked in a \"frame_number:keystream\" format - it's author published the code for converting a bin burst into the required input format\n  <a href=\"http://www.gat3way.eu/poc/encode.c\">\n   here\n  </a>\n  . He also published a\n  <a href=\"http://www.gat3way.eu/poc/si5.phps\">\n   php script\n  </a>\n  to locate suitable SI5/SI6 encrypted bursts for cracking - you'll need to change the hardcoded values for SI5 frames to fit your location -, which, together with Kraken's xortool,\n  <a href=\"http://www.mail-archive.com/a51@lists.reflextor.com/msg01023.html\">\n   gsmframecoder\n  </a>\n  (that will be used to calculate Timing Advance changes) and\n  <a href=\"https://svn.berlin.ccc.de/projects/airprobe/\">\n   Airprobe\n  </a>\n  should be sufficient to crack GSM.\n </p>\n</div>\n</body></html>",
            "votes": "23",
            "user": "TDKPS",
            "time": "Oct 31, 2013 at 22:33",
            "is_accepted": true,
            "comments": [
                {
                    "user": "0xea",
                    "text": "<span class=\"comment-copy\">now that's a thorough answer!</span>",
                    "time": null
                }
            ]
        },
        {
            "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  <a href=\"https://twitter.com/domi007\">\n   @domi007\n  </a>\n  recently published a\n  <a href=\"http://domonkos.tomcsanyi.net/?p=418\">\n   series of blog posts\n  </a>\n  detailing his efforts on snooping and decrypting GSM. Insted of USRP, he used\n  <a href=\"http://sdr.osmocom.org/trac/wiki/rtl-sdr\">\n   rtlsdr\n  </a>\n  . He also used an\n  <a href=\"http://bb.osmocom.org/trac/\">\n   osmocomBB\n  </a>\n  enabled phone. His efforts build upon the research done by Karsten Nohl on\n  <a href=\"https://events.ccc.de/congress/2009/Fahrplan/events/3654.en.html\">\n   cracking GSM\n  </a>\n  (you can see the video too) and his ~1.5 terabyte of rainbow tables.\n </p>\n</div>\n</body></html>",
            "votes": "12",
            "user": "0xea",
            "time": "Oct 27, 2013 at 9:05",
            "is_accepted": false,
            "comments": []
        }
    ]
}