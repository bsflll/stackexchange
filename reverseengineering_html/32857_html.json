{
    "title": "How to decrypt Zyxel's 'Backup_Restore' config file?",
    "link": "https://reverseengineering.stackexchange.com/questions/32857/how-to-decrypt-zyxels-backup-restore-config-file",
    "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  I have a VMG3625-T50B running an ISP-dedicated firmware version (\n  <strong>\n   V550ABTL0b2r\n  </strong>\n  ). I managed to get the\n  <strong>\n   <code>\n    supervisor\n   </code>\n  </strong>\n  password yet I can't enable open an SSH port because my SP disabled that option.\n </p>\n <p>\n  I've been doing some research and found this\n  <a href=\"https://th0mas.nl/2020/03/26/getting-root-on-a-zyxel-vmg8825-t50-router/\" rel=\"nofollow noreferrer\">\n   blog\n  </a>\n  that on getting a root access on a similar modem (the differences are merely zero). In the blog, Thomas describes how he gets root access by modifying the\n  <code>\n   Backup_Restore\n  </code>\n  JSON file. Unfortunately, mine is openssl-encrypted. The first line of the file is:\n </p>\n <pre><code>Salted__D-\"\u000b¶و9#-|ڈèق…[تµمزâ#:xUقطد¦é‏¨ں\" ء6Œ…5Iير\fّ×@ c‎µٹئ_6cه¶k\n</code></pre>\n <p>\n  I've read somewhere on GitHub that I can decrypt the file using the\n  <strong>\n   <code>\n    supervisor\n   </code>\n  </strong>\n  password and I tried every password generated by\n  <a href=\"https://github.com/boginw/zyxel-vmg8825-keygen\" rel=\"nofollow noreferrer\">\n   boginw's keygen\n  </a>\n  but I had no luck. (The password that works for my modem is generated using\n  <code>\n   zcfgBeCommonGenKeyBySerialNumMethod3\n  </code>\n  ).\n </p>\n <p>\n  I need to enable SSH so that I can debrand that modem and flash the global firmware, but that won't happen until I disable 'firmware ID check' aka\n  <code>\n   fwidcheck\n  </code>\n  using\n  <code>\n   zycli\n  </code>\n  .\n </p>\n <p>\n  Does anyone have any idea how to enable SSH on that modem by modifying the\n  <code>\n   Backup_Restore\n  </code>\n  file? or any other way really\n </p>\n</div>\n</body></html>",
    "votes": "2",
    "answers": 1,
    "views": "261",
    "tags": [
        "decompilation",
        "decryption"
    ],
    "user": "Khalid",
    "time": "Apr 1, 2024 at 2:04",
    "comments": [
        {
            "user": "the busybee",
            "text": "<html><body><span class=\"comment-copy\">\n Are you sure you are allowed to enable a feature that your SP disabled? Didn't you accept the contract?\n</span>\n</body></html>",
            "time": null
        }
    ],
    "answers_data": [
        {
            "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  I'm trying same thing on a Zyxel dx5401-b1 (TM firmware). Looks like they have made huge effort to close all sw gaps, boginw's keygen is not working as my serial number has no Y in it and the backup cfg has been encrypted probably (my guess) with the supervisor pw. The bootloader(cfe) has been locked and needs pw to unlock, serial console flash checks for hash!\nMaybe you can try to run some metasploit modules (I had no luck there!) that are available for your router to try to get a root shell. It seems like ssh, telnet and smb are enabled but restricted (fw).\nAnother option is to exploit the dns port, which is allways open. I will try that next !\nLast resort is taking the nand flash off the board and flash it.\n </p>\n</div>\n</body></html>",
            "votes": "0",
            "user": "intrax",
            "time": "Jul 20, 2024 at 14:40",
            "is_accepted": false,
            "comments": []
        }
    ]
}