{
    "title": "How can I detect which Android native function that is hooked by Mobile Substrate: MSHookFunction?",
    "link": "https://reverseengineering.stackexchange.com/questions/31415/how-can-i-detect-which-android-native-function-that-is-hooked-by-mobile-substrat",
    "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  I want to detect hook behavior of MSHookFunction on Android. This is Mobile Substrate I use in my test app\n  <a href=\"https://github.com/Breathleas/Android-Hooking-Template-Cydia-Substrate/tree/master/jni/Substrate\" rel=\"nofollow noreferrer\">\n   https://github.com/Breathleas/Android-Hooking-Template-Cydia-Substrate/tree/master/jni/Substrate\n  </a>\n </p>\n <p>\n  After complete function hook. I tried comparing the\n  <code>\n   .text\n  </code>\n  section between the in-memory module and the shared object lib file but couldn't find the trampoline function. Here is the Frida script on the codeshare that I referenced\n  <a href=\"https://codeshare.frida.re/@lichao890427/find-android-hook/\" rel=\"nofollow noreferrer\">\n   https://codeshare.frida.re/@lichao890427/find-android-hook/\n  </a>\n  . The origin function is hooked but\n  <code>\n   .text\n  </code>\n  section data in memory is same with shared object lib file. I also used memory tools like Cheat Engine or Game-Guardian (on Android) to look for the offset I hooked in memory and found it wasn't replaced. So, how did MSHookFunction work and how can I detect hooked functions ?\n </p>\n</div>\n</body></html>",
    "votes": "2",
    "answers": 0,
    "views": "213",
    "tags": [
        "android",
        "function-hooking",
        "frida"
    ],
    "user": "Ken Kem",
    "time": "Jan 16, 2023 at 3:08",
    "comments": [],
    "answers_data": []
}