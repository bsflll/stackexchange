{
    "title": "Possible to capture/replay GUI functions by “puppet-stringing”? [closed]",
    "link": "https://reverseengineering.stackexchange.com/questions/8307/possible-to-capture-replay-gui-functions-by-puppet-stringing",
    "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <div>\n  <aside class=\"s-notice s-notice__info post-notice js-post-notice mb16\" role=\"status\">\n   <div class=\"d-flex fd-column fw-nowrap\">\n    <div class=\"d-flex fw-nowrap\">\n     <div class=\"flex--item wmn0 fl1 lh-lg\">\n      <div class=\"flex--item fl1 lh-lg\">\n       <div>\n        <b>\n         Closed.\n        </b>\n        This question is\n        <a href=\"/help/closed-questions\">\n         off-topic\n        </a>\n        . It is not currently accepting answers.\n       </div>\n      </div>\n     </div>\n    </div>\n   </div>\n   <hr class=\"my12 outline-none baw0 bb bc-blue-400\"/>\n   <div class=\"fw-nowrap fc-black-500\">\n    <div class=\"d-flex fd-column lh-md\">\n     <div class=\"mb0 d-flex\">\n      <div class=\"flex--item mr8\">\n       <svg aria-hidden=\"true\" class=\"svg-icon iconLightbulb\" height=\"18\" viewbox=\"0 0 18 18\" width=\"18\">\n        <path d=\"M15 6.38A6.5 6.5 0 0 0 7.78.04h-.02A6.5 6.5 0 0 0 2.05 5.6a6.3 6.3 0 0 0 2.39 5.75c.49.39.76.93.76 1.5v.24c0 1.07.89 1.9 1.92 1.9h2.75c1.04 0 1.92-.83 1.92-1.9v-.2c0-.6.26-1.15.7-1.48A6.3 6.3 0 0 0 15 6.37M4.03 5.85A4.5 4.5 0 0 1 8 2.02a4.5 4.5 0 0 1 5 4.36 4.3 4.3 0 0 1-1.72 3.44c-.98.74-1.5 1.9-1.5 3.08v.1H7.2v-.14c0-1.23-.6-2.34-1.53-3.07a4.3 4.3 0 0 1-1.64-3.94M10 18a1 1 0 0 0 0-2H7a1 1 0 1 0 0 2z\">\n        </path>\n       </svg>\n      </div>\n      <p>\n       Questions on\n       <b>\n        software development\n       </b>\n       are off-topic here, but can be asked on\n       <a href=\"http://stackoverflow.com/about\">\n        Stack Overflow\n       </a>\n       .\n      </p>\n     </div>\n     <div class=\"mb0 mt6 d-flex\">\n      <p class=\"ml24 pl2\">\n       Closed\n       <span class=\"relativetime\" title=\"2015-02-27 16:22:32Z\">\n        10 years ago\n       </span>\n       .\n      </p>\n     </div>\n     <div class=\"ml24 pl2\">\n     </div>\n    </div>\n   </div>\n   <div class=\"mt24 d-flex gsx gs8\">\n    <a class=\"s-btn s-btn__outlined flex--item js-post-notice-edit-post\" href=\"/posts/8307/edit\">\n     Improve this question\n    </a>\n   </div>\n  </aside>\n </div>\n <p>\n  When clicking a GUI, there's underlying code somewhere getting executed. Is it possible to capture this \"puppet-stringing\" so that it can be manually called on demand (without clicking the GUI)?\n </p>\n <p>\n  For example:\n </p>\n <p>\n  In Internet Explorer's dev-console, there's a button for \"Clear domain cookies\", however it's only accessible with the dev console pulled up and via button-click.\n </p>\n <p>\n  Would it be possible to \"catch\" this underlying function getting called, and then call it on my own via programmatic puppet-stringing?\n </p>\n</div>\n</body></html>",
    "votes": "1",
    "answers": 1,
    "views": "246",
    "tags": [
        "ida",
        "windows"
    ],
    "user": "Coldblackice",
    "time": "10 years ago",
    "comments": [],
    "answers_data": [
        {
            "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  Theoretically, yes, you could do something like that. In normal windows Dialogs, you could get the onClick function of the button, and even if your program uses some other way of creating GUI elements (Java/Swing, QT, GTK, wxWidgets, Delphi, ....), you could find out what happens when the button is pressed by attaching a debugger, single-stepping, running in emulation mode, whatever.\n </p>\n <p>\n  Some of these methods could be well automated (finding the onClick function of the button, which means more or less checking what the window procedure does when sent a\n  <code>\n   WM_COMMAND\n  </code>\n  with a\n  <code>\n   BN_CLICKED\n  </code>\n  param, or a\n  <code>\n   WM_LBUTTONDOWN\n  </code>\n  message, or getting the list of ActionHandlers from a Java JButton), some need more manual investigation.\n </p>\n <p>\n  Then you could inject a DLL into the program that calls the function you found whenever \"something happens\", where \"something happens\" is how you communicate with the DLL to tell it to \"call the cookie-cleaner\".\n </p>\n <p>\n  However, there's a very big chance that you'll just crash the program, because a part of what the button does is probably tied closely to the state of the program, especially the GUI state. Maybe the handler function disables the button after you click it, and re-enables it after it's finished. Or the handler function shows some message in a box next to the button. If you just call the handler, without the GUI elements being there, your program will most likely crash.\n </p>\n <p>\n  So to do this, you'd have to disassemble the better part of the program, understand much of what it is doing, and separate the backend procedures (clear the cache) from the frontend (that handles the GUI); depending on how well the code is separated into backend and frontend, this may not even be possible. After identifying the backend part that you can call safely, you'd have to figure out how to find this part from your DLL (ASLR might put it at different addresses; localized versions of the software may have different addresses; and after your next automated windows update, the whole software layout might change), then create a DLL that will work for just this version of the software until the next update.\n </p>\n <p>\n  You'll probably have much better results with a software like AutoHotKey, which will allow you to create a macro that finds a button within the window hierarchy, and allows you to send a click event to the button. This will require you to have the GUI in a state that shows the button and allows clicking it, but making AutoHotKey (or a similar program) find the button will be much easier and less error-prone than finding out what to call and call that somehow.\n </p>\n</div>\n</body></html>",
            "votes": "1",
            "user": "Guntram Blohm",
            "time": "Feb 21, 2015 at 21:50",
            "is_accepted": false,
            "comments": []
        }
    ]
}