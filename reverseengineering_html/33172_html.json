{
    "title": "How the 'Secure Application ROM (SAROM)' works ? and how can be decrypted?",
    "link": "https://reverseengineering.stackexchange.com/questions/33172/how-the-secure-application-rom-sarom-works-and-how-can-be-decrypted",
    "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  There is a protection product that i'm interested in analyzing and breaking it called\n  <a href=\"https://promon.co/security-news/promon-announces-secure-application-rom-sarom\" rel=\"nofollow noreferrer\">\n   SAROM\n  </a>\n  that encrypts sensitive information that stored in the client-side such as API Keys/hardcoded stuff. I tried to understand it from an\n  <a href=\"https://fastupload.io/3aaf0f90931f4d09\" rel=\"nofollow noreferrer\">\n   example\n  </a>\n  that uses\n  <a href=\"https://promon.co/security-news/promon-announces-secure-application-rom-sarom\" rel=\"nofollow noreferrer\">\n   SAROM\n  </a>\n  , which is an iOS app using\n  <a href=\"https://promon.co/security-news/promon-announces-secure-application-rom-sarom\" rel=\"nofollow noreferrer\">\n   SAROM\n  </a>\n  as a data protection and\n  <a href=\"https://github.com/securing/IOSSecuritySuite\" rel=\"nofollow noreferrer\">\n   IOSSecuritySuite\n  </a>\n  as an anti-(jb/reversing/debugging/etc..) protection, but I couldn't. There are\n  <a href=\"https://fastupload.io/ac24d61c314a8cb8\" rel=\"nofollow noreferrer\">\n   two mach-o binaries\n  </a>\n  inside the\n  <a href=\"https://fastupload.io/3aaf0f90931f4d09\" rel=\"nofollow noreferrer\">\n   example\n  </a>\n  , the\n  <strong>\n   core\n  </strong>\n  which is a framework binary has the\n  <a href=\"https://promon.co/security-news/promon-announces-secure-application-rom-sarom\" rel=\"nofollow noreferrer\">\n   SAROM\n  </a>\n  implementation, and the\n  <strong>\n   bundle\n  </strong>\n  that calling the\n  <a href=\"https://promon.co/security-news/promon-announces-secure-application-rom-sarom\" rel=\"nofollow noreferrer\">\n   SAROM\n  </a>\n  call which is\n  <code>\n   +[NSData dataFromSecureAppROMItem:]\n  </code>\n  (located in\n  <strong>\n   core\n  </strong>\n  mach-o binary file). Now where are the encrypted data ? They are located in the\n  <strong>\n   5341524f4d\n  </strong>\n  folder in the example. i uploaded it\n  <a href=\"https://fastupload.io/675d1369e43eed0f\" rel=\"nofollow noreferrer\">\n   here\n  </a>\n  , the\n  <code>\n   +[NSData dataFromSecureAppROMItem:]\n  </code>\n  method is the call that responsible of decrypting it.\n </p>\n <p>\n  P.S: i tried calling it using frida\n  <code>\n   ObjC.classes.NSData.dataFromSecureAppROMItem_(ObjC.classes.NSString)\n  </code>\n  but didn't work, probably because of how\n  <code>\n   +[NSData dataFromSecureAppROMItem:]\n  </code>\n  it works (the argument is the NSString's\n  <code>\n   self\n  </code>\n  : so probably the passed data has been accessed in an unusual way such as accessing it from an outside-the-method pointer) +\n  <a href=\"https://github.com/securing/IOSSecuritySuite\" rel=\"nofollow noreferrer\">\n   IOSSecuritySuite\n  </a>\n  making it more harder dynamically but the main thing is how\n  <a href=\"https://promon.co/security-news/promon-announces-secure-application-rom-sarom\" rel=\"nofollow noreferrer\">\n   SAROM\n  </a>\n  works and it will be very helpful for understanding to write a script decrypting the\n  <a href=\"https://fastupload.io/675d1369e43eed0f\" rel=\"nofollow noreferrer\">\n   data\n  </a>\n </p>\n</div>\n</body></html>",
    "votes": "0",
    "answers": 0,
    "views": "49",
    "tags": [
        "static-analysis",
        "encryption",
        "ios",
        "encodings",
        "mach-o"
    ],
    "user": "IVs",
    "time": "Aug 20, 2024 at 15:53",
    "comments": [],
    "answers_data": []
}