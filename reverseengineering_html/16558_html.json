{
    "title": "Disassembling at a memory address",
    "link": "https://reverseengineering.stackexchange.com/questions/16558/disassembling-at-a-memory-address",
    "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  I started to use radare2 to debug a PE file because it stops working as soon as I run it. When I attach my debugger and continue execution to the point where the exception is thrown I get a memory address in which the exception occurred.\n </p>\n <p>\n  What can I do with this address to further analyze the problem at hand?\n </p>\n <pre><code>c484f\\mscorlib.ni.dll) mscorlib.ni.dll\n(14116) loading library at 77130000 (C:\\Windows\\SysWOW64\\ole32.dll) ole32.dll\n(14116) loading library at 70100000 (C:\\Windows\\SysWOW64\\uxtheme.dll) uxtheme.dll\n(14116) loading library at 700A0000 (C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\mscorjit.dll) mscorjit.dll\n(14116) loading library at 6C3C0000 (C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\Culture.dll) Culture.dll\n(14116) unloading library at 6C3C0000 (C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\Culture.dll) Culture.dll\n(14116) Unknown exception e06d7363 in thread 10352\n</code></pre>\n</div>\n</body></html>",
    "votes": "3",
    "answers": 2,
    "views": "2k",
    "tags": [
        "disassembly",
        "windows",
        "pe",
        "radare2"
    ],
    "user": "Hooga",
    "time": "Oct 16, 2017 at 16:49",
    "comments": [
        {
            "user": "Paweł Łukasik",
            "text": "<html><body><span class=\"comment-copy\">\n what version of r2 are you using?\n</span>\n</body></html>",
            "time": null
        },
        {
            "user": "Hooga",
            "text": "<html><body><span class=\"comment-copy\">\n Went to the website and downloaded the most recent\n</span>\n</body></html>",
            "time": null
        },
        {
            "user": "HamZa",
            "text": "<html><body><span class=\"comment-copy\">\n Which debugger are you using? Have you tried debugging it with radare2?\n <code>\n  r2 -d program.exe\n </code>\n</span>\n</body></html>",
            "time": null
        },
        {
            "user": "Hooga",
            "text": "<html><body><span class=\"comment-copy\">\n Yes that is exactly the command I ran\n</span>\n</body></html>",
            "time": null
        }
    ],
    "answers_data": [
        {
            "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  <em>\n   Since the question in the subject is slightly different than the question in the body of your question, I'll focus on the first one.\n  </em>\n </p>\n <h2>\n  Disassemble at a specific address\n </h2>\n <p>\n  In order to disassemble the code at a specific memory address using radare2 you should use the\n  <code>\n   pd @ <address>\n  </code>\n  command.\n </p>\n <blockquote>\n  <p>\n   pd[?] [sz] [a] [b] — disassemble N opcodes (pd) or N bytes\n  (pD)\n  </p>\n </blockquote>\n <p>\n  After attaching radare to the program you should be able to print the disassembly in this specific address. Assuming the\n  <code>\n   pid\n  </code>\n  of the program is\n  <em>\n   317\n  </em>\n  :\n </p>\n <pre><code>$ radare2 -d 317\n= attach 317 317\nbin.baddr 0x00400000\nUsing 0x400000\nasm.bits 64\n\n[0x7f2e51727230]> pd @ <address>\n</code></pre>\n <p>\n  <code>\n   pd\n  </code>\n  is a subcommand of\n  <code>\n   p\n  </code>\n  and stands for\n  <strong>\n   p\n  </strong>\n  rint\n  <strong>\n   d\n  </strong>\n  isassembly. You can check\n  <code>\n   p?\n  </code>\n  and especially\n  <code>\n   pd?\n  </code>\n  for more relevant subcommands. Adding\n  <code>\n   ?\n  </code>\n  at the end of most of the commands in radare will print its help and its subcommands. By default,\n  <code>\n   pd\n  </code>\n  prints\n  <em>\n   b\n  </em>\n  instructions from the specified address where\n  <em>\n   b\n  </em>\n  is the default basic-block size. The default size of\n  <em>\n   b\n  </em>\n  is 0x100 but you can change it easily using\n  <code>\n   b <size>\n  </code>\n  .\n </p>\n <p>\n  The\n  <code>\n   @\n  </code>\n  sign is radare's temporary seek address so whenever you want to print the disassembly in a specific address you should use it. The number specified before the\n  <code>\n   @\n  </code>\n  sign is the number of instructions to print. A common mistake is executing\n  <code>\n   pd\n  </code>\n  with the address before\n  <code>\n   @\n  </code>\n  . Thus, executing\n  <code>\n   pd 0x400000\n  </code>\n  would print\n  <strong>\n   0x400000 instructions\n  </strong>\n  from the current seek.\n </p>\n <hr/>\n <h2>\n  The exception\n </h2>\n <p>\n  You received\n  <em>\n   \"Unknown exception e06d7363\"\n  </em>\n  which is an exception generated by\n  <em>\n   Microsoft Visual C++ compiler\n  </em>\n  .\n </p>\n <p>\n  As stated in Microsoft's\n  <a href=\"https://support.microsoft.com/en-us/help/185294/prb-exception-code-0xe06d7363-when-calling-win32-seh-apis\" rel=\"noreferrer\">\n   support page\n  </a>\n  :\n </p>\n <blockquote>\n  <p>\n   <strong>\n    Cause\n   </strong>\n   \n\n   All Visual C++ exceptions thrown from code generated by the\n  Microsoft Visual C++ compiler contain this error code. Because this is\n  a compiler-generated error, the code is not listed in the Win32 API\n  header files. The code is actually a cryptic mnemonic device, with the\n  initial \"E\" standing for \"exception\" and the final 3 bytes (0x6D7363)\n  representing the ASCII values of \"msc\".\n  </p>\n </blockquote>\n <p>\n  To continue your analysis I'd suggest you to read\n  <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20100730-00/?p=13273\" rel=\"noreferrer\">\n   Decoding the parameters of a thrown C++ exception (0xE06D7363)\n  </a>\n  and its\n  <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20160915-00/?p=94316\" rel=\"noreferrer\">\n   revisited\n  </a>\n  article.\n </p>\n <p>\n  Note that the addresses of the executable in the memory might change in each run, depends on your system and the program itself. Therefore, sometimes you won't be able to predict what would be the address which causes the exception.\n </p>\n <p>\n  Check the\n  <a href=\"https://radare.gitbooks.io/radare2book/content/debugger/migration.html\" rel=\"noreferrer\">\n   Migration from ida, GDB or WinDBG\n  </a>\n  page from\n  <em>\n   radare2 book\n  </em>\n  to see radare's corresponding commands to WinDBG's.\n </p>\n</div>\n</body></html>",
            "votes": "6",
            "user": "Megabeets",
            "time": "Oct 16, 2017 at 8:41",
            "is_accepted": true,
            "comments": []
        },
        {
            "content": "<html><body><div class=\"s-prose js-post-body\" itemprop=\"text\">\n <p>\n  From the manual:\n </p>\n <ul>\n  <li>\n   'p' stands for print.\n  </li>\n  <li>\n   'd' stands for disassemble (raw usually)\n  </li>\n </ul>\n <p>\n  Try:\n </p>\n <pre><code>pd @ 0xYourAddress\n</code></pre>\n <p>\n  Note: I am unsure if this will work in the event of an exception.\n </p>\n</div>\n</body></html>",
            "votes": "0",
            "user": "Megabeets",
            "time": "Oct 17, 2017 at 10:06",
            "is_accepted": false,
            "comments": [
                {
                    "user": "Megabeets",
                    "text": "<span class=\"comment-copy\">You have a mistake, it should be <code>pd @ 0xYourAddress</code>. Otherwise it'd print <i>0xYourAddress</i> instructions.</span>",
                    "time": null
                },
                {
                    "user": "Alpha",
                    "text": "<span class=\"comment-copy\">Oh, my bad, I'll correct it for future reference. Thank you</span>",
                    "time": null
                }
            ]
        }
    ]
}