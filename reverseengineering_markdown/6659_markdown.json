{
  "title": "Windows CE + Itron RTOS image",
  "link": "https://reverseengineering.stackexchange.com/questions/6659/windows-ce-itron-rtos-image",
  "content": "I'm working on unpacking a firmware image, I managed to uncompress the original image but I'm stuck in the current step.\n\nFirst of all this is the current uncompressed image: https://www.dropbox.com/s/7oq4m2zryid3ugv/FW_ZERO_DES.bin?dl=0\n\nAcording with what I have found the image contains an hybrid between Windows CE and Itron RTOS called Windows Aceleration Tool:\n\nhttp://www.ertl.jp/ITRON/DOC/iim99/Elmic.pdf\n\nHere are some references to it:\n\n```\n000941e0  75 69 74 72 6f 6e 2e 63  79 67 77 69 6e 5f 69 6e  |uitron.cygwin_in|\n00094290  6e 74 39 36 36 35 30 2e  75 69 74 72 6f 6e 2e 63  |nt96650.uitron.c|\n000a0be0  36 35 30 2e 75 69 74 72  6f 6e 2e 63 79 67 77 69  |650.uitron.cygwi|\n000a2b50  75 69 74 72 6f 6e 2e 63  79 67 77 69 6e 5f 69 6e  |uitron.cygwin_in|\n\n```\nHere you can see Itron references with cygwin and below the Windows CE references:\n\n```\nDECIMAL         HEX             DESCRIPTION\n    -------------------------------------------------------------------------------------------------------------------\n[...]\n4592396         0x46130C        Windows CE RTOS\n4592400         0x461310        Windows CE RTOS\n4592404         0x461314        Windows CE RTOS\n4592408         0x461318        Windows CE RTOS\n4592412         0x46131C        Windows CE RTOS\n4592416         0x461320        Windows CE RTOS\n[...]\n\n```\nAlso I found some syscalls related ti Windows Aceleration Tool like cre_tsk().\n\nChecking the hexdump I found some Windows CE magic number references ( B0 00 FF ) accordin to this documentation http://forum.xda-developers.com/showthread.php?t=801167 :\n\n```\nstruct BIN_HEADER {\nchar[7] Signature;      // B000FF  \n signature   \nDWORD ImageStart;    // Image Start\nDWORD ImageLength; // Image Length\n};\n\n```\nMy problem now is that I don't see the correct byte structure for Image Start and Image Length. I want to separate all the pieces on this image but I'm stuck here.\n\nAm I in the good way or Am I completely out of focus? How can I continue?\n\n",
  "votes": "0",
  "answers": 1,
  "views": "2k",
  "tags": [
    "firmware",
    "unpacking",
    "hexadecimal"
  ],
  "user": "Nucklear",
  "time": "Nov 19, 2014 at 8:48",
  "comments": [],
  "answers_data": [
    {
      "content": "Actually, from the strings, it looks to me like it's using eCos, not Windows CE:\n\n```\n$ binwalk FW_ZERO_DES.bin\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n28494         0x6F4E          eCos RTOS string reference: \"eCos Thread[%.2ld, %s]\"\n29723         0x741B          eCos RTOS string reference: \"eCos Thread =========================\"\n512758        0x7D2F6         eCos RTOS string reference: \"eCos> is not exist!\"\n512793        0x7D319         eCos RTOS string reference: \"eCos> console.\"\n597136        0x91C90         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/infra/v2_0_60/src/tcdiag.cxx\"\n597141        0x91C95         eCos RTOS string reference: \"ecos-2.0.6/packages/infra/v2_0_60/src/tcdiag.cxx\"\n598072        0x92038         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/infra/v2_0_60/src/pure.cxx\"\n598077        0x9203D         eCos RTOS string reference: \"ecos-2.0.6/packages/infra/v2_0_60/src/pure.cxx\"\n600072        0x92808         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/kernel/v2_0_60/src/common/clock.cxx\"\n600077        0x9280D         eCos RTOS string reference: \"ecos-2.0.6/packages/kernel/v2_0_60/src/common/clock.cxx\"\n606656        0x941C0         eCos RTOS string reference: \"ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/kernel/smp.hxx\"\n606661        0x941C5         eCos RTOS string reference: \"ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/kernel/smp.hxx\"\n606840        0x94278         eCos RTOS string reference: \"ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/kernel/thread.inl\"\n606845        0x9427D         eCos RTOS string reference: \"ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/kernel/thread.inl\"\n607004        0x9431C         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/kernel/v2_0_60/src/common/kapi.cxx\"\n607009        0x94321         eCos RTOS string reference: \"ecos-2.0.6/packages/kernel/v2_0_60/src/common/kapi.cxx\"\n611740        0x9559C         eCos RTOS string reference: \"eCos on NT96650A! <<<<\"\n611788        0x955CC         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/kernel/v2_0_60/src/common/thread.cxx\"\n611793        0x955D1         eCos RTOS string reference: \"ecos-2.0.6/packages/kernel/v2_0_60/src/common/thread.cxx\"\n619372        0x9736C         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/kernel/v2_0_60/src/common/except.cxx\"\n619377        0x97371         eCos RTOS string reference: \"ecos-2.0.6/packages/kernel/v2_0_60/src/common/except.cxx\"\n620228        0x976C4         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/kernel/v2_0_60/src/intr/intr.cxx\"\n620233        0x976C9         eCos RTOS string reference: \"ecos-2.0.6/packages/kernel/v2_0_60/src/intr/intr.cxx\"\n623552        0x983C0         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/kernel/v2_0_60/src/sched/mlqueue.cxx\"\n623557        0x983C5         eCos RTOS string reference: \"ecos-2.0.6/packages/kernel/v2_0_60/src/sched/mlqueue.cxx\"\n627044        0x99164         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/kernel/v2_0_60/src/sched/sched.cxx\"\n627049        0x99169         eCos RTOS string reference: \"ecos-2.0.6/packages/kernel/v2_0_60/src/sched/sched.cxx\"\n632140        0x9A54C         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/kernel/v2_0_60/src/sync/cnt_sem.cxx\"\n632145        0x9A551         eCos RTOS string reference: \"ecos-2.0.6/packages/kernel/v2_0_60/src/sync/cnt_sem.cxx\"\n632512        0x9A6C0         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/kernel/v2_0_60/src/sync/flag.cxx\"\n632517        0x9A6C5         eCos RTOS string reference: \"ecos-2.0.6/packages/kernel/v2_0_60/src/sync/flag.cxx\"\n636124        0x9B4DC         eCos RTOS string reference: \"ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/kernel/mboxt2.inl\"\n636129        0x9B4E1         eCos RTOS string reference: \"ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/kernel/mboxt2.inl\"\n639396        0x9C1A4         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/kernel/v2_0_60/src/sync/mutex.cxx\"\n639401        0x9C1A9         eCos RTOS string reference: \"ecos-2.0.6/packages/kernel/v2_0_60/src/sync/mutex.cxx\"\n644816        0x9D6D0         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/services/memalloc/common/v2_0_60/src/dlmalloc.cxx\"\n644821        0x9D6D5         eCos RTOS string reference: \"ecos-2.0.6/packages/services/memalloc/common/v2_0_60/src/dlmalloc.cxx\"\n652748        0x9F5CC         eCos RTOS string reference: \"ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/memalloc/mfiximpl.inl\"\n652753        0x9F5D1         eCos RTOS string reference: \"ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/memalloc/mfiximpl.inl\"\n658372        0xA0BC4         eCos RTOS string reference: \"ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/memalloc/mvarimpl.inl\"\n658377        0xA0BC9         eCos RTOS string reference: \"ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/memalloc/mvarimpl.inl\"\n663684        0xA2084         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/services/memalloc/common/v2_0_60/src/kapi.cxx\"\n663689        0xA2089         eCos RTOS string reference: \"ecos-2.0.6/packages/services/memalloc/common/v2_0_60/src/kapi.cxx\"\n664672        0xA2460         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/language/c/libc/startup/v2_0_60/src/_exit.cxx\"\n664677        0xA2465         eCos RTOS string reference: \"ecos-2.0.6/packages/language/c/libc/startup/v2_0_60/src/_exit.cxx\"\n664916        0xA2554         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/language/c/libc/startup/v2_0_60/src/abort.cxx\"\n664921        0xA2559         eCos RTOS string reference: \"ecos-2.0.6/packages/language/c/libc/startup/v2_0_60/src/abort.cxx\"\n665128        0xA2628         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/language/c/libc/startup/v2_0_60/src/atexit.cxx\"\n665133        0xA262D         eCos RTOS string reference: \"ecos-2.0.6/packages/language/c/libc/startup/v2_0_60/src/atexit.cxx\"\n665820        0xA28DC         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/language/c/libc/startup/v2_0_60/src/invokemain.cxx\"\n665825        0xA28E1         eCos RTOS string reference: \"ecos-2.0.6/packages/language/c/libc/startup/v2_0_60/src/invokemain.cxx\"\n666092        0xA29EC         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/language/c/libc/startup/v2_0_60/src/main.cxx\"\n666097        0xA29F1         eCos RTOS string reference: \"ecos-2.0.6/packages/language/c/libc/startup/v2_0_60/src/main.cxx\"\n666416        0xA2B30         eCos RTOS string reference: \"ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/libc/stdio/stdiofiles.inl\"\n666421        0xA2B35         eCos RTOS string reference: \"ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/libc/stdio/stdiofiles.inl\"\n666584        0xA2BD8         eCos RTOS string reference: \"ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/libc/stdio/stream.inl\"\n666589        0xA2BDD         eCos RTOS string reference: \"ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/libc/stdio/stream.inl\"\n670072        0xA3978         eCos RTOS string reference: \"ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/libc/stdio/streambuf.inl\"\n670077        0xA397D         eCos RTOS string reference: \"ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/libc/stdio/streambuf.inl\"\n670252        0xA3A2C         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/language/c/libc/stdio/v2_0_60/src/common/stream.cxx\"\n670257        0xA3A31         eCos RTOS string reference: \"ecos-2.0.6/packages/language/c/libc/stdio/v2_0_60/src/common/stream.cxx\"\n697416        0xAA448         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/language/c/libc/stdlib/v2_0_60/src/getenv.cxx\"\n697421        0xAA44D         eCos RTOS string reference: \"ecos-2.0.6/packages/language/c/libc/stdlib/v2_0_60/src/getenv.cxx\"\n698080        0xAA6E0         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/language/c/libc/stdlib/v2_0_60/src/qsort.cxx\"\n698085        0xAA6E5         eCos RTOS string reference: \"ecos-2.0.6/packages/language/c/libc/stdlib/v2_0_60/src/qsort.cxx\"\n708812        0xAD0CC         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/language/c/libc/string/v2_0_60/src/strtok.cxx\"\n708817        0xAD0D1         eCos RTOS string reference: \"ecos-2.0.6/packages/language/c/libc/string/v2_0_60/src/strtok.cxx\"\n710856        0xAD8C8         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/language/c/libc/time/v2_0_60/src/strftime.cxx\"\n710861        0xAD8CD         eCos RTOS string reference: \"ecos-2.0.6/packages/language/c/libc/time/v2_0_60/src/strftime.cxx\"\n714740        0xAE7F4         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/language/c/libc/time/v2_0_60/src/timeutil.cxx\"\n714745        0xAE7F9         eCos RTOS string reference: \"ecos-2.0.6/packages/language/c/libc/time/v2_0_60/src/timeutil.cxx\"\n714860        0xAE86C         eCos RTOS string reference: \"ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/libc/stdlib/div.inl\"\n714865        0xAE871         eCos RTOS string reference: \"ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/libc/stdlib/div.inl\"\n736748        0xB3DEC         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/compat/posix/v2_0_60/src/pthread.cxx\"\n736753        0xB3DF1         eCos RTOS string reference: \"ecos-2.0.6/packages/compat/posix/v2_0_60/src/pthread.cxx\"\n741144        0xB4F18         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/compat/posix/v2_0_60/src/time.cxx\"\n741149        0xB4F1D         eCos RTOS string reference: \"ecos-2.0.6/packages/compat/posix/v2_0_60/src/time.cxx\"\n744468        0xB5C14         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/compat/posix/v2_0_60/src/signal.cxx\"\n744473        0xB5C19         eCos RTOS string reference: \"ecos-2.0.6/packages/compat/posix/v2_0_60/src/signal.cxx\"\n748556        0xB6C0C         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/io/fileio/v2_0_60/src/file.cxx\"\n748561        0xB6C11         eCos RTOS string reference: \"ecos-2.0.6/packages/io/fileio/v2_0_60/src/file.cxx\"\n753884        0xB80DC         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/io/fileio/v2_0_60/src/dir.cxx\"\n753889        0xB80E1         eCos RTOS string reference: \"ecos-2.0.6/packages/io/fileio/v2_0_60/src/dir.cxx\"\n760592        0xB9B10         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/io/eth/v2_0_60/src/net/eth_drv.c\"\n760597        0xB9B15         eCos RTOS string reference: \"ecos-2.0.6/packages/io/eth/v2_0_60/src/net/eth_drv.c\"\n773604        0xBCDE4         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/net/common/v2_0_60/src/dhcp_prot.c\"\n773609        0xBCDE9         eCos RTOS string reference: \"ecos-2.0.6/packages/net/common/v2_0_60/src/dhcp_prot.c\"\n793380        0xC1B24         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/net/common/v2_0_60/src/tftp_server.c\"\n793385        0xC1B29         eCos RTOS string reference: \"ecos-2.0.6/packages/net/common/v2_0_60/src/tftp_server.c\"\n799368        0xC3288         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/net/bsd_tcpip/v2_0_60/src/ecos/support.c\"\n799373        0xC328D         eCos RTOS string reference: \"ecos-2.0.6/packages/net/bsd_tcpip/v2_0_60/src/ecos/support.c\"\n799419        0xC32BB         eCos RTOS string reference: \"ecos/support.c\"\n800200        0xC35C8         eCos RTOS string reference: \"eCos_node\"\n806272        0xC4D80         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/net/bsd_tcpip/v2_0_60/src/ecos/synch.c\"\n806277        0xC4D85         eCos RTOS string reference: \"ecos-2.0.6/packages/net/bsd_tcpip/v2_0_60/src/ecos/synch.c\"\n806323        0xC4DB3         eCos RTOS string reference: \"ecos/synch.c\"\n810080        0xC5C60         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/net/bsd_tcpip/v2_0_60/src/ecos/timeout.c\"\n810085        0xC5C65         eCos RTOS string reference: \"ecos-2.0.6/packages/net/bsd_tcpip/v2_0_60/src/ecos/timeout.c\"\n810131        0xC5C93         eCos RTOS string reference: \"ecos/timeout.c\"\n986656        0xF0E20         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/compat/uitron/v2_0_60/src/uit_ifnc.cxx\"\n986661        0xF0E25         eCos RTOS string reference: \"ecos-2.0.6/packages/compat/uitron/v2_0_60/src/uit_ifnc.cxx\"\n996908        0xF362C         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/net/ns/dns/v2_0_60/src/dns.c\"\n996913        0xF3631         eCos RTOS string reference: \"ecos-2.0.6/packages/net/ns/dns/v2_0_60/src/dns.c\"\n1025792       0xFA700         eCos RTOS string reference: \"ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/memalloc/mempolt2.inl\"\n1025797       0xFA705         eCos RTOS string reference: \"ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/memalloc/mempolt2.inl\"\n1025944       0xFA798         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/services/memalloc/common/v2_0_60/src/malloc.cxx\"\n1025949       0xFA79D         eCos RTOS string reference: \"ecos-2.0.6/packages/services/memalloc/common/v2_0_60/src/malloc.cxx\"\n1026892       0xFAB4C         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/io/fileio/v2_0_60/src/misc.cxx\"\n1026897       0xFAB51         eCos RTOS string reference: \"ecos-2.0.6/packages/io/fileio/v2_0_60/src/misc.cxx\"\n1027064       0xFABF8         eCos RTOS string reference: \"ecos/ecos-2.0.6/packages/io/disk/v2_0_60/src/disk.c\"\n1027069       0xFABFD         eCos RTOS string reference: \"ecos-2.0.6/packages/io/disk/v2_0_60/src/disk.c\"\n1085556       0x109074        Unix home path string: \"/home/michael.lo/project-ecos/ecos-rtl8189es/install/include/cyg/io/eth/rltk/819x/wrapper/skbuff.h\"\n1085581       0x10908D        eCos RTOS string reference: \"ecos/ecos-rtl8189es/install/include/cyg/io/eth/rltk/819x/wrapper/skbuff.h\"\n1085586       0x109092        eCos RTOS string reference: \"ecos-rtl8189es/install/include/cyg/io/eth/rltk/819x/wrapper/skbuff.h\"\n1704183       0x1A00F7        eCos RTOS string reference: \"eCos world!\"\n1705708       0x1A06EC        Standard base64 index table\n1730270       0x1A66DE        eCos RTOS string reference: \"eCos/include/cyg/libc/time/time.inl\"\n1827038       0x1BE0DE        Copyright string: \"Copyright (c) 2012 Novatek Microelectronic Corp.\"\n1916391       0x1D3DE7        eCos RTOS string reference: \"ECOS#1.00.008_Nov 12 2013, 11:18:57\"\n1916434       0x1D3E12        eCos RTOS string reference: \"ECOS#1.00.007_Nov 12 2013, 11:18:59\"\n4200028       0x40165C        XML document, version: \"1.0\"\n4200788       0x401954        XML document, version: \"1.0\"\n4404038       0x433346        MySQL MISAM compressed data file Version 3\n5170192       0x4EE410        eCos RTOS string reference: \"eCos does not support daemon option\"\n5173078       0x4EEF56        eCos RTOS string reference: \"ecos threads\"\n5181448       0x4F1008        HTML document header\n5182475       0x4F140B        HTML document footer\n5182516       0x4F1434        eCos RTOS string reference: \"eCos/1.0\"\n5184064       0x4F1A40        HTML document header\n5184167       0x4F1AA7        HTML document footer\n5184176       0x4F1AB0        HTML document header\n5184261       0x4F1B05        HTML document footer\n5184312       0x4F1B38        HTML document header\n5184421       0x4F1BA5        HTML document footer\n5184432       0x4F1BB0        HTML document header\n5184552       0x4F1C28        HTML document footer\n5471876       0x537E84        HTML document header\n5471996       0x537EFC        HTML document footer\n\n```\nIt's full of little endian MIPS code:\n\n```\n$ binwalk -A FW_ZERO_DES.bin\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n9744          0x2610          MIPSEL instructions, function epilogue\n9812          0x2654          MIPSEL instructions, function epilogue\n10260         0x2814          MIPSEL instructions, function epilogue\n10484         0x28F4          MIPSEL instructions, function epilogue\n10784         0x2A20          MIPSEL instructions, function epilogue\n11492         0x2CE4          MIPSEL instructions, function epilogue\n11644         0x2D7C          MIPSEL instructions, function epilogue\n11828         0x2E34          MIPSEL instructions, function epilogue\n11856         0x2E50          MIPSEL instructions, function epilogue\n12212         0x2FB4          MIPSEL instructions, function epilogue\n12396         0x306C          MIPSEL instructions, function epilogue\n12676         0x3184          MIPSEL instructions, function epilogue\n12864         0x3240          MIPSEL instructions, function epilogue\n13036         0x32EC          MIPSEL instructions, function epilogue\n13280         0x33E0          MIPSEL instructions, function epilogue\n13484         0x34AC          MIPSEL instructions, function epilogue\n13552         0x34F0          MIPSEL instructions, function epilogue\n14092         0x370C          MIPSEL instructions, function epilogue\n14304         0x37E0          MIPSEL instructions, function epilogue\n\n```\nThere is a standard eCos exception handler at offset 0x180:\n\n```\nROM:00000180  # =============== S U B R O U T I N E =======================================\nROM:00000180\nROM:00000180\nROM:00000180 sub_180:\nROM:00000180                 mfc0    $k0, Cause       # Cause of last exception\nROM:00000184                 andi    $k0, 0x7F\nROM:00000188                 li      $k1, 0x800FB174\nROM:00000190                 add     $k1, $k0\nROM:00000194                 lw      $k1, 0($k1)\nROM:00000198                 jr      $k1\nROM:0000019C                 nop\nROM:0000019C  # End of function sub_180\n\n```\nMain code starts a bit later at 0x400, and the load address is almost certianly 0x80000000:\n\n```\nROM:00000400 sub_400:\nROM:00000400                 mtc0    $zero, Count     # Timer Count\nROM:00000404                 li      $t2, 0xFFFFFFFF\nROM:00000408                 mtc0    $t2, Compare     # Timer Compare\nROM:0000040C                 mtc0    $zero, WatchLo   # Memory reference trap address low bits\nROM:00000410                 mtc0    $zero, WatchHi   # Memory reference trap address high bits\nROM:00000414                 li      $t1, 0x800FB170\nROM:0000041C                 lw      $a1, 0($t1)\nROM:00000420                 bnez    $a1, loc_440\n...\nROM:00000490                 mtc0    $t2, Config      # Configuration register\nROM:00000494                 mfc0    $t4, Config, 7   # Configuration register\nROM:00000498                 ori     $t4, 0x100\nROM:0000049C                 mtc0    $t4, Config, 7   # Configuration register\nROM:000004A0                 li      $v0, 0x800004B0  # <--- This suggests the load address is 0x80000000\nROM:000004A8                 jr      $v0\nROM:000004AC                 nop\nROM:000004AC  # End of function sub_400\nROM:000004AC\nROM:000004B0\nROM:000004B0  # =============== S U B R O U T I N E =======================================\nROM:000004B0\nROM:000004B0\nROM:000004B0 sub_4B0:\nROM:000004B0                 li      $gp, 0x805433A0\nROM:000004B8                 li      $a0, 0x80588360\nROM:000004C0                 move    $sp, $a0\nROM:000004C4                 jal     unk_FB934\nROM:000004C8                 nop\nROM:000004CC                 jal     unk_B335C\nROM:000004D0                 nop\n\n```\nUPDATE:\n\nThere are references to cygwin and itron, but note that these are just directories under the developer's build path:\n\n```\n$ strings FW_ZERO_DES.bin | grep cygwin\n/cygdrive/c/project-ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/kernel/smp.hxx\n/cygdrive/c/project-ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/kernel/thread.inl\n/cygdrive/c/project-ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/kernel/mboxt2.inl\n/cygdrive/c/project-ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/memalloc/mfiximpl.inl\n/cygdrive/c/project-ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/memalloc/mvarimpl.inl\n/cygdrive/c/project-ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/libc/stdio/stdiofiles.inl\n/cygdrive/c/project-ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/libc/stdio/stream.inl\n/cygdrive/c/project-ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/libc/stdio/streambuf.inl\n/cygdrive/c/project-ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/libc/stdlib/div.inl\n/cygdrive/c/project-ecos/ecos-2.0.6/configs/nt96650.uitron.cygwin_install/include/cyg/memalloc/mempolt2.inl\n\n```\nThis makes sense, since ITRON appears to be an API standard for RTOS's (I'm not familiar with it myself), and the ITRON Wikipedia page explicitly states (emphasis added):\n\nLoading this in IDA is pretty straight forward. It's a binary blob, so you'll have to explicitly tell IDA to use the mipsl processor module. When IDA then prompts you for the Disassembly memory organization, set both the ROM start address and Input file Loading address to 0x80000000 (the base address of the file, which we've already identified from previous disassembly above).\n\nI'm using IDA 6.6, and I just let IDA's auto-analysis take it from there, which did a really good job (lots of string and data xrefs):\n\n```\nloc_8000D5A8:            # \"^RERR:%s() DMA clk not match!\\r  \n\"\naddiu   $a0, (aRerrSDmaClkNot - 0x80010000)\njal     sub_8007CCC4\naddiu   $a1, (aDxsys_dumpandv - 0x80010000)  # \"DxSys_DumpAndVerifyClk\"\njal     loc_800A25B4\nnop\n\n```\nIIRC, older versions of IDA weren't quite as agressive in their auto-analysis, so if you have an older IDA, you might need to manually create some code (the c keyboard shortcut) at offsets 0x180 and 0x400 to give it a little kick-start.\n\n",
      "votes": "3",
      "user": "devttys0",
      "time": "Nov 19, 2014 at 14:27",
      "is_accepted": false,
      "comments": [
        {
          "user": "Nucklear",
          "text": "That seems to be true. But I saw references to cygwin, itron and other stuff inside the image. Also I tried t load in IDA but I got a weird output. Can you point me to the steps to load it and how to extract the files.",
          "time": null
        },
        {
          "user": "devttys0",
          "text": "Updated the answer accordingly. There doesn't appear (to me) to be any files left to be extracted, unless you had something specific you were referencing?",
          "time": null
        },
        {
          "user": "Nucklear",
          "text": "That's it. Thank you so much for your help. Awesome explanations as always.",
          "time": null
        }
      ]
    }
  ]
}