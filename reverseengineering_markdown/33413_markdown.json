{
  "title": "How to instruction-step through programs that take stdin?",
  "link": "https://reverseengineering.stackexchange.com/questions/33413/how-to-instruction-step-through-programs-that-take-stdin",
  "content": "I'd like to be able to use gdb to debug CTF challenges.\n\nHere's the gdb script and how I use it:\n\n```\n> cat gdb_commands \nset pagination off\n# readelf -a shrimple_vm | grep Entry | awk '{ print $NF }'\nbreak *0x4011b0  \nset disassembly-flavor intel\nrun < <(echo ping{wrong_flag} ) > /dev/null\nwhile 1\n    x/i $rip\n    info registers\n    nexti\nend\nquit\n> gdb -q ./shrimple_vm -x gdb_commands -ex 'quit'  > gdb_output\ngdb_commands:10: Error in sourced command file:\nNo registers.\n> grep '^=>' gdb_output\n=> 0x4011b0:    endbr64\n=> 0x4011b4:    xor    ebp,ebp\n=> 0x4011b6:    mov    r9,rdx\n=> 0x4011b9:    pop    rsi\n=> 0x4011ba:    mov    rdx,rsp\n=> 0x4011bd:    and    rsp,0xfffffffffffffff0\n=> 0x4011c1:    push   rax\n=> 0x4011c2:    push   rsp\n=> 0x4011c3:    xor    r8d,r8d\n=> 0x4011c6:    xor    ecx,ecx\n=> 0x4011c8:    mov    rdi,0x401fee\n=> 0x4011cf:    call   QWORD PTR [rip+0x7e03]        # 0x408fd8\n\n```\nObviously, that's not the entire program - it's just that at this stage it wanted to read input from stdin and failed. I tried working around that using LD_PRELOAD, but it didn't change anything.\n\nAs the input, consider the following two files from this year's Ping CTF \"shrimple\" challenge:\n\n```\n/Td6WFoAAATm1rRGAgAhARYAAAB0L+Wj4CNNATRdAADgGIGE/k0WkcunEQw+MU6EQbNpQ74v8E/TeZ7HMxWt3NDS//h0O88Fko0nTg2N5g7FjCcqOrq40+OsUhENGe20sHzyi0YvVKgpZaVZM7OAD8gk3Q9tUxQPOLpa/piQ9uulNiKFOO091rrXVR4jv+NlhdGsksbN\na5gzNBf2U/Sn/BtGrXyycv8AIHfH9H+9HqvQQVTkq74lTr6C0fB7NJ36eSx5n43AFS2b0A5gvB6JTws9O8r8u6nDl/ay3rDBkgLcLZfVTVtX2eSQLeFpdAm+N/b1SO61advmXZVPFnd6NOzDVfjQQeZlPvVgMIWxyxajfwFKcdHMt5F2y8XQjs1pvSH8bLpZ2EdWEFU6\nbiUqKxvJivwE+CIK1Xc3D576Axxc2mR8uOOmShZoTRNBwPPN5Q+2AGHYJaAhm0gsAAHQAs5GAADV8y5JscRn+wIAAAAABFla\n\n```\n```\n/Td6WFoAAATm1rRGAgAhARYAAAB0L+Wj4ItnH+ldAD+RRYRoPYmm2orMk+JO2QeltA4SpxApeUlAz0UQOLpgVTxqL3VJy/uEXQHsb5p+vAWPdouTHKxQwqySZG4lWMdI1GgMVzfG99s8Or2flGOqSYg/fo3bIw9UVvWmjg/X1sFER1sfXHIx7WAaa7Zxc57b+b8BTEd8\niC9TpcmyWGbNbVtkybLCvqR170qF9oxMicBRDG1WIJQJoPPldpVRf15ErmckHx95PU6/K7SgunXJTUoLc/sL9eNXH4ROQpJnI6oo+gqRjZDC8qqjAUKGp1X8PootZkG2SoZsXsBZSZCq23T/YcEbc3tKY1koV4PnoDBpldPsBvEPt0TJlX3P0KmCrIKQHLayOSnTSeHF\n4zA7Mbr1wk/g3hBJbVSXvinmFaxFIXe7+yVYy46P3jpJw+JH2uNOkYkcXRRZQmgIqbyQLWUJFJ0CAqLJFSx/wIns+ubpqPsEJJrueiI8R2gIiLRqjlhkb5KkqlzRrmAffbh1HWntTYr+UR/RaQrFCj+yFedFaa34jzSgi1F3jE+YzWlhovclbvbPBloPi7BWPR7+X5sN\n22O5k55avTA0OCwRAVzEYFaOxvZtEeKet+pY4QDJVj6DQ1p8Ip2MVjqoYYT9OxxUnCc8Ov0AEKTbsm0UxfUSUvljoMZOGeyv+2/k4IALUC4738y0/bVtjg5kxcQuv70bMxwrHrT6ds1cPLk5ZL6bYOHiws6ER+ibwgWMg+WBGgHLWreNvfrGQVNBhiK6GIWsCCp+W4jW\n58IIBo0GrtgmY9Qy2GEWUECoSOl/iWf+ghXtQa9T/PeJiA/kW5RrmwuOPv6/77U+mG0x/aum0UCsYvGNezLRyFfSH7H5h3bCDWnkKt4P/CMCQWDvBxukUtJX0RRNGPSZnzQdTf8gw0aExkNZyFJWoPtkrY5iFH7c29dARqUS0k4HSpFcl8U8E6aQ3/UJ3Fast40eszPO\nNoFOj4QOqxEv1/O8chb6mVt9RnoMQx0qHTBduTojGgHBtkzdkJWCXOxyMjLkrezDZEFQNs1InbCHWl7eF6hIRTF63h9sgBE7osxZryKnRI5upnyExyxcqEgZyu88oVZFOZXSebrNj3xO9Ur/nCm8wM5VTETJHW10mORCE2NvxlDQB6D/c6D5SPgd9lQKj3PSi4cyOpiV\nlkiXN5yq/EsiB5EglxJvyuP3ZVct2NVAhHe4PxRlF+WSddRdEjTZE7db1sO2EJQ1YYtY0xQc8pJO5I6L++6EWWTqFeKhgTy4TwiTVwi7Hld2GVDkgpGlu/U9K7BAkD0CbuVFe0NtgXNmZr8q6kKawXWfr9rkKAFSKO4a4ubyTqX1Q5tB5RTrjCww69W+V/i6BFw6Kr1X\nmcJBRobQJrna98hLHh2pLH4kDZiedzJLurWmpzg9eDV9K0pbraUGq4S2X44QvO5m4CjBWkw+EfjTLc7OIkolKyCx1qV2Jkkj0yjGwKWlkMaG1ahua0CL6YfFZsvA8mYyHA42jCKF3A0l0Cp+PMe5bigSWFR9wdmQNdrQC3WshtJxFYFKcnzBb5xEJmm2iNYAIcEPxRDr\nRqXPNLKirlnOIx7Eunl6Rl4WKUZPehvP+a+seHftY7NdJtbphW/+OKSV9Rwo+QajMDDT9AdS7QmfE9TWO/VcruxIQ/XiwjIVSZIGVN1VlTKFqYI5XmpVX9wpqLdT8RbnMYy6RHY7AePKUjQoTb5+p4igRl1884Zc1Tr6MB1a46kdTQvfD1OFekD/E5WYOnn9oVGX5PTv\ngZXzZJblN33p5kCDObYEoK+btV1rfZosQQO1BNpAypmL7xuawG1IfI0b3psQ+vzOzq+2cMVHawqxBkgurNXHxtWRW8DYNsXkiuslATyoiJVZoC9jF7kuEIW4QsMK1sodRIcvJvovhGIMG4PKwNmb+yyn0Lrlad700rH01RHhW3n5lVZE7rEOmEMVl6Prmt/59lRdKoH4\nyB9Fcg4tpu52HYwWC9WAg9yliw8OUZfYjiY97lelIRhuYBoJTRvJqOq2Wrv087G6SYeQNyb7cTE6aJlS8g7t9OwUkQn80mfk65iFWhCRWov2VF/1nSXdKfUXw4vimUKBlZ8FGcx2lQ84ksL/Myy2lFDLikJwOZHYc1P6x32x04IzWUx8dOFN4UC+zjUjRhBL57Pk2m7T\n3+RFjr3N+0w9pzPEZg+cncE8QWKlc7PLWnQ0pM1vPetQbXiwWv+Wfgtu3utr0iji+6bfE31I1vJmnHSiqNXlt3FWZB0K7xeJ3+5R+yghSTpG6yzQTHMMz1KNJ9ssmDbmiG+iq+1XSP4kb9rIJMH0e4H2e4JagajhO2al4ISx7wiKJxZK/4o0SWXBCVsfWa6ibmyIdQ/X\ncaDWFka7/gZZnWWnmV6WsfUTnoqf4Gzu9haMSowCcQ34sieXkJ1KhskbjVZ7okv9wA8KpgP0fcrQJkcEcgzpq5cH6aFe3FV+emlT3AGTsCfn/Wk8Tka244NlruDV+OZd5Xz11dsOU1fjdm8owEApOtP43VnlUFelbEiEQf4UtHun6WX8eGJOMz/w0t/Uq/sCww8VWX2L\nsoFRZQ83AzXmpvoI/HRGMrDApEogF/JYGA5IAifSu3k8V/YikVBF3PB/QLW7kR8jhVPh0ymDYPRAiwYCeOMJzarjYHnCs23D2tQGrEdinVZmVND8hbqzidkYbNxGXVtXIaEJ3pZcqQFWPtmyGM1BO18LrCCSeDo/isNa3IUTCYFyXfhwgkNQIaGraBecBoKpq8aYTlZs\nsZC3lHkhnXdLF6uE4h8qYpM6RgeHCuKGF29YK0QwIVihmrhnSKbRmvyOZufZfVT37CMguEbc5Ep/KFI+gyuURDpNlhy9RuoudOPy1YupfIURMxzzGW8JWzVC+6aRenKyBWBi7tytbrzTPipWmHeNHz6I82TBa89LQ0bOO8uCDTMvvrIhYve7jLzGZowmGDpQIA5HCIwZ\nQCy+2aBG5XWj26F4h8B7bEmGbWWx+y0G4ic4cUPTOYD4xmzu0hOLRNbgsFenlYKC5h+LlUE9tsuql2Golj6mfi9gdICkkRXfVndBfD2xFU5nXg1PYLNeVKsFyj4sZF6vluD8XBrIDtjVMyaP3m1bW4NFq26YzVtH/yRO41lHxd/0r62IsxP03kO15eojqFQjlKAEvdEm\nYKkuel6bWWM+uC4ZSV5KtlJT9mGdamwyb4TbE0ff3mJJb5tp3ns+LKkZdm0afu2YaviddryIbW9ilndloHwGSYzOKec6hwQ6fVm3hm2IL5cr/3eBYCl8wV+vtJR4YA7B7vvuHxtnH/WDP8vaACYFJza4NlekrbeAklLPLkVOsyPMS3eibNN6Ht7pFqWva/iOxtV4Dfr9\nzawwZ37m49RnSb2xsjR0pkWE6lfauz8xmPfcUONLs5p2P5iHB+wort2CBdqjja23T5nI0KMo+qQmv+gPfFj/ESm/f23z32om6XFgBwYtZFvbeSk/w0dO5RBIAAkr2QDTzAI6vWBvKI4YMvu5yQKpeRlBts5KL6Ddd0vJdKKcisvdkgiRV9MtgwyBKfgNdNR2ML9G++6E\n4fTs0Fbl+puInQDgBNvL2gR4oeLZicOnKy7s8HqKdgvkJeTX7xUYZpNU0LTjpbQF/Ml1UABJQ2nCLoP5s7vX+nOxmeFu1CBeI+2j/4gk3mg0c+h//Q/PgGuRmUJIYNWrfvRAexWzhsNFt7IuiomyAtQJzhrm63k43HJ1DiDC8JVf4QiPlHzWz3qbpgoo88jawcVzxDYk\nGN5Spe1ApviYoVuQSeS0TckKJ21DlmRmSnuyTkH+3+sKmxIo3TqT/eNd5SiG5L0nqZeQMAJMCVO+xgQsi4hpvxAGUNPeDWLtq8lAnBgVTDJp5q0KfQLDZ1syJL6q3wu6wLXcMTI/DpDvUNuD/Vy2xfR6DPc47QdhbkzBV1kZvhk35V3Ae6P7ScbxE6vchh5RTBi90lNc\n9HIWlMZLkJZTuo2dM6juwPUgkEG7q1t5YgHyzcNTZtZmhBtBItQtcLrSegAslm9Ypvr+lvD6OWBsG9wEqhwhUegAidv/87Uy4CdYa/pBFMwUNZzan8YlO+gOiuyxpU+1Y6U51hrKULfQtU+58wEyH/I/FWEJmSma5jkT5kG61WTDRt4ik1u5qzy4WOwQUqZxOVA6P0Lu\nh27csv0oCssTZvrpNaU+VY12muBwdGVxx0Ms32PSi7sWQAxr1zxTVkaKDu8uuJUkgkSqkFLekwSFhMCAtoAemsndHbNRwe/w9JAZNpuYA7n4dm17XeMNIXyJHk70V3ky9g8Nsmoos6K1c89NpvVFEiRlZrsQPnbD1QBTte1VdXuIaWnDVzmUJJpdXap9lisfDQJAqgit\ndf7TdLWk2e88qJ3QdkpE57rzE7PrssX9zq99EJiW4I/xV2Y7XCt+yNMIW38qBbOhlOnu8Q9Y4KGyeeD/e+o9cZx/gHUUiCcqacVWvfgT/SMBgaj57wTraRs5qvi0CZ/JNFsY8P1mKGQnf8y3eDi4DGd/nXzJXaZ4m/Tu86iN6n8k6M7QEXyCNtk3fKZxw+y8+XLkf2qt\naNDxm7MOOi1YGmYgNxLC/RAZKFRbZVmHcoRdsxXf1cb8kgENpaBsbMd65vpkJkl/4mOu1+qxKAUGOMeFmYWr5cp3aM41ArzDEa2HYivDzpi94FzNbPgos1XBi18wQVtXEVlmYZ+YDL4Qz5Xv8o+Vld9h+UXRq8DpTmc0T1K9uxBV7hXDMyWCAhA0c2RGkeF0zolWh4zb\nVH4rImv1dxqcxAqRJQdA/hcIj2fz2fnvqjXiU9oUpvXxEf3gt52+atXLI3B8NDa8QI9c/lnpYqhvwiHK0qCnfIwEcISx7HFqOZrfXSccVR9Y6jhNnL5y8e8eEf6rVjfvEu0hYa670gYwc1SweXHYQ57fM4UQnkkl0rVcEeVNvmjWvmdYUKwmjwW0Swv0mVoY1CqFeqD9\nWj7pN3Yj2AACW8ekHZCa2pLBc4Nz32tEexSLKpZ0t6H8Ntm4w9ub8d/QenBwJQHz3QctGV6zYOqu3bGuz1FHsjPNJLgW/o17efIbxVnW4HwxC3ym5uChB9WYP3dH/oVehhxfKIOo6KLYgKn8kUOFm5rJWWThWW3AC0OWKC+3/dD0W4QvmK7k93TkcfHJ8Pn23JK93nyc\nnnnAgIj/MTmfKVAGoPAlFAykdqkXZrfFZUTf6CPGGcA21R60KzhT11kZVR74YpTgZXdOmeuxSBFypPaYXsad+oMN3h71QW5VUHQOFKzNTWMEsZVua/MaZbi8lEsCh3hSQ3Y3rEjp2YnzpVcd/br1SM88FQtp1SBXpu+CMCf1S+gvG8+Byqfa0UhdZfKOUOcugd08jOwa\nODLOxgdCGzQHlO0mu+QHUMrUa1Zku1qRBrOlC3rcRvdub9t5SQkNbeWcl3QmR5F1CdDTUaw7gn8RLWC+Q+B5TTdMKrrk0OjE4U5m8880BiAnEJpsCAHiTpUFRJbTj+QUFWZdeID1Cu2dbGVnj/xfTlQLGkrHjgIcPzlE+o/yTm78Y1Nk35YApAnQEvS3zw6MtxthRSk2\nXsUIcEZbeFKWu9lFKWyxlUofsB30bgAeTvb1KXI+cQJOGPtw4+5Gx4ac/JsWmw4qHXsq2vVSbl8u5sSsf6ITt0QSBfeeC5Xu+5GNioM2jTIK+kADOWCTq5wi2CFdrBfSboFw67yhAS3f4CydkGAMZYoludDEe2FdCaV7tdwDGHH+Gv4pRxjHE49pfc9tZYIst5uP/zZ3\nK3dpS1LR11PrH9+Tae+rXwnPi9vw5mtvVTIH6QE5pSPTLhHIXaq6lgzhg4oHY5zEcC4syCxkIJN3BkXtSiHlpPI23VAcudIJMbaFGiGctTouTP7RcASMVP9wPMsdTV0XX0aAu3OMogpyAlzvQ+OJ77RmcKAFbUJOGNPbbnG4WMWtvRZ9uOQe1ww7LhHDOTNgv06uK/IS\nTk/RWOMxgRDnUUuDJHXDbn+1RH96uVPdkx+nA/9J8H8abd7O+EnL8UNn3OZDqrRa2MZI0rHcKyx4vjL4Y7e/3zqAVvzRcDDiXaWpH5paD8NX5QMfPLBQkw5uM0/xkNk4kHBT/lKhRcXSMguB4orJY/bSpyprwxQtkv01asljpX14/7lrOFnqMB/f9LFLu9ChPQtsuGs0\ng8eRyZUkkG3B+CYtyVMj9oBmERQbzp82PTep/BkMpHVtVARbUeVJ1/nB03L8O5rgW9IJgxRlG3RTtB3Fw+7u1ESfb9aq2n/3yi9eWucZnctJ7qs4wWv9INUyYSXKusyUhW/BmyFTvKPKMI41CXK3MwBm6cTECq9Q7Em6Pv05SeS5n1EXGogMvXSIC/gsJv2kiwRMijNu\nzgzE2x3iGEd3qBD+CFsEjT65R7nuAIIiZen9BievEQcCoNF6RCsZ8vP8mOA37ZUJ/NYkJonsyx85TsQFjrE93Q6AstKJCT25tSAR1LyVL4SnB2vQQaaT0WvyKkaGI7322TyQs+Op2czO06Jk/d2K2czEFQMJ2ZGNgg3rbAvSG4GTVPMjMdTXCcqwdtrCL3xPLhG5eaon\ne3uqV6x9O5ZSfiicHPrigrqQ+D12tf3KAI2fx1C3B7qDqksL62V1SxlpxEcSLKYKYF+uLGyxAdbEURlPe15n7boEJ16dQ1B+FndSBFicaNf6N9NAYBAygzRcC0adgeNDdJqHC8prMG18hqYxBv6KscVVhSk4/pGl5oeD6ApOG5KStwn5Xnlk7ge00vQApSg2n2FMmEDa\nUQTk/M6cOuUAy38fQejwN2QDwXWkHG5H78E1qkd338WeZ5lANB0Y5ewoaTH8uF9C/4lljUQLsbaHJuWUzNu+UW2cx/2SiUYd6Y2YPgCKetu28UZvjLpr8lge6nrppvWgAnb69LnelwkFOBXTnYBt1OIe4v7YWbrgURVdv4LGpSlS7PlNHpk+dYxW4MeAJrDFCBfcqWhp\nUrYWgDmNohZPDhNOOnJ9AFfAh6RG8WtxGxZnD8im6UlJjJiLpeiuPWJWMS39ELdSNTgpyVW0eO3KzHJ2rDleA70SGjlKX9ye2SLQN6F+0Zf3vd9xMenIIp9lpJx73oBm0T6+rtH8HMahB57/kCiKONAzWjKDxy9MJjGqFrR1S1oWUoeR383Hp5WBU2K0QGtsmQc6LKYs\nrS5N9ZU7M8og8yLGIsFUGAC9ig8IgsrGsnX1A2Y4m92ql9r7lbBBig79vJCkj6GtIoExh1KFkxB6KmmoHtDNswmu9LrfhX59yAD4qvLD3ZG55OzS2gtujT/HVQ2iixN3sxACqb48EL/O/ZUMbOq4KwmspuCai2oWii1yH969a/dM0kPMEnCFAJcaj9klGuyeUNolsEtg\nlNSBl+0kND0qkecmDbQgkYM7aKpUQ8oMxniZJM/7kiAKLlefeZUIoy2wAZweejRe+aXoYTHLPMFBTn9XmS9gA5s7bxCnNjTRvSsN8k/7JS/HnFOYZXmeisPjVflcJAUIUAAItt008gGfSc0tBs2pqWrMAdJB7B6mk6Pb1o28Qq598z1URwvWbi3rZAPFKzHYXzuvMCqH\nB3mtVBRPTFMmS2wL8JKxgmU+v36WY2RuIHhc4mNgkaw7GpYlTjR3qXZmYgzZ4oG2PjUP57PrzfxkRSWECIVmu5kLlIvk2hiluJW/zqD41Nmdvy0h6IxP2v0xDgiRKs0AoVuP+j3wWpaYkspeObqIZ8qKl5XzF6EqSYWRkPm72vrod/jZkhISdP9o7QWqG20OOBukI7kG\nlZeKYi+9Xr5rTdgiJmgo2NrTx7WHDPgaKN3FNYCzCW8tVMNV15WzX4JhRNm5D86CmqF0zR2h7ioPbhfneVbu94QVcNs5BshifuIggJ9C6IgY+ZGcsc12V8R1ibXBTEQ+IXMHRTp/4qQidxl8FogYyMfnqr2qnuVTlvcaZcjxP0HAqmkh7NzpqrYw7J2ZtHLern4zahIK\nJaHwHXzhOtAAxSHT/oH/7eTewZL5B+uk74JS7Sr2zvTTLszM0rfhWKiaPtuyOHMUGI0Yw8IjzOAA7AtQz5sWvQ2Tqd0f4g2hT0ZM5oRCe1KThgLdvk75NELEkfWRm+mNC9LKJX3tQ7W+JYYGNyODIXIC8HAvf34wb6Z9X7dRDxACVlDFrj3BJsmJMK4Ctfxcp83EX76T\nFBj3NaKkaSjV4+bJX3p4mMy9TFiCu79SfaC8HhjtvEWYiODCg+5NZcbmhicDinkhMix4bv8RbpV4sxDgqO9MserYT6MlKb04a7ty3Xvx/PQI8W8AkKIa2yqrwGFaieRUXPI5TNBT2EP9Blh7c4AA3z3fBG2OkLssSq6B1uzP9Bsl+FKiIOCWFRfnv5+uqmvp7QIE4gjo\nVb6aMqABQUqnn7oEpSING9f/uZ0ALgHaH2Xks26PpiiH1hCqEKpkQJtf1iIwYevNRl9OUurobCU5eWlHjqv6ffpB2NIIVic1d5k/0vM1255+eMl3ndRcej4BEhEhdn6D4BoJ2Q94XekiHeC2PlwfhSYquXfLpkOciqnLBdf/pvYkkpoRSOPnc6+1qJGfdtNkULlGDWpU\noHVpIuykfxKy1zKFj+Q0krzFrEw9m94/3zoJlWNWaagJ9Th5VPE28c90TiU4MlbAq84VyYeW0PqAHsEjPsJpzbobBccyRBH4Va/bDz9+vNV6dgA3gQczSfnaUbM3lj2WoaXe03pK9XQTyuiiN0l8vXE7TS1TfaE/DNrRt9b0XeRS4Hnxt9IP4KBjsnJwOUsOA6/S5xYi\ne/SZycCf4iBmv4WWzmoZLYvF/LyQzcA61Jr/1FYYnSZ8v5IVaVTkJByC0lMjX9G1+HOuXmxvneaMQKmmoH4mnB4wVuwky7LZ7+45jChMdMygdrmIgq7WydN4rwq55VJbP+LzUbP9/raVeoEJOvoi5cabBO946/lIstbfPyRlPZY2uEWoXGSnh9qZs0KcOr+OJmSlHQ3Z\nwIWaKPMucMBUsXyQmeralscQ9tRctfL1LdQzRoVMTJPdOBgDD9WhSFT6CYT6+mTHg20KIy4kvd25cdNYACzWtj8cqRVldqExto3BIvVIbL1IPRnu3OdtGYCzJIm7B7BCKMt1fqkNWb49VwXeDvgeZjfvVup4/GHHOJEnGfRNlerKLmfC7pITyw3YCowgb9M4R+sbRpac\n3wwRGORDTP/NhwOLT6HYU0+QbWV3s9K6FVKXXrt1feDaFMdlStcCymAH7ji2D/qudvui06nUElKYos8pIXT1tY2g80bhmz3leQaBmIgbt5VJjCykl0TqcDEW10gUXii64lApn9jv6AlCMD6y4kuvpjm4J6ujvJwWh3r90lN3I6fYbCMw0vlRvC00rpc0sPxk0BF1Vgsf\nDLQxPWUXuzZhGhZzFipCaDfWpUPvTpVWP7HiBrr16n38alZqDKGgt1uGgr4wybrQrKpgPCbuzaCCfrZdzj/JD+1Qt3zo2Vuhy8pEjw6C7BTuvx7E1g7HzjitEvwzUxcAFkQoKjCcLsGtIMvqjFINYclvh7IhXkPzdnRrYEae4WC//c52BLge/dvq7yxHle2gTA+G0uCy\nqznQbqsGhec8H2z4xKPG8SeeOIUuXgKrVhsA3wt0vSbC0E+rT0IkasA+lDK0L13jLRK2ItiGHPbrExmnSycNxr6ZltbA4ZBbkZ3PqL+DuUizMb6lodkbp3dIWtjCmDnuECjAtzMmKSin7Ihyg7ujV3sShc79igvnzEWyF9hXINb8epD3SSvZXpAk9wcwV8e6+jpa3rUD\n+ZEHkWkBMaLpy1rJigwimLaJL1dbdqB/YTk/FDPB4L53NvZhk6phlnJbEQ7z3++EQMMich418NIi8cRZvumL6k9hnZG02w6fcHAZUHPRbVLzjRsAtMBfJmr9fhfAB3IlY1qeza44QjaLvTKRKVbHeBX9xbrZRYjpuAdHUsJkcZujHjWyLtc+e9KMlgOt/joTbcGcmpRf\ncVJ+16ifwi9xmBoFsgL1Ei5kLb9aFWzFHMPD9qHvAXsVXvYVFjFHxE4YkSjsH2WJn8IovHXIfFCIeysrFOxTmNJTGTDZKsaK4LYGkKRL+pyupR7/i2kU+hlCImWXuH3bM+rOAI8WJjd8W8pBxNQpaSggLay7Qnc/PGOxV/yFKkObQyO1mankubIMNB2KgrQPVLMawYso\nXc2VJF/pKb8H3V1rN95AwZnVJ7BCIhBQoeTMeWMYmu4I1mKgtQQd/ZFtPweyWMqluKiCDRengYvekWkSWvmasoTG6A6kee6PYHDKJrSsPVVJHbon2UpZPEplUjv66CRNJEqfRO22klFyFasK8c1G3szmzATDYgASfVfii/lrCDlCvNcbBvawWEjO6okEd92T8PFceHqI\n1w6N2UoJuAuoZ2y9o2HADHyKbuEaAKy83OcN1grMmT+v0nKbM3IogmCsQ9ru00saarYI7/liAXbMPlWjFasptNmSM7wVp6XuWRIjZ7jtYBRv+qr26pqfbiDjXNwzThiSFmxuMdDeXCmAwE3EMw/OP7zMNJxEOkqOjoa92nlrk6KzAw6en4LdgQjWjuYDz3lF+W0emwOD\nf2lnZRIyLmior3N7na2C8J1PZzpDx12aOC0pIunLDnpMMJ8mj1Q0QnLjyqRGanf6aSbed0nNAbIgA2IYDr1rzmbPjxu+Qh2+BD16iXcOzU/nN0aVzjAJknUlsDa+Glo/QqNzMVMNRvOtOyNS5MwBzpJAaNEhNFxkKmX+BctxAoxkqjDL9VcMmC03MQ3uMAekwloMIrh1\ngHwI32sRjwayeuR93G2oE2Wa05qsnsCc0j9jrrTle8hWCGliELbvL2OyERAVWw4G81HXAU3JE1yBcjfO+eM+QSqoxhNRSp+Z+XbxzS6Ha2F5zfTuEwaynvFpA75ZO+ek1ylUjwAAAAAI3+K8kAISQgABhUDolgIA6Ma4DbHEZ/sCAAAAAARZWg==\n\n```\nIs there a way to make gdb work with this scenario?\n\n",
  "votes": "1",
  "answers": 1,
  "views": "80",
  "tags": [
    "gdb"
  ],
  "user": "d33tah",
  "time": "Mar 23 at 19:47",
  "comments": [],
  "answers_data": [
    {
      "content": "You use nexti which will not go inside a function.\nTo continue debugging the instruction inside a function use stepi\n\nIn your disass you likely show the standard _start which eventually calls __libc_start_main\nSo when you set a breakpoint\n\n```\n# readelf -a shrimple_vm | grep Entry | awk '{ print $NF }'\n\n```\nYou'll lose control when you get to\n\n```\n=> 0x4011cf:    call   QWORD PTR [rip+0x7e03]        # 0x408fd8\n\n```\nbecause its a call instruction and nexti will just wait for it to return - all the program logic as after this call\n\nIt'll make more sense - to set a breakpoint on main which according to doc is the first argument to __libc_start_main\n\n```\nint __libc_start_main(int *(main) (int, char * *, char * *), int argc, char * * ubp_av, void (*init) (void), void (*fini) (void), void (*rtld_fini) (void), void (* stack_end));\n\n```\nwhich here is\n\n```\n=> 0x4011c8:    mov    rdi,0x401fee\n\n```\nAccording to the calling convention main is located at 0x401fee\n\nQuick tip : Install something like pwndbg or gef which give you a cleaner interface to access registers or other parts of the context - so that you don't have to run info registers on every line\n\n",
      "votes": "2",
      "user": "hold-me",
      "time": "Mar 25 at 4:48",
      "is_accepted": true,
      "comments": [
        {
          "user": "perror",
          "text": "Beware, this might be more difficult to find main's address if the PIE is enabled (which is obviously not the case here). If so, you would have to capture the content of rdi when calling __libc_start_main` while the program is running.",
          "time": null
        }
      ]
    }
  ]
}