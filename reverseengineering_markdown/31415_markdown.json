{
  "title": "How can I detect which Android native function that is hooked by Mobile Substrate: MSHookFunction?",
  "link": "https://reverseengineering.stackexchange.com/questions/31415/how-can-i-detect-which-android-native-function-that-is-hooked-by-mobile-substrat",
  "content": "I want to detect hook behavior of MSHookFunction on Android. This is Mobile Substrate I use in my test app https://github.com/Breathleas/Android-Hooking-Template-Cydia-Substrate/tree/master/jni/Substrate\n\nAfter complete function hook. I tried comparing the .text section between the in-memory module and the shared object lib file but couldn't find the trampoline function. Here is the Frida script on the codeshare that I referenced https://codeshare.frida.re/@lichao890427/find-android-hook/. The origin function is hooked but .text section data in memory is same with shared object lib file. I also used memory tools like Cheat Engine or Game-Guardian (on Android) to look for the offset I hooked in memory and found it wasn't replaced. So, how did MSHookFunction work and how can I detect hooked functions ?\n\n",
  "votes": "2",
  "answers": 0,
  "views": "213",
  "tags": [
    "android",
    "function-hooking",
    "frida"
  ],
  "user": "Ken Kem",
  "time": "Jan 16, 2023 at 3:08",
  "comments": [],
  "answers_data": []
}