{
  "title": "Reverse-engineering 24-bit to make the lock system recognize NFC cards as their own",
  "link": "https://reverseengineering.stackexchange.com/questions/31272/reverse-engineering-24-bit-to-make-the-lock-system-recognize-nfc-cards-as-their",
  "content": "I own a lock system that uses SRI512 cards.\nMy supplier (manufacturer of the locks) sells the cards at a very expensive price, so I decided to buy them online.\nOnce they arrived, when I tried to write them, through the proprietary reader, the writer would not write on them, although it recognizes them.\n\nI did a dump of a blank card (given by the manufacturer) and noticed that in the fifth block there is a value, all the remaining card is blank. By changing the card the value of the block changes. Obviously trying to using that block from a working card doesn't work and that's why I think there is an algorithm that turns the UID of the card into these 24 bits (in this way, the system only allows cards distributed by the manufacturer).\n\nI decided to get more data by getting block 5 of every blank card I had, that's about 50.\n\n```\nD0021B6847E77BD3 -> 01 2B 3D A9\nD0021B6847E77D68 -> 01 EB AA 3D\nD0021B6847E78738 -> 01 B5 5D 18\nD0021B6847E789C0 -> 01 35 CA 34\nD0021B6847EA2AE3 -> 01 87 27 4B\nD0021B6847EAB92C -> 01 B3 4A 2D\nD0021B6847EABDAA -> 01 96 57 11\nD0021B6847EAC34D -> 01 BC B3 5C\nD0021B6847EAC5F6 -> 01 BB C7 42\nD0021B6847EB28FD -> 01 3B F4 03\nD0021B6847EB2AC0 -> 01 FD F6 71\nD0021B6847EB2C7B -> 01 98 5D 94\nD0021B6847EB2E46 -> 01 DC A1 23\nD0021B6847EB3481 -> 01 96 76 9C\nD0021B6847EB36BC -> 01 B1 2E 0A\nD0021B68480B086D -> 01 7F D2 83\nD0021B68480B0A50 -> 01 6F 35 6E\nD0021B68480B396A -> 01 1A F5 13\nD0021B68480B3B57 -> 01 81 06 F1\nD0021B68480D878B -> 01 69 BD 13\nD0021B68480D8973 -> 01 4F 42 01\nD0021B68480D93B4 -> 01 2D 5E 8D\nD0021B68DCB18896 -> 01 D5 B8 81\nD0021B68DCB18AAB -> 01 19 8A C6\nD0021B68DCB196D7 -> 01 EF 9A 3B\nD0021B68DCBF3D1D -> 01 73 74 0B\nD0021B68DCC0352B -> 01 E2 1E 35\nD0021B68DCC03F55 -> 01 BE 08 F4\nD0021B68DCC041B2 -> 01 97 A5 96\nD0021B68DCC065F0 -> 01 94 2C B5\nD0021B68DCC067CD -> 01 82 EB E1\nD0021B68DCC46D6F -> 01 B2 8E 99\nD0021B68DCC46E28 -> 01 8E 7C 55\nD0021B68DCC47DD6 -> 01 C9 E4 80\nD0021B68DCCE0B95 -> 01 73 6F 85\nD0021B68DCCE15D4 -> 01 33 3D 54\nD0021B68DCCE578B -> 01 A4 92 2E\nD0021B68DCCE5DF5 -> 01 66 D1 98\nD0021B68DCCE6370 -> 01 F6 C0 4F\nD0021B68DCDCE779 -> 01 D2 4D CB\nD0021B68DCDCE981 -> 01 F7 6D 34\nD0021B68DCDD34F7 -> 01 E7 C7 DE\nD0021B68DCDD406E -> 01 F2 AF 98\nD0021B68DCE60945 -> 01 C0 35 51\nD0021B68DCE61539 -> 01 76 71 8D\nD0021B68DCE63EF9 -> 01 C2 44 63\nD0021B68DCE64498 -> 01 F6 71 6B\nD0021B68DCFAF9EE -> 01 1D 03 BF\nD0021B68DCFAFF55 -> 01 20 62 ED\nD0021B68DCFB0526 -> 01 15 2C E9\nD0021B68DCFB0AA4 -> 01 83 FD 79\nD0021B68DCFB0C1F -> 01 E1 E6 09\nD0021B68DCFB16D8 -> 01 68 8F CA\nD0021B68DD02FF77 -> 01 57 63 0A\nD0021B68DD034621 -> 01 49 50 DC\nD0021B68DD0348D9 -> 01 6F 68 02\n\n```\nAdded [45]:\n\n```\nD002196E1B02AC51 -> 01 89 76 A7\nD002198F160A3050 -> 01 AD EA A7\nD002198F160A3638 -> 01 17 DA EF\nD002198F160A7AAE -> 01 43 9F CD\nD00219901F512085 -> 01 4E E6 20\nD00219901F512746 -> 01 A7 64 4E\nD00219901F512A6F -> 01 A2 15 24\nD00219901F512B47 -> 01 6E 01 6F\nD00219901F512C74 -> 01 FE 02 B2\nD00219901F51334D -> 01 C7 0F E7\nD00219901F513C37 -> 01 7D D5 D6\nD00219901F513F3B -> 01 9A 54 49\nD00219901F514244 -> 01 31 9F B1\nD00219901F514881 -> 01 06 A0 09\nD00219901F514C42 -> 01 9C 3B D0\nD00219901F51565D -> 01 39 BF 94\nD00219901F515929 -> 01 AD B8 81\nD00219901F515D39 -> 01 63 A2 F9\nD00219901F515F8E -> 01 45 A5 C4\nD00219901F5164A1 -> 01 2C 90 51\nD00219901F516F5D -> 01 52 95 44\nD00219901F517022 -> 01 FA 43 46\nD00219901F518D40 -> 01 77 83 94\nD00219901F51927C -> 01 EA 9A F1\nD00219901F519397 -> 01 28 AB 7C\nD00219901F51B462 -> 01 36 D2 2E\nD002199117D14063 -> 01 F7 AF D0\nD002199117D1471F -> 01 93 1D 36\nD002199117D17F3D -> 01 D5 E6 54\nD0021B6847E94417 -> 01 8F 92 AD\nD0021B6847E98E3A -> 01 E9 AD 99\nD0021B6847E9907B -> 01 DA 02 30\nD0021B68480B0213 -> 01 26 D1 5F\nD0021B68480B0ED6 -> 01 47 76 7D\nD0021B68480B35AF -> 01 A2 D9 56\nD0021B68480D8DF5 -> 01 E8 EC CC\nD0021B68DCC03390 -> 01 BD 42 5E\nD0021B68DCDD36CA -> 01 EF A3 64\nD0021B68DCE60B78 -> 01 D6 F0 65\nD0021B68DCE60DC3 -> 01 E4 DC A0\nD0021B68DCE61704 -> 01 30 94 D8\nD0021B68DCE6401E -> 01 9E D6 2B\nD0021B68DD03409A -> 01 84 61 77\nD0021B68DD034AE4 -> 01 31 1C 0C\nD0021B68DD034C5F -> 01 1D DE 3B\n\n```\nSo here is what I know or what I have inferred:\n\nI can't figure out what algorithm is being used.\n\nUpdate:\nI managed to find a file explaining that the encryption used is 3DES-AES, I think at this point the question should be moved.\nHowever I don't know yet if it is used in this conversion, even if it is very likely.\n\n",
  "votes": "3",
  "answers": 0,
  "views": "178",
  "tags": [
    "encryption"
  ],
  "user": "Andrea P.",
  "time": "Dec 16, 2022 at 0:34",
  "comments": [],
  "answers_data": []
}