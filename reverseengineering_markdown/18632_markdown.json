{
  "title": "Import symbols containing strange characters",
  "link": "https://reverseengineering.stackexchange.com/questions/18632/import-symbols-containing-strange-characters",
  "content": "I am analyzing a macOS app with radare2, and the app depends on a number of Qt frameworks. When I printed out the import symbols of the app's main executable, the names of the frameworks' functions have strange characters in them. \n\nFor example, if a framework exports a function name: QLocalServer::listen(QStringconst&), it becomes _sym.imp._ZN12QLocalServer6listenERK7QString in the main executable's imports.\n\nAnother example: \nQNetworkProxyFactory::setUseSystemConfiguration(bool) becomes\nsym.imp._ZN20QNetworkProxyFactory25setUseSystemConfigurationEb\n\nCan anyone explain why there are those characters? I don't see those characters when analyzing the export functions of the frameworks. \n\n",
  "votes": "5",
  "answers": 1,
  "views": "769",
  "tags": [
    "radare2",
    "macos"
  ],
  "user": "Thanh Bui",
  "time": "Jun 29, 2018 at 4:57",
  "comments": [],
  "answers_data": [
    {
      "content": "These \"weird\" names are produced by the compiler and are called Name Mangling or Name Decoration. These names are shown by radare2 but are not produced or generated by it.\n\nTo quote from MSDN:\n\nThe Wikipedia article about Name Mangling has some great examples of Name Mangling of C++ produced by GCC. I suggest you read it thoroughly to understand the subject better. It explains how mangled names are produced and describes the structure of it.\n\nradare2, just as many different Disassemblers, knows to demangle the different names. There are several configuration variables that handle Name Mangling:\n\n```\nasm.demangle: Show demangled symbols in disasm\nbin.demangle: Import demangled symbols from RBin\nbin.demanglecmd: run xcrun swift-demangle and similar if available (SLOW)\nbin.lang: Language for bin.demangle\n\n```\nSo if you want radare2 to show you the demangled names on the assembly, use e asm.demangle = true. Make sure to tell radare2 to load the demangled symbols. You can do this by setting e bin.demangle to true. You might need to load the binary again - use oo for this.\n\nIf you just want to demangle a specific name, you can use iD <lang> <name> which will demangle a symbol name for a specific language. Just use it like this: iD cxx <mangled name> for C++ Name Mangling.\n\n",
      "votes": "10",
      "user": "Megabeets",
      "time": "Jun 29, 2018 at 6:28",
      "is_accepted": true,
      "comments": [
        {
          "user": "Jongware",
          "text": "The strangest thing is that its entire purpose is exactly the opposite of what OP is (bluntly) assuming: it is because all those \"strange\" characters that appear in the original declarations ('(, ), :, &, ~) are not allowed in linker symbols.",
          "time": null
        },
        {
          "user": "Thanh Bui",
          "text": "Thanks Megabeets for a very detailed answer! It worked. I just want to note that Demangling does not work on import symbols (i.e. results of ii command)",
          "time": null
        }
      ]
    }
  ]
}