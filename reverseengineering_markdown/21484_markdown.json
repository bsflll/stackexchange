{
  "title": "Turning p-code generated by VBA (Visual Basic for Applications) back into VBA",
  "link": "https://reverseengineering.stackexchange.com/questions/21484/turning-p-code-generated-by-vba-visual-basic-for-applications-back-into-vba",
  "content": "According to the README in https://github.com/bontchev/pcodedmp :\n\n\"As each VBA line is entered into the VBA editor, it is immediately compiled into p-code\"\n\n\"when you open the source of a macro module in the VBA editor, what is displayed is not the decompressed source code but the p-code decompiled into source\"\n\nThis means that there is a line-to-line correspondence between the p-code and the VBA source code that generates it.\n\nIs there a tool that can take the dumped p-code and get the VBA source code that generated it? \n\nSo for example, the input would be something like\n\n```\nLine #0:\n    FuncDefn (Private Sub Document_Open())\nLine #1:\n    LitStr 0x001D \"This could have been a virus!\"\n    Ld vbOKOnly\n    Ld vbInformation\n    Add\n    LitStr 0x0006 \"Virus!\"\n    ArgsCall MsgBox 0x0003\nLine #2:\n    LitStr 0x0008 \"calc.exe\"\n    Paren\n    ArgsCall Shell 0x0001\nLine #3:\n    EndSub\n\n```\nand output\n\n```\nPrivate Sub Document_Open()\n    MsgBox \"This could have been a virus!\", vbOKOnly + vbInformation, \"Virus!\"\n    Shell(\"calc.exe\")\nEnd Sub\n\n```\n",
  "votes": "2",
  "answers": 0,
  "views": "2k",
  "tags": [
    "disassembly",
    "disassemblers",
    "decompile",
    "visual-basic",
    "vba"
  ],
  "user": "hyk",
  "time": "Jun 14, 2019 at 11:02",
  "comments": [
    {
      "user": "ComputerVersteher",
      "text": "How do you get p-code without source-code, except MS-Access Databases? For them have a look at everythingaccess mdeconversion. They can recover most of source code from ms-access p-code in compiled db's(.ADE, .ACCDE, . MDE)",
      "time": null
    },
    {
      "user": "hyk",
      "text": "You can get the p-code from documents containing macro's with the tool github.com/bontchev/pcodedmp However, you can only fetch the binary and not convert it back into the written source-code form",
      "time": null
    },
    {
      "user": "Rolf Rolles",
      "text": "Did you try pcode2code? github.com/Big5-sec/pcode2code",
      "time": null
    }
  ],
  "answers_data": []
}