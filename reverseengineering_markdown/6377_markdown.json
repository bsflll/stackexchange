{
  "title": "IDA - cannot rename or jump to a global variable",
  "link": "https://reverseengineering.stackexchange.com/questions/6377/ida-cannot-rename-or-jump-to-a-global-variable",
  "content": "In an application I'm analyzing, there's a global variable whose purpose/role in the program is known to me. I'd like to rename it, but for some reason I cannot.\n\nThe assembly code:\n\n```\n.text:00537E90                 mov     edx, ds:1C968D8h\n.text:00537E96                 mov     [eax], edx\n.text:00537E98                 mov     ds:1C968D8h, eax\n\n```\nIf I position the cursor on the address (ds:1C968D8h) and try to jump (using Enter), IDA will complain Command \"JumpEnter\" failed. Attempting to rename it with the N hotkey will cause IDA to place a label at that address rather than rename the variable as intended.\n\nWhile I'm doing this for educational purposes, this is a proprietary application, so I don't have the source code.\n\nI've checked Chris Eagle's \"The IDA Pro Book\", but there seems to be nothing on the subject in there.\n\nHelp is greatly appreciated.\n\n",
  "votes": "1",
  "answers": 2,
  "views": "3k",
  "tags": [
    "ida"
  ],
  "user": "user4520",
  "time": "Oct 4, 2014 at 13:18",
  "comments": [],
  "answers_data": [
    {
      "content": "It is possible that the address segment which this data belongs to does not exists in the idb.\nIt can happen if this segment is created dynamically by OS level memory allocation functions like VirtualAlloc or VirtualAllocEx in Windows.\nYou can check it by viewing segment addresses in corresponding IDA window.\nIf this segment doesn't exist, just create one from the same segment window.\n\nIf it is not so, there is another possibility: your global data is not defined as offset ( and not treated as address ). Place cursor on it, press left button, press o on the keyboard to say to IDA that it is address.\n\n",
      "votes": "3",
      "user": "w s",
      "time": "Oct 4, 2014 at 16:48",
      "is_accepted": false,
      "comments": [
        {
          "user": "user4520",
          "text": "The second method doesn't work so I guess it must be the first one. Could you tell me a bit more? Given the address I have in my question, what segment should I add? Currently it contains .text, .idata, .rdata, .data, .tls, .version.",
          "time": null
        },
        {
          "user": "w s",
          "text": "The name doesn't really matter.Check addresses in vicinity of desired address for similar situation, find  start address and end address and add the segment as follows: Go to View-->OpenSubviews-->Segments, press Ins, enter any name and segment boundaries, mark it as 32 bit segment, press OK, reanalyze program via Options-->General-->Analysis--> Reanalyze program. Please note that this segment will not contain real data, but it will give you an opportunity to track access to this address.",
          "time": null
        },
        {
          "user": "user4520",
          "text": "Well, it turns out that the globals are indeed in the .data segment already, but the method you've described (pressing 'O') does not work, just nothing happens. Although according to hex-rays.com/products/ida/support/freefiles/â€¦ your method should work...",
          "time": null
        },
        {
          "user": "w s",
          "text": "It shouldn't change anything. Would you post desired address and content of segments window ?",
          "time": null
        },
        {
          "user": "user4520",
          "text": "Of course. The segments: i.imgur.com/i89BeVN.png . The address I want is for example the one I've posted in my question (ds:1C968D8h).",
          "time": null
        }
      ]
    },
    {
      "content": "One thing that I've failed to notice turned out to be crucial: this file wasn't generated by my copy of IDA, it was given to me by a friend as a helping resource. I've simply disassembled the very same exe with my IDA and the troublesome address is now correct:\n\n\n\n\n\n",
      "votes": "0",
      "user": "user4520",
      "time": "Oct 15, 2014 at 16:16",
      "is_accepted": true,
      "comments": [
        {
          "user": "Zach Riggle",
          "text": "In the future, it may help to undefine the target (hotkey: U), or undefine the disassembly (U), and then re-define and rename the data (D) or code (C).",
          "time": null
        }
      ]
    }
  ]
}