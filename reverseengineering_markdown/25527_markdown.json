{
  "title": "Frida not able to trace sub_XXXXX which must have been called",
  "link": "https://reverseengineering.stackexchange.com/questions/25527/frida-not-able-to-trace-sub-xxxxx-which-must-have-been-called",
  "content": "I have the following pseudocode generated by IDA Pro decompiler:\n\n```\n__int64 *__usercall sub_155B5@<X0>(__int64 *a1@<X0>, unsigned int a2@<W1>, char **a3@<X8>)\n{\n  ...\n  result = sub_222E0((__int64 *)a3, 2 * a2, 0x20u); \n  return result;\n}\n\n```\nUsing frida-trace, I could verify that sub_155B5 is called for every API request. This is the command that I used:\n\n```\n$ frida-trace -U com.app.name -a 'libname.so!0x155b5'\n\n```\nTherefore, I thought I could safely assume that sub_222E0 was also executed, because it's contained by sub_155B5 which was obviously executed. However, it turned out that I was wrong. frida-trace failed to trace sub_222E0 using the same command above.\n\nWhat are the possible causes for this outcome?\n\nThank you.\n\nHere's the declaration of sub_222E0:\n\n```\n__int64 __fastcall sub_222E0(__int64 a1, __int64 a2, __int64 a3)\n{\n  return sub_4D2EC(*(_QWORD **)(a1 + 64), a2, a3);\n}\n\n```\nAnd frida-trace does trace sub_4D2EC everytime sub_155B5 is executed, but not sub_222E0.\n\n",
  "votes": "1",
  "answers": 0,
  "views": "358",
  "tags": [
    "ida",
    "android",
    "frida"
  ],
  "user": "shinhong",
  "time": "Jul 21, 2020 at 14:05",
  "comments": [
    {
      "user": "morsisko",
      "text": "I assume this is not full decompiler output. Maybe the code has got \"return\" instruction somewhere upper, or it throws exception so the sub_222E0 is not executed? Remember the decompiler output is not always correct, thats why you should also pay attention to assembly instructions",
      "time": null
    },
    {
      "user": "shinhong",
      "text": "@morsisko thanks for the comment. After some experiment, I found that sub_222E0 in fact was a thin wrapper function of another subroutine, which frida was able to trace. Still confused why this is happening.",
      "time": null
    }
  ],
  "answers_data": []
}