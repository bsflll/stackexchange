{
  "title": "How to extract DVB firmware bin file?",
  "link": "https://reverseengineering.stackexchange.com/questions/21298/how-to-extract-dvb-firmware-bin-file",
  "content": "I have a bin file of DVB (DTH) box firmware. I want to change one image inside that bin file, how I can do this? Please guide me in right direction.\n\nI tried bin walk, but the file that it extracted looks like unuseful.\n\nBelow is the command I tried:\n\n```\n$ binwalk -B /Users/Me/Documents/Reverse/dump_all.bin \n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n52150         0xCBB6          LZMA compressed data, properties: 0xC8, dictionary size: 16777216 bytes, uncompressed size: 65536 bytes\n55216         0xD7B0          eCos RTOS string reference: \"ecos.bin.lzma\"\n55232         0xD7C0          eCos RTOS string reference: \"ecos.bin.gz\"\n66048         0x10200         JPEG image data, JFIF standard 1.02\n66078         0x1021E         TIFF image data, big-endian, offset of first image directory: 8\n68069         0x109E5         Unix path: /www.w3.org/1999/02/22-rdf-syntax-ns#' xmlns:iX='http://ns.adobe.com/iX/1.0/'>\n68238         0x10A8E         Unix path: /ns.adobe.com/xap/1.0/mm/'>\n131072        0x20000         romfs filesystem, version 1 size: 2439392 bytes, named \"rom 5c67f699\"\n2621440       0x280000        CramFS filesystem, little endian, size: 12288 version 2 sorted_dirs CRC 0xA76D500A, edition 0, 5 blocks, 20 files\n2883584       0x2C0000        CramFS filesystem, little endian, size: 819200 version 2 sorted_dirs CRC 0xB7F50F6A, edition 0, 976 blocks, 362 files\n3739148       0x390E0C        Zlib compressed data, compressed\n3741196       0x39160C        Zlib compressed data, compressed\n3743756       0x39200C        Zlib compressed data, compressed\n3744780       0x39240C        Zlib compressed data, compressed\n3746316       0x392A0C        Zlib compressed data, compressed\n3750924       0x393C0C        Zlib compressed data, compressed\n3752460       0x39420C        Zlib compressed data, compressed\n3753996       0x39480C        Zlib compressed data, compressed\n3755532       0x394E0C        Zlib compressed data, compressed\n3757068       0x39540C        Zlib compressed data, compressed\n3758604       0x395A0C        Zlib compressed data, compressed\n3867148       0x3B020C        Zlib compressed data, compressed\n3901964       0x3B8A0C        Zlib compressed data, compressed\n3903500       0x3B900C        Zlib compressed data, compressed\n3905036       0x3B960C        Zlib compressed data, compressed\n3906572       0x3B9C0C        Zlib compressed data, compressed\n3908108       0x3BA20C        Zlib compressed data, compressed\n3909644       0x3BA80C        Zlib compressed data, compressed\n3911180       0x3BAE0C        Zlib compressed data, compressed\n3912716       0x3BB40C        Zlib compressed data, compressed\n3914252       0x3BBA0C        Zlib compressed data, compressed\n4020748       0x3D5A0C        Zlib compressed data, compressed\n4022284       0x3D600C        Zlib compressed data, compressed\n4023820       0x3D660C        Zlib compressed data, compressed\n4041740       0x3DAC0C        Zlib compressed data, compressed\n4045836       0x3DBC0C        Zlib compressed data, compressed\n4047372       0x3DC20C        Zlib compressed data, compressed\n4064780       0x3E060C        Zlib compressed data, compressed\n4065804       0x3E0A0C        Zlib compressed data, compressed\n4133900       0x3F140C        Zlib compressed data, compressed\n4135436       0x3F1A0C        Zlib compressed data, compressed\n4140556       0x3F2E0C        Zlib compressed data, compressed\n4142092       0x3F340C        Zlib compressed data, compressed\n4147212       0x3F480C        Zlib compressed data, compressed\n4148748       0x3F4E0C        Zlib compressed data, compressed\n\n```\nAnd the second command to extract file:\n\n```\n$ binwalk -e /Users/Me/Documents/Reverse/dump_all.bin -C /Users/me/Documents/Reverse/dump_all \n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n\nWARNING: Extractor.execute failed to run external extractor '7z e -y '%e'': [Errno 2] No such file or directory\n52150         0xCBB6          LZMA compressed data, properties: 0xC8, dictionary size: 16777216 bytes, uncompressed size: 65536 bytes\n55216         0xD7B0          eCos RTOS string reference: \"ecos.bin.lzma\"\n55232         0xD7C0          eCos RTOS string reference: \"ecos.bin.gz\"\n66048         0x10200         JPEG image data, JFIF standard 1.02\n66078         0x1021E         TIFF image data, big-endian, offset of first image directory: 8\n68069         0x109E5         Unix path: /www.w3.org/1999/02/22-rdf-syntax-ns#' xmlns:iX='http://ns.adobe.com/iX/1.0/'>\n68238         0x10A8E         Unix path: /ns.adobe.com/xap/1.0/mm/'>\n131072        0x20000         romfs filesystem, version 1 size: 2439392 bytes, named \"rom 5c67f699\"\n\nWARNING: Extractor.execute failed to run external extractor 'cramfsck -x '%%cramfs-root%%' '%e'': [Errno 2] No such file or directory\n\nWARNING: Extractor.execute failed to run external extractor 'cramfsswap '%e' '%e.swap' && cramfsck -x '%%cramfs-root%%' '%e.swap'': [Errno 2] No such file or directory\n2621440       0x280000        CramFS filesystem, little endian, size: 12288 version 2 sorted_dirs CRC 0xA76D500A, edition 0, 5 blocks, 20 files\n\nWARNING: Extractor.execute failed to run external extractor 'cramfsck -x '%%cramfs-root%%' '%e'': [Errno 2] No such file or directory\n\nWARNING: Extractor.execute failed to run external extractor 'cramfsswap '%e' '%e.swap' && cramfsck -x '%%cramfs-root%%' '%e.swap'': [Errno 2] No such file or directory\n2883584       0x2C0000        CramFS filesystem, little endian, size: 819200 version 2 sorted_dirs CRC 0xB7F50F6A, edition 0, 976 blocks, 362 files\n3739148       0x390E0C        Zlib compressed data, compressed\n3741196       0x39160C        Zlib compressed data, compressed\n3743756       0x39200C        Zlib compressed data, compressed\n3744780       0x39240C        Zlib compressed data, compressed\n3746316       0x392A0C        Zlib compressed data, compressed\n3750924       0x393C0C        Zlib compressed data, compressed\n3752460       0x39420C        Zlib compressed data, compressed\n3753996       0x39480C        Zlib compressed data, compressed\n3755532       0x394E0C        Zlib compressed data, compressed\n3757068       0x39540C        Zlib compressed data, compressed\n3758604       0x395A0C        Zlib compressed data, compressed\n3867148       0x3B020C        Zlib compressed data, compressed\n3901964       0x3B8A0C        Zlib compressed data, compressed\n3903500       0x3B900C        Zlib compressed data, compressed\n3905036       0x3B960C        Zlib compressed data, compressed\n3906572       0x3B9C0C        Zlib compressed data, compressed\n3908108       0x3BA20C        Zlib compressed data, compressed\n3909644       0x3BA80C        Zlib compressed data, compressed\n3911180       0x3BAE0C        Zlib compressed data, compressed\n3912716       0x3BB40C        Zlib compressed data, compressed\n3914252       0x3BBA0C        Zlib compressed data, compressed\n4020748       0x3D5A0C        Zlib compressed data, compressed\n4022284       0x3D600C        Zlib compressed data, compressed\n4023820       0x3D660C        Zlib compressed data, compressed\n4041740       0x3DAC0C        Zlib compressed data, compressed\n4045836       0x3DBC0C        Zlib compressed data, compressed\n4047372       0x3DC20C        Zlib compressed data, compressed\n4064780       0x3E060C        Zlib compressed data, compressed\n4065804       0x3E0A0C        Zlib compressed data, compressed\n4133900       0x3F140C        Zlib compressed data, compressed\n4135436       0x3F1A0C        Zlib compressed data, compressed\n4140556       0x3F2E0C        Zlib compressed data, compressed\n4142092       0x3F340C        Zlib compressed data, compressed\n4147212       0x3F480C        Zlib compressed data, compressed\n4148748       0x3F4E0C        Zlib compressed data, compressed\n\n```\nAnd the output folder looks like this:\n\n\nI also tried 7zip to extract files, and below is the screenshot of extracted files:\n\n\n\nIt looks like 7zip extracted the file structure I am looking for but problem is that it didn't extract files there are only folders only and there was an error message, too:\n\n\nHere is the link to firmware.\n\n",
  "votes": "4",
  "answers": 1,
  "views": "3k",
  "tags": [
    "binary-analysis",
    "firmware",
    "binary",
    "firmware-analysis"
  ],
  "user": "Varun Naharia",
  "time": "Jul 5, 2021 at 21:07",
  "comments": [
    {
      "user": "julian",
      "text": "What have you tried so far? Which image do you want to change? In what way do you want to change it? What specific technical problem or difficulty are you facing?",
      "time": null
    },
    {
      "user": "Varun Naharia",
      "text": "Please check my updated question, 66078         0x1021E         TIFF image I think this is the image that I want to remove actually  DVB box has large logo on bottom right corner that I don't want it is very big and annoying.",
      "time": null
    },
    {
      "user": "Varun Naharia",
      "text": "I got the solution if any one want to know how let me know",
      "time": null
    },
    {
      "user": "julian",
      "text": "it would be great if you posted a solution here. It may be useful to others later",
      "time": null
    },
    {
      "user": "julian",
      "text": "Understandable. This community is generally much more professional and less rude than the one at stackoverflow. Itâ€™s up to you",
      "time": null
    }
  ],
  "answers_data": [
    {
      "content": "I am trying to do the same.\n\nIt's a gx6605 firmware used in national chipset dvbs2 boxes. I used tuxbox tool to extract the cramfs files, but it only extracts the themes and xml files. Nothing useful.\n\nI used gx6605 unpack repack tool and unpacked the sections as\n\nboot.bin\ndata.bin\nkernel.bin\nlogo.bin\nroot.bin\ntable.bin\ntheme.bin\n\nThe Kernel is packed in lzma, but first you need to remove the first 8 lines of the kernel file and save it.\n\n\n\nOnce you remove this header and save the file, you can decode the file using lzma.exe in Windows.\n\nDecode syntax: lzma d kernel.bin kernel_unpacked.bin\n\nNow you can modify the kernel_unpacked.bin file and view the codes using a hex editor or some other viewer.\n\nHowever, I was unable to extract any content out of this file (as I don't know much about binary files). Let me know if you can find where the actual code resides.\n\nI found some references in the BOOT.bin file for ecos.bin.gz which you can check.\n\n",
      "votes": "1",
      "user": "0xC0000022L",
      "time": "Dec 2, 2022 at 11:58",
      "is_accepted": false,
      "comments": []
    }
  ]
}