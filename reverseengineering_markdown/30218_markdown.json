{
  "title": "How to decode/decrypt/decipher an unknown 83 bytes long UDP payload?",
  "link": "https://reverseengineering.stackexchange.com/questions/30218/how-to-decode-decrypt-decipher-an-unknown-83-bytes-long-udp-payload",
  "content": "I have an unknown 83 bytes long payload which I would like to decode/decrypt/decipher…\n\nI got an alarm system from vendor www.jablotron.com, an old device, but it works perfectly.\n\nIt’s JA-63 with a LAN extension card JA-60WEB. JA-60WEB is via Ethernet supposed to send all events detected by the alarm system to a CMS (Central Monitoring System).\n\nJA-60WEB Installation manual: https://www.manualslib.com/manual/1199886/Jablotron-Ja-60web.html#manual\n\nAccording to the manual the device should send event messages via IP CID protocol which I assume stand for Contact ID over IP protocol.\n\nContact ID protocol described here:\nhttps://li0r.files.wordpress.com/2012/07/sia-dc-05-1999-09_contact_id.pdf\n\nIt should be a simple ASCII string, 16 byte long messages, in format (for example) like this: 1234 18 1131 01 015 8.\nBut unfortunately, it’s not.\n\nI sniffed the traffic (Wireshark) outgoing from JA-60WEB to my fictive CMS receiver and got the following pattern.\n\nI configured JA-60WEB module to send only messages when the following event happened: “Exit programming mode”. To have a static event message always.\n\nI repeated the event 6 times, therefore below 54 times HEX stream of the UDP payload (each time 83 bytes long).\n\nI observed that JA-60WEB sends each event 9 times. First time the real message, and after that it retries to send 8 times again as it did not receive the acknowledgment from CMS, that the message was received correctly. I have no real CMS, I’m trying to develop my own CMS, therefore the whole effort here.\n\nMy question: What is this? Binary encoded protocol? Encrypted somehow?\n\nWhat is interesting is it’s for the same event slightly different stream and it should be static.\nHow would one approach this problem to detect what it is?\n\nI also observed some patterns depicted here of another data sample. Like with every new message data is shifting to the left, and overwritten with something new incoming from the right side:\n\n\nData:\n\n```\nf090bb0c1c7023ece5b676ce4315a69c535a09770b91070742f9bdef381522a0502efc10e976858ed1e46ba14d5fa57140e38c726e9f7c0ac2f4520a9f7c9bddb6469da35efd13b38e859af4076e66fcdfca76\nf091bb151c4323ece5b676ce5a15a69c535a09770b91070742cebdef381522a0502efc10e976a48ed1e46ba14d5fa57140e38c516e9f7c0ac2f4520a9f7c9bdd9f469da35efd13b38e859af4073166fcdfca50\nf09e9a151c5223ece5b676ef5a15a69c535a09770b91070761cebdef381522a0502efc10e95fa48ed1e46ba14d5fa57140e3f3516e9f7c0ac2f4520a9f7c9b4c9f469da35efd13b38e859af4343166fcdfca22\nf0769a151cab23ece5b69fef5a15a69c535a09770b91075861cebdef381522a0502efc10985fa48ed1e46ba14d5fa5714070f3516e9f7c0ac2f4520a9f7cd24c9f469da35efd13b38e859ac3343166fcdfca57\nf0759a151cba23ece5b69fef5a15a69c535a09770b91f45861cebdef381522a0502efc99985fa48ed1e46ba14d5fa5715770f3516e9f7c0ac2f4520a9fbdd24c9f469da35efd13b38e8559c3343166fcdfca51\nf0749a151c8d23ece5b69fef5a15a69c535a09770be6f45861cebdef381522a0502e7d99985fa48ed1e46ba14d5fa5725770f3516e9f7c0ac2f4520a26bdd24c9f469da35efd13b38eaa59c3343166fcdfca6e\nf0739a151ce223ece5b69fef5a15a69c535a0977c8e6f45861cebdef381522a050f77d99985fa48ed1e46ba14d5f8a725770f3516e9f7c0ac2f4521b26bdd24c9f469da35efd13b3ddaa59c3343166fcdfca48\nf0729a151cf523ece5b69fef5a15a69c535a0998c8e6f45861cebdef381522a021f77d99985fa48ed1e46ba14dec8a725770f3516e9f7c0ac2f46b1b26bdd24c9f469da35efd13a4ddaa59c3343166fcdfca1c\nf0719a151cc423ece5659fef5a15a69c535ada98c8e6f45861cebdef381522b921f77d99985fa48ed1e46ba17aec8a725770f3516e9f7c0ac2d56b1b26bdd24c9f469da35efd30a4ddaa59c3343166fcdfca71\nf0709a151c0223ec72659fef5a15a69c53cdda98c8e6f45861cebdef381503b921f77d99985fa48ed1e46b827aec8a725770f3516e9f7c0aebd56b1b26bdd24c9f469da35e0230a4ddaa59c3343166fcdfca93\nf06f9a151c15230f72659fef5a15a69cb0cdda98c8e6f45861cebdef387c03b921f77d99985fa48ed1e4b4827aec8a725770f3516e9f7cfbebd56b1b26bdd24c9f469da3cd0230a4ddaa59c3343166fcdf03b6\nf06e9a151c649c0f72659fef5a15a623b0cdda98c8e6f45861cebdef297c03b921f77d99985fa48ed197b4827aec8a725770f3516e9ff5fbebd56b1b26bdd24c9f469db4cd0230a4ddaa59c3343166fc9e03b8\nf06d9a151c6e9c0f72659fef5a15b523b0cdda98c8e6f45861cebda6297c03b921f77d99985fa48e2697b4827aec8a725770f3516e1ef5fbebd56b1b26bdd24c9f469eb4cd0230a4ddaa59c3343166459e038c\nf06c9a158b5f9c0f72659fef5a82b523b0cdda98c8e6f45861ce7ca6297c03b921f77d99985fa4cd2697b4827aec8a725770f351371ef5fbebd56b1b26bdd24c9f699eb4cd0230a4ddaa59c3343177459e03f7\nf06b9a968b4c9c0f72659fefd982b523b0cdda98c8e6f45861377ca6297c03b921f77d99985fcbcd2697b4827aec8a725770f3a0371ef5fbebd56b1b26bdd24c2c699eb4cd0230a4ddaa59c3340877459e0380\nf06af5968ba79c0f72659f80d982b523b0cdda98c8e6f458f0377ca6297c03b921f77d99980ccbcd2697b4827aec8a725770eaa0371ef5fbebd56b1b26bdd27b2c699eb4cd0230a4ddaa59c3150877459e03cc\nf01af5968b949c0f7265ec80d982b523b0cdda98c8e6f4a1f0377ca6297c03b921f77d990f0ccbcd2697b4827aec8a725751eaa0371ef5fbebd56b1b26bdf17b2c699eb4cd0230a4ddaa59ea150877459e03fc\nf01bf5968b859c0f7265ec80d982b523b0cdda98c8e615a1f0377ca6297c03b921f77dfa0f0ccbcd2697b4827aec8a72be51eaa0371ef5fbebd56b1b26e2f17b2c699eb4cd0230a4ddaa28ea150877459e03ec\nf014f5968b369c0f7265ec80d982b523b0cdda98c88f15a1f0377ca6297c03b921f7c2fa0f0ccbcd2697b4827aec8a63be51eaa0371ef5fbebd56b1bd5e2f17b2c699eb4cd0230a4dd2328ea150877459e03e1\nf015f5968b279c0f7265ec80d982b523b0cdda98f98f15a1f0377ca6297c03b921e4c2fa0f0ccbcd2697b4827aec4363be51eaa0371ef5fbebd56b6cd5e2f17b2c699eb4cd0230a45c2328ea150877459e03f1\nf016f5968b149c0f7265ec80d982b523b0cdda91f98f15a1f0377ca6297c03b9b6e4c2fa0f0ccbcd2697b4827aad4363be51eaa0371ef5fbebd5a86cd5e2f17b2c699eb4cd02307d5c2328ea150877459e03c1\nf017f5968b0f9c0f7264ec80d982b523b0cddb91f98f15a1f0377ca6297c033ab6e4c2fa0f0ccbcd2697b48203ad4363be51eaa0371ef5fbeb3aa86cd5e2f17b2c699eb4cd02417d5c2328ea150877459e03be\nf010f5968b7c9c0fab64ec80d982b523b014db91f98f15a1f0377ca6297cec3ab6e4c2fa0f0ccbcd2697b41303ad4363be51eaa0371ef5fb383aa86cd5e2f17b2c699eb4cd1b417d5c2328ea150877459e03e0\nf011f5968b6d9c3eab64ec80d982b5238114db91f98f15a1f0377ca6298fec3ab6e4c2fa0f0ccbcd2697cd1303ad4363be51eaa0371ef56c383aa86cd5e2f17b2c699eb4ec1b417d5c2328ea150877459e20f0\nf012f5968b44053eab64ec80d982b5ba8114db91f98f15a1f0377ca6de8fec3ab6e4c2fa0f0ccbcd26f6cd1303ad4363be51eaa0371e166c383aa86cd5e2f17b2c699eddec1b417d5c2328ea150877454120cb\nf013f5968b54053eab64ec80d98254ba8114db91f98f15a1f0377c45de8fec3ab6e4c2fa0f0ccbcdcff6cd1303ad4363be51eaa037a1166c383aa86cd5e2f17b2c698fddec1b417d5c2328ea1508773641208c\nf0b15bc3fe5721d5040fb12d8cf7589e6abbb0a642900e571229fe100ba5323060becca0e80fd45e21b404928afc1a82e7819af0076e85fcc8cab8fce552d0523df0dfed93a8a67e73b02f0843ca39e7681655\nf0b05bc3fe3821d5040fb12d8cf7589e6abbb0a64290d7571229fe100ba5323060becc69e80fd45e21b404928afc1a828e819af0076e85fcc8cab8fce5cbd0523df0dfed93a8a67e73b0960843ca39e7681649\nf0b35bc3fe3792d5040fb12d8cf7582d6abbb0a64290d7571229fe1048a5323060becc69e80fd45e21a704928afc1a828e819af0076e66fcc8cab8fce5cbd0523df0df3e93a8a67e73b0960843ca39e76b165d\nf0b25bc3fe2692d5040fb12d8cf7582d6abbb0a642e1d7571229fe1048a5323060be8d69e80fd45e21a704928afc1ab38e819af0076e66fcc8cab8fc84cbd0523df0df3e93a8a67e73a1960843ca39e76b164d\nf0b55bc3fef892d5040fb12d8cf76f2d6abbb0a642e1d7571229fe7f48a5323060be8d69e80fd45eb6a704928afc1ab38e819af0073166fcc8cab8fc84cbd0523df0c83e93a8a67e73a1960843ca39c86b1666\nf0b45bc3fec992d5040fb12d8cf76f2d6abbb0a65be1d7571229fe7f48a5323060c78d69e80fd45eb6a704928afc13b38e819af0073166fcc8cab8d584cbd0523df0c83e93a8a67e4aa1960843ca39c86b161d\nf0b75bc3ddda92d5040fb12d8cd46f2d6abbb0a65be1d7571229ad7f48a5323060c78d69e80fd4ddb6a704928afc13b38e819af0343166fcc8cab8d584cbd0523dd3c83e93a8a67e4aa1960843ca8ac86b1646\nf0b65bc3dda192d5040fb12d8cd46f2d6abbb0875be1d7571229ad7f48a53230f1c78d69e80fd4ddb6a704928afd13b38e819af0343166fcc8ca29d584cbd0523dd3c83e93a8a65f4aa1960843ca8ac86b1627\nf0b95b9cddb292d5040fb12dd3d46f2d6abbb0875be1d75712bead7f48a53230f1c78d69e80fbbddb6a704928afd13b38e819ac7343166fcc8ca29d584cbd05242d3c83e93a8a65f4aa1960843fd8ac86b1608\nf0b85b9cdd8392d50466b12dd3d46f2d6abbd9875be1d75712bead7f48a53249f1c78d69e80fbbddb6a7049253fd13b38e819ac7343166fcc80329d584cbd05242d3c83e93a88f5f4aa1960843fd8ac86b1673\nf0bba89cdd4992d50466b1ded3d46f2d6abbd9875be1d75771bead7f48a53249f1c78d69e87cbbddb6a7049253fd13b38e8159c7343166fcc80329d584cbd0c142d3c83e93a88f5f4aa1960860fd8ac86b163d\nf0baa89cdd5a92d51566b1ded3d46f2d6aaad9875be1d75771bead7f48a55349f1c78d69e87cbbddb6a704a353fd13b38e8159c7343166fc890329d584cbd0c142d3c83e93598f5f4aa1960860fd8ac86b1651\nf0caa89cdd2b92d51566c6ded3d46f2d6aaad9875be1d7e871bead7f48a55349f1c78d699f7cbbddb6a704a353fd13b38eae59c7343166fc890329d584cbc7c142d3c83e93598f5f4aa1965760fd8ac86b1665\nf0cba89cdd32929c1566c6ded3d46f2d23aad9875be1d7e871bead7f484c5349f1c78d699f7cbbddb6a79da353fd13b38eae59c734316645890329d584cbc7c142d3c83e1a598f5f4aa1965760fd8ac86b7f47\nf0c8a89cdd03929c1566c6ded3d46f2d23aad9875be1c4e871bead7f484c5349f1c78d0a9f7cbbddb6a79da353fd13b3ddae59c734316645890329d584c8c7c142d3c83e1a598f5f4aa1655760fd8ac86b7f2a\nf0c9a89cdd14539c1566c6ded3d46fec23aad9875be1c4e871bead7f794c5349f1c78d0a9f7cbbddb6469da353fd13b3ddae59c734317745890329d584c8c7c142d3c8bf1a598f5f4aa1655760fd8ac87a7f7e\nf0d6a89cddfb539c1566c6ded3d46fec23aad9875b76c4e871bead7f794c5349f1c7520a9f7cbbddb6469da353fd13a4ddae59c734317745890329d5abc8c7c142d3c8bf1a598f5f4ad6655760fd8ac87a7f5a\nf0d7a89cdd35539c1566c6ded3d496ec23aad9875b76c4e871bead76794c5349f1c7520a9f7cbbdd9f469da353fd13a4ddae59c734087745890329d5abc8c7c142d391bf1a598f5f4ad6655760fd8a817a7f65\nf0d4a89cdd24539c1566c6ded3d496ec23aad987d876c4e871bead76794c5349f1f4520a9f7cbbdd9f469da353fd30a4ddae59c73408774589032966abc8c7c142d391bf1a598f5f89d6655760fd8a817a7f63\nf0d5a89c4cb3539c1566c6ded34596ec23aad987d876c4e871beac76794c5349f1f4520a9f7cbb4c9f469da353fd30a4ddae59c71508774589032966abc8c7c1422291bf1a598f5f89d6655760fd4b817a7f7e\nf0d2a89c4ca2539c1566c6ded34596ec23aad968d876c4e871beac76794c5349c6f4520a9f7cbb4c9f469da3530230a4ddae59c71508774589031e66abc8c7c1422291bf1a598fb089d6655760fd4b817a7f54\nf0d3a8654cd5539c1566c6de2a4596ec23aad968d876c4e871e7ac76794c5349c6f4520a9f7cf24c9f469da3530230a4ddae59ee1508774589031e66abc8c7c15b2291bf1a598fb089d6655760044b817a7f1e\nf0d0a8654cca539c1595c6de2a4596ec23aa2a68d876c4e871e7ac76794c530ac6f4520a9f7cf24c9f469da3c00230a4ddae59ee1508774589201e66abc8c7c15b2291bf1a595cb089d6655760044b817a7f6e\nf0d149654cfd539c1595c63f2a4596ec23aa2a68d876c4e840e7ac76794c530ac6f4520a9fbdf24c9f469da3c00230a4ddae28ee1508774589201e66abc8c7e05b2291bf1a595cb089d66557f1044b817a7f51\nf0de49654cec539ce295c63f2a4596ec235d2a68d876c4e840e7ac76794c7c0ac6f4520a9fbdf24c9f469db4c00230a4ddae28ee1508774556201e66abc8c7e05b2291bf1ace5cb089d66557f1044b817a7fcc\nf0b649654c05539ce295af3f2a4596ec235d2a68d876c47140e7ac76794c7c0ac6f4520a26bdf24c9f469db4c00230a4dd2728ee1508774556201e66abc82ee05b2291bf1ace5cb089d665aef1044b817a7fdd\nf0b549654c34537fe295af3f2a4596ecc05d2a68d876c47140e7ac76799f7c0ac6f4520a26bdf24c9f469eb4c00230a4dd2728ee1508773656201e66abc82ee05b2291bff9ce5cb089d665aef1044b817a8cb0\nf0b449654c27537fe295af3f2a4596ecc05d2a68d876a57140e7ac76799f7c0ac6f4521b26bdf24c9f469eb4c00230a45c2728ee1508773656201e66abd92ee05b2291bff9ce5cb089d684aef1044b817a8cfd\n\n```\nThanks a lot in advance.\n\n",
  "votes": "1",
  "answers": 0,
  "views": "373",
  "tags": [
    "encryption",
    "decryption"
  ],
  "user": null,
  "time": "Mar 31, 2022 at 21:46",
  "comments": [
    {
      "user": "user253751",
      "text": "When decoding an unknown protocol, don't forget to generate some interesting protocol messages. This is \"exit programming mode\"; did you also try arming the alarm, disarming, setting it off, tampering? And are you absolutely sure that CID = Contact ID?",
      "time": null
    },
    {
      "user": "Steffen Ullrich",
      "text": "I’m voting to close this question because it is only about reverse engineering - I don't see any security aspect here. It would be more on-topic at Reverse Engineering.",
      "time": null
    }
  ],
  "answers_data": []
}