{
    "title": "Please help identify which type of CPU architecture is used on obscure portable media players",
    "link": "https://reverseengineering.stackexchange.com/questions/31867/please-help-identify-which-type-of-cpu-architecture-is-used-on-obscure-portable",
    "content": "I am trying to reverse engineer a media player with obscure SigmaTel SoCs just for fun but I didn't find very useful information.\nAs far as I don't know exactly what CPU architecture is used on these SoCs.\nHere are the binwalk + cpu_rec outputs - example of a media player based on STMP35xx SoC:\nbootmanager.sb - from DSP of STMP35xx-based player (DSP56004-compatible)\n<pre><code>DECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n9276          0x243C          ARM executable code, 16-bit (Thumb), big endian, at least 564 valid instructions\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             None (size=0x380, entropy=0.606236)\n896           0x380           TMS320C6x (size=0x100, entropy=0.526849)\n1152          0x480           None (size=0x1680, entropy=0.617841)\n6912          0x1B00          TMS320C6x (size=0x80, entropy=0.570979)\n7040          0x1B80          None (size=0x1400, entropy=0.624876)\n</code></pre>\nhostlink.sb - from DSP of STMP35xx-based Portable media player (DSP56004-compatible)\n<pre><code>DECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n34195         0x8593          ARM executable code, 16-bit (Thumb), big endian, at least 809 valid instructions\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             None (size=0x24000, entropy=0.559532)\n147456        0x24000         TMS320C6x (size=0x800, entropy=0.642204)\n149504        0x24800         None (size=0x2000, entropy=0.657037)\n157696        0x26800         TMS320C6x (size=0x800, entropy=0.621518)\n159744        0x27000         None (size=0x11000, entropy=0.666237)\n229376        0x38000         TMS320C6x (size=0x1800, entropy=0.625215)\n235520        0x39800         None (size=0x4000, entropy=0.656501)\n251904        0x3D800         TMS320C6x (size=0x800, entropy=0.619983)\n253952        0x3E000         None (size=0x6800, entropy=0.658247)\n280576        0x44800         TMS320C6x (size=0x3000, entropy=0.678292)\n</code></pre>\nhostrsc.bin\n<pre><code>DECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n1133          0x46D           ARM executable code, 16-bit (Thumb), big endian, at least 548 valid instructions\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             None (size=0xc00, entropy=0.498160)\n3072          0xC00           IA-64 (size=0x100, entropy=0.121801)\n3328          0xD00           None (size=0x100, entropy=0.115110)\n3584          0xE00           OCaml (size=0x200, entropy=0.297187)\n4096          0x1000          None (size=0x3d00, entropy=0.500052)\n</code></pre>\nresource.bin\n<pre><code>DECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n149           0x95            ARM executable code, 16-bit (Thumb), little endian, at least 506 valid instructions\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             None (size=0x30000, entropy=0.676872)\n196608        0x30000         OCaml (size=0x1000, entropy=0.176639)\n200704        0x31000         None (size=0x9800, entropy=0.422213)\n239616        0x3A800         OCaml (size=0x2800, entropy=0.374464)\n249856        0x3D000         None (size=0x35800, entropy=0.650011)\n468992        0x72800         IA-64 (size=0x1800, entropy=0.388964)\n475136        0x74000         None (size=0x5800, entropy=0.366840)\n497664        0x79800         i860 (size=0x2800, entropy=0.510416)\n507904        0x7C000         None (size=0x3c000, entropy=0.621825)\n753664        0xB8000         IQ2000 (size=0x2000, entropy=0.606170)\n761856        0xBA000         None (size=0x19000, entropy=0.650506)\n864256        0xD3000         IQ2000 (size=0x1000, entropy=0.656057)\n868352        0xD4000         None (size=0x2000, entropy=0.670506)\n876544        0xD6000         IQ2000 (size=0x2800, entropy=0.647489)\n886784        0xD8800         None (size=0x3f000, entropy=0.669609)\n1144832       0x117800        IQ2000 (size=0x800, entropy=0.645091)\n1146880       0x118000        None (size=0x16000, entropy=0.680016)\n1236992       0x12E000        IQ2000 (size=0x1800, entropy=0.637937)\n1243136       0x12F800        None (size=0x9000, entropy=0.515688)\n1280000       0x138800        i860 (size=0x2800, entropy=0.505416)\n1290240       0x13B000        None (size=0x2000, entropy=0.520863)\n1298432       0x13D000        Mico32 (size=0x800, entropy=0.482741)\n1300480       0x13D800        None (size=0x24800, entropy=0.597388)\n1449984       0x162000        IQ2000 (size=0x800, entropy=0.632276)\n1452032       0x162800        None (size=0x16000, entropy=0.649701)\n1542144       0x178800        IQ2000 (size=0x800, entropy=0.607468)\n1544192       0x179000        None (size=0x19800, entropy=0.650747)\n1648640       0x192800        IQ2000 (size=0x5000, entropy=0.662928)\n1669120       0x197800        None (size=0x16000, entropy=0.665614)\n1759232       0x1AD800        IQ2000 (size=0x800, entropy=0.670895)\n1761280       0x1AE000        None (size=0x14800, entropy=0.667852)\n1845248       0x1C2800        IQ2000 (size=0x800, entropy=0.588944)\n1847296       0x1C3000        None (size=0x2b000, entropy=0.676079)\n2023424       0x1EE000        IQ2000 (size=0x800, entropy=0.624574)\n2025472       0x1EE800        None (size=0x1a800, entropy=0.560986)\n2134016       0x209000        IA-64 (size=0x2800, entropy=0.350932)\n2144256       0x20B800        None (size=0x5800, entropy=0.348755)\n2166784       0x211000        IA-64 (size=0x800, entropy=0.324605)\n2168832       0x211800        None (size=0x71800, entropy=0.583669)\n2633728       0x283000        i860 (size=0x800, entropy=0.355774)\n2635776       0x283800        None (size=0x1800, entropy=0.357956)\n2641920       0x285000        IA-64 (size=0x1000, entropy=0.353298)\n2646016       0x286000        None (size=0x4800, entropy=0.349873)\n2664448       0x28A800        IA-64 (size=0x1000, entropy=0.287276)\n2668544       0x28B800        None (size=0x2800, entropy=0.341594)\n2678784       0x28E000        IA-64 (size=0x1000, entropy=0.340884)\n2682880       0x28F000        None (size=0x15000, entropy=0.509803)\n2768896       0x2A4000        MMIX (size=0x800, entropy=0.560577)\n2770944       0x2A4800        None (size=0x8a000, entropy=0.641322)\n3336192       0x32E800        OCaml (size=0x2000, entropy=0.382561)\n3344384       0x330800        None (size=0x42800, entropy=0.593790)\n</code></pre>\nstmpsys.sb\n<pre><code>DECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n314           0x13A           ARM executable code, 16-bit (Thumb), little endian, at least 575 valid instructions\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             None (size=0x5800, entropy=0.692062)\n22528         0x5800          TMS320C6x (size=0x200, entropy=0.612087)\n23040         0x5A00          None (size=0x4000, entropy=0.678696)\n39424         0x9A00          TMS320C6x (size=0x200, entropy=0.609237)\n39936         0x9C00          None (size=0x2400, entropy=0.671392)\n49152         0xC000          ARC32el (size=0x200, entropy=0.618732)\n49664         0xC200          TMS320C6x (size=0x200, entropy=0.597122)\n50176         0xC400          None (size=0x1400, entropy=0.642002)\n55296         0xD800          ARC32el (size=0x200, entropy=0.581111)\n55808         0xDA00          None (size=0x7200, entropy=0.499010)\n84992         0x14C00         TMS320C6x (size=0x400, entropy=0.588876)\n86016         0x15000         None (size=0xb200, entropy=0.421008)\n</code></pre>\nupdater.sb - from DSP of STMP35xx-based Portable media player (DSP56004-compatible)\n<pre><code>DECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n34195         0x8593          ARM executable code, 16-bit (Thumb), big endian, at least 809 valid instructions\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             None (size=0x24000, entropy=0.559532)\n147456        0x24000         TMS320C6x (size=0x800, entropy=0.642204)\n149504        0x24800         None (size=0x2000, entropy=0.657037)\n157696        0x26800         TMS320C6x (size=0x800, entropy=0.621518)\n159744        0x27000         None (size=0x11000, entropy=0.666237)\n229376        0x38000         TMS320C6x (size=0x1800, entropy=0.625215)\n235520        0x39800         None (size=0x4000, entropy=0.656501)\n251904        0x3D800         TMS320C6x (size=0x800, entropy=0.619983)\n253952        0x3E000         None (size=0x6800, entropy=0.658247)\n280576        0x44800         TMS320C6x (size=0x3000, entropy=0.678292)\n</code></pre>\nHere are the bin and sb files:https://easyupload.io/zzuycg\nAnd also there is an output of an media player based on STMP34xx SoC:\nresource.bin\n<pre><code>DECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n1545          0x609           ARM executable code, 16-bit (Thumb), big endian, at least 538 valid instructions\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             None (size=0x25000, entropy=0.655862)\n151552        0x25000         OCaml (size=0x1800, entropy=0.213865)\n157696        0x26800         None (size=0x47000, entropy=0.585404)\n448512        0x6D800         OCaml (size=0x800, entropy=0.226252)\n450560        0x6E000         None (size=0xa800, entropy=0.550543)\n</code></pre>\nHere are the bin files:https://easyupload.io/jw5z4i\nDatasheet:https://www.rockbox.org/wiki/pub/Main/DataSheets/stmp35xx-ds-1-03.pdf\nRef. Schematics:http://www.rockbox.org/wiki/pub/Main/HardwareSchematics/stmp3500_reference_sch_revb.pdf\n",
    "votes": "2",
    "answers": 0,
    "views": "662",
    "tags": [
        "binary-analysis",
        "binwalk"
    ],
    "user": "Andy",
    "time": "May 14, 2023 at 21:02",
    "comments": [
        {
            "user": "secfren",
            "text": "Datasheet says under 2.3.1 \"The on-chip DSP core is modeled exactly after the Motorola DSP56004. It supports the identical instruction set, registers, addressing modes, etc., as the DSP56000 family of digital signal processors. \" An exhaustive datasheet of this processor is here: nxp.com/docs/en/reference-manual/DSP56000UM.pdf   Also: en.wikipedia.org/wiki/Digital_signal_processor#Architecture\n",
            "time": null
        }
    ],
    "answers_data": []
}