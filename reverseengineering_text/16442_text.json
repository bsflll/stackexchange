{
    "title": "What is \\Sessions\\1\\BaseNamedObjects\\NamedBuffer?",
    "link": "https://reverseengineering.stackexchange.com/questions/16442/what-is-sessions-1-basenamedobjects-namedbuffer",
    "content": "I see those in a debugger (OllyDbg, handles subwindow), but I never meet an explanation on what those are.\nHere is the full content of it, and to be honest I want to know the meaning of all of this. There are suspiciously a lot of <pre><code>NamedBuffer</code></pre>, and I wonder if it's the same for other computers.\nYesterday I learned that I can switch between native (<pre><code>\\REGISTRY\\MACHINE</code></pre>) and translated (<pre><code>HKEY_LOCAL_MACHINE</code></pre>) names by pressing Tab. It works for registry paths and file paths.\n<pre><code>Handles\nHandle     Type             Refs    Access     T    Info          Name\n00000028   ALPC Port           4.   001F0001\n0000004C   Desktop          1737.   000F01FF                      \\Default\n00000008   Directory          91.   00000003                      \\KnownDlls\n0000000C   Directory          53.   00000003                      \\KnownDlls32\n00000018   Directory          53.   00000003                      \\KnownDlls32\n00000070   Directory        2028.   0000000F                      \\Sessions\\1\\BaseNamedObjects\n0000003C   Event               2.   001F0003\n00000044   Event               3.   001F0003\n00000058   Event               2.   001F0003\n0000005C   Event               2.   001F0003\n00000060   Event               2.   001F0003\n00000064   Event               2.   001F0003\n00000068   Event               2.   001F0003\n0000006C   Event               2.   001F0003\n0000007C   File (dev)          2.   00100003                      \\FileSystem\\Filters\\FltMgrMsg\n00000010   File (dir)          2.   00100020                      \\Device\\HarddiskVolume1\\Windows\n0000001C   File (dir)          2.   00100020                      \\Device\\HarddiskVolume1\\shared\\debugger\n00000004   Key                 2.   00000009                      \\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\n00000014   Key                 2.   00000009                      \\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\n00000020   Key                 2.   00020019                      \\REGISTRY\\MACHINE\\SYSTEM\\ControlSet001\\Control\\Nls\\Sorting\\Versions\n00000024   Key                 2.   00000001                      \\REGISTRY\\MACHINE\\SYSTEM\\ControlSet001\\Control\\SESSION MANAGER\n00000038   Key                 2.   000F003F                      \\REGISTRY\\MACHINE\n00000034   Mutant              2.   001F0001\n00000080   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\mchLLEW2$1360\n00000084   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a5f9e0\n00000088   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\AutoUnhookMap$00001360$73ec0000\n0000008C   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $71ac0000\n00000094   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a7dffe\n00000098   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $73e812c6\n0000009C   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $73e82384\n000000A0   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $76fef792\n000000A4   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75db3be3\n000000A8   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $76e69d0b\n000000AC   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75b77ba4\n000000B0   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75b7ea03\n000000B4   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75b7b986\n000000B8   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75b758b3\n000000BC   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75dccd11\n000000C0   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75db9ae4\n000000C4   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75e1dd76\n000000C8   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75e1de19\n000000CC   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75dc3baa\n000000D0   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75b75ea5\n000000D4   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75b7cc01\n000000D8   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ba4969\n000000DC   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75b7ba5f\n000000E0   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75f202bf\n000000E4   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75f2027b\n000000E8   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed835c\n000000EC   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed7603\n000000F0   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ecee09\n000000F4   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed6110\n000000F8   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ec8332\n000000FC   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed3baa\n00000100   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed12a5\n00000104   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed3c61\n00000108   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ec8bff\n0000010C   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed612e\n00000110   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ec9679\n00000114   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed781f\n00000118   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ec97d2\n0000011C   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75f26cfc\n00000120   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed76e0\n00000124   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75f26d5d\n00000128   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed7668\n0000012C   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75eec112\n00000130   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75eed0f5\n00000134   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75eeff4a\n00000138   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75eeec68\n0000013C   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed291f\n00000140   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75eeeb96\n00000144   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75f288eb\n00000148   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed2d64\n0000014C   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed3698\n00000150   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75edc4b6\n00000154   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75f27dd7\n00000158   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75f09f1d\n0000015C   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ecefc9\n00000160   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed6c30\n00000164   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ec90d3\n00000168   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75ed2da4\n0000016C   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $75f11497\n00000170   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a60550\n00000174   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a603d0\n00000178   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a6079c\n0000017C   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a5ff74\n00000180   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a606f4\n00000184   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a60874\n00000188   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a607e4\n0000018C   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a60004\n00000190   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a60084\n00000194   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a61cb4\n00000198   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a61d8c\n0000019C   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a5fcb0\n000001A0   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a60694\n000001A4   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a60df4\n000001A8   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a61be4\n000001AC   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a5ffa4\n000001B0   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a5fdc8\n000001B4   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a600b4\n000001B8   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a5fd64\n000001BC   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a5fec0\n000001C0   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a6088c\n000001C4   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a60ed8\n000001C8   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a5fb28\n000001CC   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a608a4\n000001D0   Section             3.   000F0007                      \\Sessions\\1\\BaseNamedObjects\\NamedBuffer, mAH, Process $00001360, API $77a603b8\n0000002C   Semaphore           2.   00100003        Count 0. of\n00000030   Semaphore           2.   00100003        Count 0. of\n00000048   WindowStation      82.   000F037F                      \\Sessions\\1\\Windows\\WindowStations\\WinSta0\n00000050   WindowStation      82.   000F037F                      \\Sessions\\1\\Windows\\WindowStations\\WinSta0\n</code></pre>\n",
    "votes": "2",
    "answers": 2,
    "views": "8k",
    "tags": [
        "windows",
        "ollydbg",
        "winapi"
    ],
    "user": "puppon -su",
    "time": "Oct 23, 2017 at 17:50",
    "comments": [
        {
            "user": "RbMm",
            "text": "<pre><code>NamedBuffer, mAH, Process $00001360, API $77a7dffe</code></pre> this is section object (file mapping if want) and it created by <pre><code>0x1360</code></pre> process. if you look for this process you found that this is devenv.exe (so msvc). the <pre><code>77a7dffe</code></pre> is address and by this address some hook (jump dword ptr[xx]) is set.\n",
            "time": null
        },
        {
            "user": "puppon -su",
            "text": "@RbMm So you have just as many open sections as me? My <pre><code>Process $00001360</code></pre> points at hello world itself. It looks like a lot of processes have those, and for most of them (if not all, can't check it) <pre><code>Process $<process id></code></pre> has the process id of process itself.\n",
            "time": null
        },
        {
            "user": "RbMm",
            "text": "yes, i have many this kind of sections. however it created by devenv.exe in my case\n",
            "time": null
        }
    ],
    "answers_data": [
        {
            "content": "Those are section names, either created by CreateFileMapping() or by ZwCreateSection. It won't be the same on other computers.\nOllyDbg even says the handle is a section.\nA simple executable won't have many handles.\nYou can check and compile this code from MSDN to see the names in the OllyDbg\nhandle window.\nCreating Named Shared Memory\nIf you create ten different file mappings you will see\n10 section handles with ten names as shown below,\nBaseNamedObjects\\MyFileMappingObject1 2, 3, etc., etc.\nHandles, item 4\nHandle=00000028 \nType=Section \nRefs=   3. \nAccess=000F0007    WRITE_OWNER|WRITE_DAC|READ_CONTROL|DELETE|QUERY_STATE|MODIFY_STATE|4 \nName=\\BaseNamedObjects\\MyFileMappingObject\n",
            "votes": "1",
            "user": "Peter Mortensen",
            "time": "Oct 24, 2017 at 4:13",
            "is_accepted": true,
            "comments": [
                {
                    "user": "puppon -su",
                    "text": "<span class=\"comment-copy\">Is it normal to have so many of shared memory? I just started a simple \"hello world\", and it shows that there are 70 of them.</span>",
                    "time": null
                },
                {
                    "user": "puppon -su",
                    "text": "<span class=\"comment-copy\">Also how do you think, everything after \"BaseNamedObjects\\\" is also part of a name? So, full name is \"NamedBuffer, mAH, Process $00001360, API $77a5f9e0\" ?</span>",
                    "time": null
                },
                {
                    "user": "RbMm",
                    "text": "<span class=\"comment-copy\">yes, full name is <code>NamedBuffer, mAH, Process $00001360, API $77a5f9e0</code></span>",
                    "time": null
                }
            ]
        },
        {
            "content": "About this line:\n<pre><code>00000034   Mutant              2.   001F0001\n</code></pre>\nA mutant is the kernel name for a mutex.\n\nThe name mutant has a colorful history.  Early in Windows NT's\n  development, Dave Cutler created a kernel mutex object that\n  implemented low-level mutual exclusion.  Later he discovered that OS/2\n  required a version of the mutual exclusion semaphore with additional\n  semantics, which Dave considered \"brain-damaged\" and which was\n  incompatible with the original object. (Specifically, a thread could\n  abandon the object and leave it inaccessible.)  So he created an OS/2\n  version of the mutex and gave it the name mutant.  Later Dave modified\n  the mutant object to remove the OS/2 semantics, allowing the Win32\n  subsystem to use the object.  The Win32 API calls the modified object\n  mutex, but the native services retain the name mutant.\n\nhttps://forum.sysinternals.com/whats-a-mutant-handle_topic17376.html\nhttps://blogs.msdn.microsoft.com/larryosterman/2004/09/24/cleaning-up-shared-resources-when-a-process-is-abnormally-terminated/\nHelen Custers, \"Inside Windows NT\"\n",
            "votes": "1",
            "user": "puppon -su",
            "time": "Sep 29, 2017 at 10:43",
            "is_accepted": false,
            "comments": [
                {
                    "user": "blabb",
                    "text": "<span class=\"comment-copy\">what is the question  ?  mutant is a type of handle   it can be created with or without a name  and edit your question and add info or create a new question do not answer that is unrelatef to original question  <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682411(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/…</a></span>",
                    "time": null
                },
                {
                    "user": "blabb",
                    "text": "<span class=\"comment-copy\">autounhookmap appears to be part of madshi framework you should check if you have anything madshi related in your machine</span>",
                    "time": null
                },
                {
                    "user": "puppon -su",
                    "text": "<span class=\"comment-copy\">I'd like to know what all of this means. Things like \"ALPC Port\", \"File (dev)\", \"File (dir)\", \"\\KnownDlls32\". Also I probably have a malware.</span>",
                    "time": null
                },
                {
                    "user": "blabb",
                    "text": "<span class=\"comment-copy\">find some windows internals related resource and read them  your question is vague as it is phrased  alpc is advanced local procedure calls  a means for interprocess communication  file dev is a device fille file dir is a directory object</span>",
                    "time": null
                },
                {
                    "user": "blabb",
                    "text": "<span class=\"comment-copy\">knowndlls <a href=\"https://blogs.msdn.microsoft.com/larryosterman/2004/07/19/what-are-known-dlls-anyway/\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/larryosterman/2004/07/19/…</a></span>",
                    "time": null
                }
            ]
        }
    ]
}