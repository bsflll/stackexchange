{
    "title": "Reverse engineer TPMS sensor data",
    "link": "https://reverseengineering.stackexchange.com/questions/11539/reverse-engineer-tpms-sensor-data",
    "content": "I'm trying to reverse engineer data received from TPMS (car tire pressure) sensors. I was able to receive and demodulate the data (433 MHz, FSK, Manchester encoding).\n\nProbable packet fields:\n<pre><code>bytes 1-4:</code></pre> sensor id (4 distinct values detected)\n<pre><code>bytes 5-9:</code></pre> unknown (temp/pressure)\n<pre><code>byte   10:</code></pre> 8-bit CRC detected by using <pre><code>reveng</code></pre>\n\nIn the 5 unknown bytes there should be encoded tire pressure and tire temperature and some status bits. However I was not able to guess how are these temp/pressure data encoded. The pressures as shown by car were in the range 211-220 kPa, temperature between 5-15 degrees.\nCan you help me decoding the temperature and pressure from the below data or at least point me to some direction?\nHere is the detected data from sensors:\n<pre><code> sensor_id        temp/press       CRC\n\n1f e0 ed a5     42 d5 66 c7 f1     10\n1f e0 ed a5     42 d4 66 c7 f1     06\n1f e0 ed a5     44 d6 66 c7 e4     0a\n1f e0 ed a5     44 d4 66 c7 e4     26\n1f e0 ed a5     55 d4 68 c8 da     23\n1e e0 ed a5     42 d5 66 c7 db     bf\n1e e0 ed a5     41 d6 65 c8 cb     2d\n1e e0 ed a5     41 d5 65 c8 cb     17\n1e e0 ed a5     55 d5 68 c8 f7     8f\n1e e0 ed a5     55 d4 68 c8 f7     99\n1d e0 ed a5     44 d6 66 c7 f7     81\n1d e0 ed a5     41 d5 64 c8 eb     17\n1d e0 ed a5     55 d5 68 c8 da     c7\n1d e0 ed a5     42 d5 65 c7 c8     f0\n1d e0 ed a5     42 d4 65 c7 c8     e6\n1c e0 ed a5     44 d5 65 c8 d9     76\n1c e0 ed a5     41 d4 64 c8 d3     d0\n1c e0 ed a5     55 d6 67 c8 df     d8\n1c e0 ed a5     55 d5 67 c8 df     e2\n1c e0 ed a5     55 d4 67 c8 df     f4\n1c e0 ed a5     42 d6 65 c7 ef     46\n1c e0 ed a5     42 d5 65 c7 ef     7c\n1c e0 ed a5     42 d4 65 c7 ef     6a\n1f e0 ed a5     44 d6 65 c7 f3     d2\n1f e0 ed a5     44 d4 65 c7 f3     fe\n1f e0 ed a5     41 d5 64 c8 f6     b6\n1f e0 ed a5     41 d4 64 c8 f6     a0\n1f e0 ed a5     42 d6 65 c7 f9     af\n1f e0 ed a5     42 d4 65 c7 f9     83\n1e e0 ed a5     42 d6 64 c7 f7     97\n1e e0 ed a5     42 d5 64 c7 f7     ad\n1e e0 ed a5     42 d4 64 c7 f7     bb\n1f e0 ed a5     55 d6 67 c8 f5     85\n1f e0 ed a5     55 d5 67 c8 f5     bf\n1d e0 ed a5     42 d5 64 c7 f3     3a\n1d e0 ed a5     42 d4 64 c7 f3     2c\n1e e0 ed a5     44 d6 64 c7 f4     d5\n1e e0 ed a5     44 d5 64 c7 f4     ef\n1e e0 ed a5     44 d4 64 c7 f4     f9\n1e e0 ed a5     41 d4 64 c8 f6     d9\n1e e0 ed a5     55 d6 67 c8 f7     f2\n1c e0 ed a5     42 d5 64 c7 f3     43\n1d e0 ed a5     44 d6 64 c7 f4     5e\n1d e0 ed a5     44 d5 64 c7 f4     64\n1d e0 ed a5     55 d6 68 c8 f5     30\n1d e0 ed a5     55 d5 68 c8 f5     0a\n1d e0 ed a5     55 d4 68 c8 f5     1c\n1f e0 ed a5     42 d5 65 c7 f4     b6\n1c e0 ed a5     44 d6 65 c7 f5     4b\n1c e0 ed a5     44 d4 65 c7 f5     67\n1c e0 ed a5     41 d6 64 c8 f2     1b\n1c e0 ed a5     41 d5 64 c8 f2     21\n1c e0 ed a5     41 d4 64 c8 f2     37\n1c e0 ed a5     55 d6 67 c8 ed     46\n1c e0 ed a5     55 d5 67 c8 ed     7c\n1e e0 ed a5     42 d5 64 c7 f3     b1\n1e e0 ed a5     42 d4 64 c7 f3     a7\n1f e0 ed a5     44 d6 64 c7 f3     b9\n1f e0 ed a5     44 d5 64 c7 f3     83\n1f e0 ed a5     44 d4 64 c7 f3     95\n1f e0 ed a5     41 d5 64 c8 ed     f7\n1f e0 ed a5     41 d4 64 c8 ed     e1\n1f e0 ed a5     55 d4 67 c8 ea     f4\n1d e0 ed a5     42 d6 64 c7 dc     cd\n1d e0 ed a5     42 d4 64 c7 dc     e1\n1e e0 ed a5     44 d6 64 c7 da     1f\n1e e0 ed a5     44 d5 64 c7 da     25\n1e e0 ed a5     44 d4 64 c7 da     33\n1e e0 ed a5     41 d4 64 c7 f4     14\n1e e0 ed a5     55 d6 67 c8 f2     e9\n1e e0 ed a5     55 d5 67 c8 f2     d3\n1c e0 ed a5     42 d6 63 c7 c3     ff\n1c e0 ed a5     42 d5 63 c7 c3     c5\n1c e0 ed a5     42 d4 63 c7 c3     d3\n1d e0 ed a5     41 d6 63 c7 dd     7a\n1d e0 ed a5     41 d4 63 c7 dd     56\n1d e0 ed a5     55 d6 67 c8 e0     1c\n1d e0 ed a5     55 d5 67 c8 e0     26\n1f e0 ed a5     42 d6 64 c6 d6     1c\n1c e0 ed a5     44 d6 63 c7 d9     f2\n1c e0 ed a5     44 d4 63 c7 d9     de\n1c e0 ed a5     41 d6 63 c8 d4     ff\n1c e0 ed a5     41 d5 63 c8 d4     c5\n1c e0 ed a5     55 d4 67 c8 d6     cb\n1f e0 ed a5     44 d6 64 c7 d3     59\n1e e0 ed a5     42 d5 64 c6 d4     51\n1f e0 ed a5     41 d6 63 c7 e9     04\n1f e0 ed a5     41 d4 63 c7 e9     28\n1f e0 ed a5     55 d6 67 c8 eb     df\n1f e0 ed a5     55 d4 67 c8 eb     f3\n1e e0 ed a5     44 d6 63 c7 9d     db\n1e e0 ed a5     44 d5 63 c7 9d     e1\n1d e0 ed a5     42 d4 63 c6 9a     37\n1e e0 ed a5     41 d6 63 c7 d6     c0\n1e e0 ed a5     41 d5 63 c7 d6     fa\n1e e0 ed a5     55 d6 66 c8 cf     31\n1e e0 ed a5     55 d5 66 c8 cf     0b\n1d e0 ed a5     44 d6 62 c7 f4     23\n1d e0 ed a5     44 d5 62 c7 f4     19\n1c e0 ed a5     42 d6 63 c6 f5     68\n1c e0 ed a5     42 d5 63 c6 f5     52\n1c e0 ed a5     42 d4 63 c6 f5     44\n1d e0 ed a5     41 d6 63 c7 df     74\n1c e0 ed a5     55 d4 66 c8 f7     47\n1c e0 ed a5     41 d5 63 c7 f5     e1\n1c e0 ed a5     44 d6 64 c6 e4     42\n1f e0 ed a5     42 d6 5f c6 d4     1f\n1f e0 ed a5     42 d5 5f c6 d4     25\n1f e0 ed a5     42 d4 5f c6 d4     33\n1f e0 ed a5     55 d6 67 c8 eb     df\n1f e0 ed a5     41 d6 61 c7 dd     5e\n1f e0 ed a5     41 d5 61 c7 dd     64\n1f e0 ed a5     41 d4 61 c7 dd     72\n1e e0 ed a5     42 d4 62 c6 f2     c8\n1e e0 ed a5     55 d6 66 c8 e4     e0\n1e e0 ed a5     55 d5 66 c8 e4     da\n1e e0 ed a5     55 d4 66 c8 e4     cc\n1e e0 ed a5     41 d4 62 c7 e2     0b\n1e e0 ed a5     44 d6 63 c6 f5     d1\n1e e0 ed a5     44 d4 63 c6 f5     fd\n1d e0 ed a5     42 d6 60 c6 e4     db\n1d e0 ed a5     42 d5 60 c6 e4     e1\n1d e0 ed a5     42 d4 60 c6 e4     f7\n1d e0 ed a5     41 d6 62 c6 f4     db\n1d e0 ed a5     41 d5 62 c6 f4     e1\n1d e0 ed a5     41 d4 62 c6 f4     f7\n1d e0 ed a5     44 d5 63 c6 f3     72\n1d e0 ed a5     44 d4 63 c6 f3     64\n1c e0 ed a5     42 d6 61 c5 ef     c7\n1c e0 ed a5     44 d5 62 c6 c6     eb\n1f e0 ed a5     42 d5 61 c5 dd     e8\n1f e0 ed a5     42 d4 61 c5 dd     fe\n1f e0 ed a5     41 d6 62 c7 f1     27\n1f e0 ed a5     41 d5 62 c7 f1     1d\n1f e0 ed a5     41 d4 62 c7 f1     0b\n1f e0 ed a5     44 d6 62 c5 d6     15\n1f e0 ed a5     44 d4 62 c5 d6     39\n1e e0 ed a5     42 d5 61 c5 9f     58\n1e e0 ed a5     42 d4 61 c5 9f     4e\n1c e0 ed a5     55 d5 65 c7 85     76\n1e e0 ed a5     41 d6 62 c6 ca     ea\n1e e0 ed a5     41 d4 62 c6 ca     c6\n1e e0 ed a5     44 d5 61 c6 f3     2f\n1d e0 ed a5     42 d6 60 c5 f0     88\n1d e0 ed a5     42 d5 60 c5 f0     b2\n1d e0 ed a5     42 d4 60 c5 f0     a4\n1f e0 ed a5     55 d5 65 c7 e8     f9\n1d e0 ed a5     41 d6 61 c6 ec     2e\n1d e0 ed a5     41 d5 61 c6 ec     14\n1d e0 ed a5     41 d4 61 c6 ec     02\n1d e0 ed a5     44 d5 62 c5 ea     69\n1d e0 ed a5     44 d4 62 c5 ea     7f\n1c e0 ed a5     42 d6 5c c4 ea     b9\n1c e0 ed a5     42 d4 5c c4 ea     95\n1e e0 ed a5     55 d5 65 c7 e2     b6\n1c e0 ed a5     41 d6 61 c6 e4     6f\n1c e0 ed a5     41 d4 61 c6 e4     43\n1c e0 ed a5     44 d6 61 c5 e6     b3\n1c e0 ed a5     44 d5 61 c5 e6     89\n1c e0 ed a5     44 d4 61 c5 e6     9f\n1f e0 ed a5     42 d6 61 c4 dd     c7\n1f e0 ed a5     42 d4 61 c4 dd     eb\n1d e0 ed a5     55 d5 65 c7 d3     aa\n1d e0 ed a5     55 d4 65 c7 d3     bc\n1f e0 ed a5     41 d6 61 c6 da     5e\n1f e0 ed a5     41 d5 61 c6 da     64\n1f e0 ed a5     44 d5 61 c5 ec     34\n1e e0 ed a5     42 d6 60 c4 e9     59\n1e e0 ed a5     42 d4 60 c4 e9     75\n1e e0 ed a5     41 d6 62 c6 d6     be\n1e e0 ed a5     41 d5 62 c6 d6     84\n1e e0 ed a5     44 d6 61 c5 d9     fc\n1e e0 ed a5     44 d4 61 c5 d9     d0\n1d e0 ed a5     42 d6 60 c3 de     3c\n1d e0 ed a5     42 d5 60 c3 de     06\n1d e0 ed a5     42 d4 60 c3 de     10\n1d e0 ed a5     41 d6 61 c6 e2     04\n1d e0 ed a5     44 d5 61 c5 df     5f\n1d e0 ed a5     44 d4 61 c5 df     49\n1c e0 ed a5     42 d6 5f c4 d8     9a\n1c e0 ed a5     42 d5 5f c4 d8     a0\n1c e0 ed a5     42 d4 5f c4 d8     b6\n1f e0 ed a5     55 d6 65 c7 d8     53\n1f e0 ed a5     55 d4 65 c7 d8     7f\n1c e0 ed a5     41 d6 61 c6 dc     c7\n1c e0 ed a5     41 d5 61 c6 dc     fd\n1c e0 ed a5     41 d4 61 c6 dc     eb\n1c e0 ed a5     44 d6 61 c5 df     1c\n1c e0 ed a5     44 d5 61 c5 df     26\n1c e0 ed a5     44 d4 61 c5 df     30\n1f e0 ed a5     42 d5 60 c3 e6     5c\n1f e0 ed a5     42 d4 60 c3 e6     4a\n1e e0 ed a5     55 d5 65 c7 e6     aa\n1f e0 ed a5     41 de 61 c6 f7     2d\n1f e0 ed a5     41 dd 61 c6 f7     17\n1f e0 ed a5     41 dc 61 c6 f7     01\n</code></pre>\n",
    "votes": "8",
    "answers": 1,
    "views": "1k",
    "tags": [
        "binary-analysis",
        "decryption",
        "encodings",
        "protocol"
    ],
    "user": "Marki555",
    "time": "Jun 17, 2020 at 9:54",
    "comments": [
        {
            "user": "Cheibriados",
            "text": "Probably a coincidence, but the second byte (0xD4 to 0xD6) gives a decimal value between 212 and 214, potentially within your range of 211 to 220 kPa.  Do you have a part number or manufacturer for the sensor?\n",
            "time": null
        },
        {
            "user": "Marki555",
            "text": "@Cheibriados yes I have - it is VDO Continental S180052024 (FCC ID S180020, however the interesting parts are confidential in the FCC database)\n",
            "time": null
        },
        {
            "user": "w s",
            "text": "Do you mean celcius degrees ?\n",
            "time": null
        },
        {
            "user": "JimmyB",
            "text": "Inflate +100hPa, then drive slowly until you get the first measurements. Temperature will not be an issue if you just drive a couple of 100m... Point is: Make differential measurements for a differential analysis.\n",
            "time": null
        },
        {
            "user": "Anton Kukoba",
            "text": "I would suggest learning the chip used in your TPMS. And then read about it's protocol in the datasheet. For example in NXP they transfer pressure and temperature. cache.freescale.com/files/training/doc/dwf/… see page 40\n",
            "time": null
        }
    ],
    "answers_data": [
        {
            "content": "Usually, temperature and pressure only given by 1 byte of data. In my opinion, the first byte after ID is temperature in celsius and the second byte is pressure in kPa. The first byte which is in the range 41-55 can be calculated as follows:\n1. Change hex to decimal. Hex 41 in binary is 65.\n2. Substract 65 with minimum temperature that sensor is capable of (mostly -40). So 65-40 = 25 C.\n3. To ensure your calculation, you must remove the sensor from the tire and test it in temperature controlled environment, e.g. fridge. Put the sensor in the fridge along side with digital temperature gauge.\nFor the pressure, you don't need substraction because the sensor is not designed for vacuum calculation. Good luck.\n",
            "votes": "1",
            "user": "Alan",
            "time": "Jan 31, 2020 at 23:00",
            "is_accepted": false,
            "comments": []
        }
    ]
}