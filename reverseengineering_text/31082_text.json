{
    "title": "Ghidra: Reference to external symbols not resolved in decompile",
    "link": "https://reverseengineering.stackexchange.com/questions/31082/ghidra-reference-to-external-symbols-not-resolved-in-decompile",
    "content": "In <pre><code>main()</code></pre> the references to external functions are not resolved in the decompile window, while they seem correct in the assembly:\n\n\nThe other functions of the same application are fine, and the references to external and internal symbols are showed also in the decompile.\nThe references to internal functions are showed correctly also in <pre><code>main()</code></pre>.\n\nThe application is for MIPS.\nEDIT:\nContext around the initialization of <pre><code>local_518</code></pre>:\n<pre><code>                  //\n                  // .text \n                  // SHT_PROGBITS  [0xde0 - 0x7f6f]\n                  // ram:00010de0-ram:00017f6f\n                  //\n                  **************************************************************\n                  *                          FUNCTION                          *\n                  **************************************************************\n                  int __stdcall main(int argc, undefined4 * argv)\n                       assume gp = 0x32030\n                       assume t9 = 0x10de0\n     int               v0:4           <RETURN>\n     int               a0:4           argc\n     undefined4 *      a1:4           argv\n     undefined4        Stack[-0x4]:4  local_4          XREF[2]:     00010df8(W),\n[CUT...]\n     undefined4        Stack[-0x518   local_518        XREF[181]:   00010df4(W),\n                                                                    00010e40(R),\n                                                                    00010e60(R),\n                                                                    00010e7c(R),\n                                                                    00010e98(R),\n                                                                    00010eb4(R),\n                                                                    00010ed0(R),\n                                                                    00010eec(R),\n                                                                    00010f08(R),\n                                                                    00010f24(R),\n                                                                    00010f40(R),\n                                                                    00010f5c(R),\n                                                                    00010f80(R),\n                                                                    00010f90(R),\n                                                                    00010fb0(R),\n                                                                    00010fd4(R),\n                                                                    00010fe8(R),\n                                                                    00010ffc(R),\n                                                                    00011044(R),\n                                                                    0001109c(R)\n[CUT...]\n     undefined4        Stack[-0x5b0   local_5b0        XREF[10]:    00011018(W),\n                                                                    00011168(W),\n                                                                    0001139c(W),\n                                                                    000115d4(W),\n                                                                    000116ec(W),\n                                                                    00011b94(W),\n                                                                    00011bfc(W),\n                                                                    00011fa0(W),\n                                                                    00012360(W),\n                                                                    000124a8(W)\n                     _ftext       XREF[4]:     Entry Point(*), \n                     main                      __start:0001262c(*), 0002a048(*),\n                                               _elfSectionHeaders::0000014c(*)\n00010de0 02 00 1c 3c     lui        gp,0x2\n     assume t9 = <UNKNOWN>\n     assume gp = <UNKNOWN>\n00010de4 50 12 9c 27     addiu      gp,gp,0x1250\n00010de8 21 e0 99 03     addu       gp,gp,t9\n00010dec 40 fa bd 27     addiu      sp,sp,-0x5c0\n00010df0 02 00 82 28     slti       v0,argc,0x2\n00010df4 a8 00 bc af     sw         gp=>_gp_1,local_518(sp)\n00010df8 bc 05 bf af     sw         ra,local_4(sp)\n00010dfc b8 05 be af     sw         s8,local_8(sp)\n</code></pre>\nIs there a way to fix this?\n",
    "votes": "4",
    "answers": 0,
    "views": "599",
    "tags": [
        "ghidra",
        "mips"
    ],
    "user": "flydutch",
    "time": "Nov 7, 2022 at 8:38",
    "comments": [
        {
            "user": "Florian Magin",
            "text": "This probably happens because the decompiler can't infer the value of <pre><code>local_518</code></pre>. I'm not familiar with the kind of MIPS code generated here and I need the context where this value comes from, then it is probably possible to model this in a way that the decompiler understands.\n",
            "time": null
        },
        {
            "user": "born",
            "text": "Can you please share the sample you are looking at (for example by uploading it to malshare.com and referencing it by SHA256 hash here)?\n",
            "time": null
        }
    ],
    "answers_data": []
}