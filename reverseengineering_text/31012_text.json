{
    "title": ".bin firmware Standalone Binwalk returns garbage, Binwalk -I returns something but seems corrupted. Binwalk -X returns hundreds of raw deflate streams",
    "link": "https://reverseengineering.stackexchange.com/questions/31012/bin-firmware-standalone-binwalk-returns-garbage-binwalk-i-returns-something-b",
    "content": "As the title says I have the firmware of the WAX214 wifi access point. The firmware is actively preventing me from using the full available functionality of the device so I am trying to reverse it to look for a way to get raw ssh shell on it.\nFrom the running firmware I can deduce 100% that it is an Openwrt based system.\nRunning binwalk against it returns just two results, which are pretty much garbage.\n<pre><code>┌──(arimodu㉿kalivm)-[~/WAX214-Firmware]\n└─$ binwalk WAX214_V2.1.1.3_firmware.bin   \n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n11661818      0xB1F1FA        MPEG transport stream data\n19693572      0x12C8004       Cisco IOS microcode, for \"\"\n</code></pre>\nIf I try to run Binwalk with the -I flag I get\n<pre><code>┌──(arimodu㉿kalivm)-[~/WAX214-Firmware]\n└─$ binwalk WAX214_V2.1.1.3_firmware.bin -I\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n27            0x1B            Broadcom firmware header Corporatio sfsM▒Üõvÿ. Model: <ãÖ¬5x<Ìg³Y´x<Ï!ß8ßUð¨GÝ8Â¦ÿWkH\n                                                                                                                   ®Ïg³Y­Qÿ¨ÀY¬x<ÎÐ+HÏg³Y¯x<Åg³Y¬Pÿ¼*Ï. Firmware version: ß8ßUð¨GÝ8Â¦ÿWkH\n                                                              ®Ïg³Y­Qÿ¨ÀY¬x<ÎÐ+HÏg³Y¯x<Åg³Y¬Pÿ¼*Ï.\n30494         0x771E          Linux EXT filesystem, blocks count: 2183564478, image size: 2235970025472, invalid state invalid error behavior invalid major revision rev -1056396809.-16120, ext4 filesystem data, UUID=4a8b3f59-f0aa-15d2-358c-2d4ffbeffbef, volume name \"*ØXwû¶G\"\n</code></pre>\nWhich is more what I would expect but there are these \"corrupted\" parts.\nIf I try to extract that with dd I just get the same thing. Running file against the extracted \"filesystem\" I get\n<pre><code>┌──(arimodu㉿kalivm)-[~/WAX214-Firmware]\n└─$ file filesystem.ext4\nfilesystem.ext4: Linux rev -148578675.-16120 ext4 filesystem data, UUID=4a8b3f59-f0aa-15d2-358c-2d4ffbef33d6 (compressed) (extents) (huge files)\n</code></pre>\nI notice the (compressed) keyword here so trying to run binwalk -X I get\n<pre><code>┌──(arimodu㉿kalivm)-[~/WAX214-Firmware]\n└─$ binwalk WAX214_V2.1.1.3_firmware.bin -X \n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n18            0x12            Raw deflate compression stream\n51            0x33            Raw deflate compression stream\n53            0x35            Raw deflate compression stream\n213           0xD5            Raw deflate compression stream\n269           0x10D           Raw deflate compression stream\n275           0x113           Raw deflate compression stream\n429           0x1AD           Raw deflate compression stream\n544           0x220           Raw deflate compression stream\n700           0x2BC           Raw deflate compression stream\n1100          0x44C           Raw deflate compression stream\n1107          0x453           Raw deflate compression stream\n1204          0x4B4           Raw deflate compression stream\n1564          0x61C           Raw deflate compression stream\n1940          0x794           Raw deflate compression stream\n2836          0xB14           Raw deflate compression stream\n3960          0xF78           Raw deflate compression stream\n3995          0xF9B           Raw deflate compression stream\n4084          0xFF4           Raw deflate compression stream\n   .\n   .\n   .\n</code></pre>\nI trimmed the output of this one but basically it goes through the entire file by some 50 - 200 or so increments.\nI tried mounting, no luck. fsck no luck either. What I get from that is this is not usable as a filesystem. Its probably not encrypted, but there is certainly something going in with compression I dont understand. Strings against either doesnt come up with anything useful, just garbage.\nEntropy is currently broken on kali and I cant seem to get it working so I didnt run entropy.\nAny ideas of what might be happening here?\n",
    "votes": "2",
    "answers": 0,
    "views": "337",
    "tags": [
        "firmware-analysis",
        "binwalk"
    ],
    "user": "Arimodu",
    "time": "Oct 19, 2022 at 17:48",
    "comments": [
        {
            "user": "oldoperator",
            "text": "I am running into the same thing with a software pkg format I am trying to understand how they encrypted it. Binwalk -e comes up with two things some compressed gzip that is corrupted data stream and date tagged in the future, but what I know for sure is that I have an ext4 file system in that compressed image using the binwalk -I. Just starting to dump it via dd to figure it out but yes, would be interested if you got further.\n",
            "time": null
        },
        {
            "user": "Arimodu",
            "text": "@oldoperator Sorry, after posting this I never got further. I tried and tried again but never got further than this. If someone more experienced got in here it would be great.\n",
            "time": null
        }
    ],
    "answers_data": []
}