{
    "title": "Figure out iButton hash of known stored value in 6 bytes",
    "link": "https://reverseengineering.stackexchange.com/questions/33166/figure-out-ibutton-hash-of-known-stored-value-in-6-bytes",
    "content": "I have an old iButton which stores a floating number on 6 bytes, presumably using a checksum, for which I can't figure out the algorithm.\nHere are samples I have:\n<pre><code>value   X1 X2 X3 X4 X5 X6   V1 V2   D1 D2\n\n00.81   82 9C B5 70 F8 42   00 51   82 cd\n01.43   82 42 23 2A 83 D2   00 8f   82 cd\n01.73   82 60 9E 58 E5 F5   00 ad   82 cd\n02.54   82 33 F4 29 10 87   00 fe   82 cd\n03.06   83 A0 94 E8 16 33   01 32   82 92\n03.09   83 A7 10 81 E8 DB   01 35   82 92\n03.39   83 C1 CE 17 42 B2   01 53   82 92\n04.58   83 58 DA FF F0 B1   01 ca   82 92\n04.59   83 59 85 3A 04 FA   01 cb   82 92\n04.84   83 76 C8 CC 82 C9   01 e4   82 92\n05.81   80 36 CE 42 52 6F   02 45   82 73\n06.43   80 F0 1F 9A 01 41   02 83   82 73\n06.73   80 D2 A2 E8 67 66   02 a1   82 73\n07.54   80 81 C8 99 92 14   02 f2   82 73\n08.06   81 0A EF DA BC 1E   03 26   82 2c\n08.09   81 05 A1 CD AD 9C   03 29   82 2c\n08.39   81 6B B5 25 E8 9F   03 47   82 2c\n09.58   81 92 A4 F7 FA 56   03 be   82 2c\n09.59   81 93 FB 32 0E 1D   03 bf   82 2c\n09.84   81 F4 7A 61 50 3F   03 d8   82 2c\n10.81   86 91 45 CF 82 63   04 39   82 a8\n11.43   86 DF 52 C6 50 D1   04 77   82 a8\n11.73   86 3D E5 C0 6F 7B   04 95   82 a8\n12.54   86 4E 8C 50 0D B8   04 e6   82 a8\n13.06   87 ED 62 8C 5B 69   05 1a   82 f7\n13.09   87 EA E6 E5 A5 81   05 1d   82 f7\n13.39   87 CC 3E A8 38 93   05 3b   82 f7\n14.58   87 45 A7 BC 4D 44   05 b2   82 f7\n14.59   87 44 F8 79 B9 0F   05 b3   82 f7\n14.84   87 3B 3E A8 CF 93   05 cc   82 f7\n15.81   84 3B 3E FD 28 4E   06 2d   82 16\n16.43   84 7D E3 8A 15 96   06 6b   82 16\n16.73   84 9F 54 8C 2A 3C   06 89   82 16\n17.54   84 CC 3E FD DF 4E   06 da   82 16\n18.06   85 47 19 BE F1 44   07 0e   82 49\n18.09   85 58 DA 55 27 12   07 11   82 49\n18.39   85 66 45 9A 92 BE   07 2f   82 49\n19.58   85 EF DC 8E E7 69   07 a6   82 49\n19.59   85 EE 83 4B 13 22   07 a7   82 49\n19.84   85 89 02 18 4D 00   07 c0   82 49\n20.81   8A 26 43 59 F5 47   08 21   82 07\n21.43   8A 58 DA 4D 77 90   08 5f   82 07\n21.73   8A 7A 67 3F 11 B7   08 7d   82 07\n22.54   8A C9 04 DB 2A F9   08 ce   82 07\n23.06   8B 5A 64 1A 2C 4D   09 02   82 58\n23.09   8B 5D E0 73 D2 A5   09 05   82 58\n23.39   8B 7B 38 3E 4F B7   09 23   82 58\n24.58   8B C2 2F 37 6A 05   09 9a   82 58\n24.59   8B C3 70 F2 9E 4E   09 9b   82 58\n24.84   8B EC 3D 04 18 7D   09 b4   82 58\n25.81   88 AC 3B 8A C8 DB   0a 15   82 b9\n26.43   88 EA E6 FD F5 03   0a 53   82 b9\n26.73   88 C8 5B 8F 93 24   0a 71   82 b9\n27.54   88 7B 38 6B A8 6A   0a c2   82 b9\n28.06   88 4F D3 49 03 3A   0a f6   82 b9\n28.09   88 40 9D 5E 12 B8   0a f9   82 b9\n28.39   89 F1 40 ED 72 2B   0b 17   82 e6\n29.58   89 68 54 05 C0 28   0b 8e   82 e6\n29.59   89 69 0B C0 34 63   0b 8f   82 e6\n29.84   89 4E 8C 48 5D 3A   0b a8   82 e6\n30.81   8E 6B B5 3D B8 1D   0c 09   82 62\n31.43   8E 25 A2 34 6A AF   0c 47   82 62\n31.73   8E 07 1F 46 0C 88   0c 65   82 62\n32.54   8E D4 79 98 97 0C   0c b6   82 62\n33.06   8E 88 5D FE 73 FC   0c ea   82 62\n33.09   8E 8F D9 97 8D 14   0c ed   82 62\n33.39   8F 36 CE 5A 02 ED   0d 0b   82 3d\n34.58   8F BF 57 4E 77 3A   0d 82   82 3d\n34.59   8F BE 08 8B 83 71   0d 83   82 3d\n34.84   8F A1 CB 60 55 27   0d 9c   82 3d\n35.81   8F C0 91 9F 01 A6   0d fd   82 3d\n36.43   8C E7 16 42 8F 22   0e 3b   82 dc\n36.73   8C 85 AD EB DE 7E   0e 59   82 dc\n37.54   8C 76 C8 D4 D2 4B   0e aa   82 dc\n38.06   8C 02 25 2D 4E 60   0e de   82 dc\n38.09   8C 3D E5 27 0F 87   0e e1   82 dc\n38.39   8C 23 79 09 2D 9A   0e ff   82 dc\n39.58   8D F5 25 E9 13 2B   0f 76   82 83\n39.59   8D F4 7A 2C E7 60   0f 77   82 83\n39.84   8D 13 F7 D0 D7 B4   0f 90   82 83\n40.81   8D 72 AD 2F 83 35   0f f1   82 83\n41.43   92 6F D0 A3 AE A3   10 2f   82 40\n41.73   92 0D 6B 0A FF FF   10 4d   82 40\n42.54   92 DE 0D D4 64 7B   10 9e   82 40\n43.06   92 92 A4 4E 47 5F   10 d2   82 40\n43.09   92 95 20 27 B9 B7   10 d5   82 40\n43.39   92 B3 F8 6A 24 A5   10 f3   82 40\n44.58   93 75 29 76 DD C0   11 6a   82 1f\n44.59   93 74 76 B3 29 8B   11 6b   82 1f\n44.84   93 9B 31 31 F6 35   11 84   82 1f\n45.81   93 FA 6B CE A2 B4   11 e5   82 1f\n46.43   90 DD EC 13 2C 30   12 23   82 fe\n46.73   90 BF 57 BA 7D 6C   12 41   82 fe\n47.54   90 6C 31 64 E6 E8   12 92   82 fe\n48.06   90 38 DF 7C ED 72   12 c6   82 fe\n48.09   90 37 91 6B FC F0   12 c9   82 fe\n48.39   90 19 83 58 8E 88   12 e7   82 fe\n49.58   91 FF 51 A5 E0 5C   13 5e   82 a1\n49.84   91 D9 89 E8 7D 4E   13 78   82 a1\n50.81   91 78 D9 63 70 42   13 d9   82 a1\n\n</code></pre>\nIn the table I started to write some columns:\n<pre><code>hex(value*100) = V1V2</code></pre>,\n<pre><code>D1D2 = X1X2^V1V2</code></pre>.\nI figured out that <pre><code>V1=X1^0x82</code></pre>.\nThere is also some relation between <pre><code>V1</code></pre> and <pre><code>X2^V2</code></pre> but I am currently stuck!\nFinally the 4 last bytes I suspect to be some hash result, CRC or checksum?\nDo you have any help or tipps for what I should try?\n",
    "votes": "0",
    "answers": 0,
    "views": "24",
    "tags": [
        "encryption",
        "deobfuscation",
        "crc",
        "hash-functions"
    ],
    "user": "user25767759",
    "time": "Aug 18, 2024 at 9:59",
    "comments": [],
    "answers_data": []
}