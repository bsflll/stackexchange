{
    "title": "Determine encrypted/hashed/compressed proprietary driver file",
    "link": "https://reverseengineering.stackexchange.com/questions/6951/determine-encrypted-hashed-compressed-proprietary-driver-file",
    "content": "I have a file that I am trying understand its structure and format. It's a proprietary driver file of a control system for NEC LT380 projector which contain essential information such as TCP port number and available commands that the projector accepts such us power on/off, switch inputs and aspect ratio etc.\nI did a few tests on the file and able to determine a few things:\n\nHere's the content of the file: http://codepad.org/0pzGkLgT (you need to save the content into a file then open it using gzip software)\nI was able to determine that the file is gzipped and upon extraction, the zip contains a single file without extension.\nHere's the content of the extracted file: http://codepad.org/yvuceZcD (to read this, open using hex viewer)\nOnline TrID File Identifier seems to identify the extracted file as ABR or Adobe Photoshop Brush which of course is incorrect.\nThen I opened the extracted file using text editor, it just show a bunch of hex strings.\nWhich led me to open the hex file in HexEdit. This time, I am able to see some human readable syntaxes and code.\nThe beginning and end of file contains some unreadable strings and some syntaxes such as \"Culture=neutral, PublicKeyToken=null\". These syntaxes seemed to suggest its .NET related but exactly what kind of .NET file I am not so sure. In the middle portion of the file, there's a bunch of code that with further investigation seemed like python code. Example: \ndef ReadAspectRatio(self, qualifier, context):\nAlso, on the same file, I found some tags:<pre><code>**<</Type/Catalog/Pages 2 0 R/Lang(en-US) >>**</code></pre> which is often found in a PDF file. Using PDF repair tool, I was able to recover and rebuild the streams of this file into a proper PDF file which contains a few pages of the projector commands and port information.\n\nQuestions:\n\nDo you have a way to determine what kind of file is this? Or what has been done to this file since there seems to be 3 different things inside that one file: .NET stuff (maybe manifest file or reference to .NET assembly), python code that does the set/read/write command to device and lastly PDF stream. Was there obfuscation or file joining method or hashes done on that beginning and end of file?\nI am looking to recreate and emulate the file. Currently, if I just open that extracted file, edit the middle portion of the file by adding some simple extra options/commands in proper python code, save it and gzip it back, it doesn't work.\n\nThanks!\n",
    "votes": "3",
    "answers": 2,
    "views": "622",
    "tags": [
        "driver"
    ],
    "user": "scott",
    "time": "Jan 4, 2015 at 13:52",
    "comments": [
        {
            "user": "Guntram Blohm",
            "text": "It would help if you uploaded the file to a site that supports binary files; we can't really use the codepad.org hex dumps (well, we can, using <pre><code>xxd -r -p</code></pre>, but why require an extra step, and the resulting gzip file seems truncated anyway. A complete file would be more helpful). Anyway, the format seems like some kind of serialization; there's file names like 'nec_1_548.py' and 'nec_1_548_v1_0_0.pdf' in the file as well, so the file seems to have all kind of stuff serialized, some of which are strings, some other are (python and PDF) files.\n",
            "time": null
        },
        {
            "user": "scott",
            "text": "Thanks for you reply! The original file is here: bit.ly/1zM3rsV I have also added some extra info to my post, in short the file contains a few stuffs: .NET tags which may contain manifest or reference to .NET assembly, some python code and also PDF stream.\n",
            "time": null
        },
        {
            "user": "user30993",
            "text": "You could always call Extron and check for updated drivers or download the configuration software they supply to make changes to the functionality of your device. I do it all the time.\n",
            "time": null
        }
    ],
    "answers_data": [
        {
            "content": "The file appears to be a binary-serialized .NET file (similar in concept to a Python pickle or a Java serialized stream), and does not appear to be obfuscated in any way. I manually parsed the first few records using the reference from Microsoft's stream format specification, and the format checks out. The file stores a single object of type \"Extron.Configuration.Drivers.DriverFileAsset\", with 18 class members of varying types.\nI guessed this format based on the fact that it contains .NET class library identifiers in the header, then verified the guess by checking the file format spec.\nI hacked together a parser for this format, though it is incomplete. The dump of the file looks like this:\n<pre><code>Binary Serialization Format\n@0\n  SerializedStreamHeader(TopId=1, HeaderId=-1, MajorVersion=1, MinorVersion=0)\n@17\n  BinaryLibrary(LibraryId=2, LibraryName='Extron.Configuration.Drivers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null')\n@106\n  BinaryLibrary(LibraryId=3, LibraryName='Extron.Configuration.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null')\n@192\n  BinaryLibrary(LibraryId=4, LibraryName='Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null')\n@283\n  BinaryLibrary(LibraryId=5, LibraryName='WindowsBase, Version=3.0.0.0, Culture=Neutral, PublicKeyToken=31bf3856ad364e35')\n@367\n  ClassWithMembersAndTypes LibraryId=2 ObjectId=1 Name=Extron.Configuration.Drivers.DriverFileAsset:\n      Extron.Configuration.Core.Assets.AssetBase`1[[Extron.Configuration.Contracts.Assets.IResourceAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] _manifest\n          MemberReference(IdRef=6)\n      Extron.Configuration.Contracts.Enumeration.DriverPackageStateEnum _packageState\n          ClassWithMembers LibraryId=4 ObjectId=-7 Name=Extron.Configuration.Contracts.Enumeration.DriverPackageStateEnum:\n              value__ = 0\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] _internalChildCollection\n          MemberReference(IdRef=8)\n      System.Version DriverDescriptorAsset+_fileVersion\n          MemberReference(IdRef=9)\n      System.Version DriverDescriptorAsset+_schemaVersion\n          MemberReference(IdRef=10)\n      System.Version DriverDescriptorAsset+_minAPIVersion\n          MemberReference(IdRef=11)\n      String DriverDescriptorAsset+_manufacturerName\n          BinaryObjectString(ObjectId=12, Value='NEC')\n      String DriverDescriptorAsset+_deviceTypeName\n          BinaryObjectString(ObjectId=13, Value='Video Projector')\n      String DriverDescriptorAsset+_filename\n          BinaryObjectString(ObjectId=14, Value='\\\\\\\\usa-home10\\\\home\\\\wes minner\\\\programming\\\\reviews\\\nec_1_548 [nec lt280]\\\\finished\\\nec_1_548_v1_0_0.pkp')\n      Int32 DriverDescriptorAsset+_contentHashCode\n          0\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] DriverDescriptorAsset+_internalChildCollection\n          MemberReference(IdRef=8)\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] AssetBase+_internalChildCollection\n          MemberReference(IdRef=8)\n      String AssetBase+_defaultName\n          BinaryObjectString(ObjectId=16, Value='nec_1_548')\n      String AssetBase+_name\n          MemberReference(IdRef=16)\n      System.Guid AssetBase+_guid\n          SystemClassWithMembers ObjectId=-17 Name=System.Guid:\n              _a = 2458436383\n              _b = 50071\n              _c = 18042\n              _d = 169\n              _e = 134\n              _f = 255\n              _g = 167\n              _h = 142\n              _i = 29\n              _j = 19\n              _k = 168\n      System.Nullable`1[[System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]] AssetBase+_maxChildCount\n          ObjectNull()\n      Boolean AssetBase+_disableChildAssetParenting\n          False\n      Extron.Configuration.Contracts.Assets.IAsset AssetBase+_parentAsset\n          ObjectNull()\n@2396\n  ClassWithMembersAndTypes LibraryId=3 ObjectId=6 Name=Extron.Configuration.Core.Assets.AssetBase`1[[Extron.Configuration.Contracts.Assets.IResourceAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IResourceAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] _internalChildCollection\n          MemberReference(IdRef=18)\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] AssetBase+_internalChildCollection\n          ObjectNull()\n      String AssetBase+_defaultName\n          ObjectNull()\n      String AssetBase+_name\n          ObjectNull()\n      System.Guid AssetBase+_guid\n          ClassWithId ObjectId=-19 Name=System.Guid:\n              _a = 2458436383\n              _b = 50071\n              _c = 18042\n              _d = 169\n              _e = 134\n              _f = 255\n              _g = 167\n              _h = 142\n              _i = 29\n              _j = 19\n              _k = 168\n      System.Nullable`1[[System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]] AssetBase+_maxChildCount\n          ObjectNull()\n      Boolean AssetBase+_disableChildAssetParenting\n          False\n      Extron.Configuration.Contracts.Assets.IAsset AssetBase+_parentAsset\n          ObjectNull()\n@3412\n  ClassWithMembers LibraryId=5 ObjectId=8 Name=System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      _monitor = MemberReference(IdRef=20)\n      Collection`1+items = MemberReference(IdRef=21)\n@3653\n  SystemClassWithMembers ObjectId=9 Name=System.Version:\n      _Major = 1\n      _Minor = 0\n      _Build = 0\n      _Revision = -1\n@3724\n  ClassWithId ObjectId=10 Name=System.Version:\n      _Major = 1\n      _Minor = 0\n      _Build = 0\n      _Revision = -1\n@3749\n  ClassWithId ObjectId=11 Name=System.Version:\n      _Major = 1\n      _Minor = 0\n      _Build = 0\n      _Revision = -1\n@3774\n  ClassWithMembers LibraryId=5 ObjectId=18 Name=System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IResourceAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      _monitor = MemberReference(IdRef=22)\n      Collection`1+items = MemberReference(IdRef=23)\n@4023\n  ClassWithMembers LibraryId=5 ObjectId=20 Name=System.Collections.ObjectModel.ObservableCollection`1+SimpleMonitor[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      _busyCount = 0\n@4255\n  SystemClassWithMembers ObjectId=21 Name=System.Collections.Generic.List`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      _items = MemberReference(IdRef=24)\n      _size = 6\n      _version = 6\n@4469\n  ClassWithMembers LibraryId=5 ObjectId=22 Name=System.Collections.ObjectModel.ObservableCollection`1+SimpleMonitor[[Extron.Configuration.Contracts.Assets.IResourceAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      _busyCount = 0\n@4709\n  SystemClassWithMembers ObjectId=23 Name=System.Collections.Generic.List`1[[Extron.Configuration.Contracts.Assets.IResourceAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      _items = MemberReference(IdRef=25)\n      _size = 2\n      _version = 2\n@4931\n  BinaryArray(ObjectId=24, BinaryArrayTypeEnum=<BinaryArrayType.Single: 0>, Rank=1, Lengths=(8,), LowerBounds=None, TypeEnum=<BinaryType.Class: 4>, AdditionalTypeInfo=ClassTypeInfo(TypeName='Extron.Configuration.Contracts.Assets.IAsset', LibraryId=4))\n      MemberReference(IdRef=26)\n      MemberReference(IdRef=27)\n      MemberReference(IdRef=28)\n      MemberReference(IdRef=29)\n      MemberReference(IdRef=30)\n      MemberReference(IdRef=31)\n      ObjectNullMultiple256(NullCount=2)\n@5027\n  BinaryArray(ObjectId=25, BinaryArrayTypeEnum=<BinaryArrayType.Single: 0>, Rank=1, Lengths=(4,), LowerBounds=None, TypeEnum=<BinaryType.Class: 4>, AdditionalTypeInfo=ClassTypeInfo(TypeName='Extron.Configuration.Contracts.Assets.IResourceAsset', LibraryId=4))\n      MemberReference(IdRef=32)\n      MemberReference(IdRef=33)\n      ObjectNullMultiple256(NullCount=2)\n@5111\n  ClassWithMembersAndTypes LibraryId=3 ObjectId=26 Name=Extron.Configuration.Core.Assets.RevisionHistoryAsset:\n      DateTime _date\n          2014-08-01 02:08:28.537000\n      String _author\n          BinaryObjectString(ObjectId=34, Value='ngupta')\n      System.Version _version\n          MemberReference(IdRef=35)\n      String _notes\n          BinaryObjectString(ObjectId=36, Value='')\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] _internalChildCollection\n          MemberReference(IdRef=37)\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] AssetBase+_internalChildCollection\n          MemberReference(IdRef=37)\n      String AssetBase+_defaultName\n          BinaryObjectString(ObjectId=38, Value='Creation')\n      String AssetBase+_name\n          MemberReference(IdRef=38)\n      System.Guid AssetBase+_guid\n          ClassWithId ObjectId=-39 Name=System.Guid:\n              _a = 2458436383\n              _b = 50071\n              _c = 18042\n              _d = 169\n              _e = 134\n              _f = 255\n              _g = 167\n              _h = 142\n              _i = 29\n              _j = 19\n              _k = 168\n      System.Nullable`1[[System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]] AssetBase+_maxChildCount\n          ObjectNull()\n      Boolean AssetBase+_disableChildAssetParenting\n          False\n      Extron.Configuration.Drivers.DriverFileAsset AssetBase+_parentAsset\n          MemberReference(IdRef=1)\n@6090\n  ClassWithId ObjectId=27 Name=Extron.Configuration.Core.Assets.RevisionHistoryAsset:\n      DateTime _date\n          2014-08-01 02:08:28.537000\n      String _author\n          BinaryObjectString(ObjectId=34, Value='ngupta')\n      System.Version _version\n          MemberReference(IdRef=35)\n      String _notes\n          BinaryObjectString(ObjectId=36, Value='')\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] _internalChildCollection\n          MemberReference(IdRef=37)\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] AssetBase+_internalChildCollection\n          MemberReference(IdRef=37)\n      String AssetBase+_defaultName\n          BinaryObjectString(ObjectId=38, Value='Creation')\n      String AssetBase+_name\n          MemberReference(IdRef=38)\n      System.Guid AssetBase+_guid\n          ClassWithId ObjectId=-39 Name=System.Guid:\n              _a = 2458436383\n              _b = 50071\n              _c = 18042\n              _d = 169\n              _e = 134\n              _f = 255\n              _g = 167\n              _h = 142\n              _i = 29\n              _j = 19\n              _k = 168\n      System.Nullable`1[[System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]] AssetBase+_maxChildCount\n          ObjectNull()\n      Boolean AssetBase+_disableChildAssetParenting\n          False\n      Extron.Configuration.Drivers.DriverFileAsset AssetBase+_parentAsset\n          MemberReference(IdRef=1)\n@6195\n  ClassWithMembersAndTypes LibraryId=3 ObjectId=28 Name=Extron.Configuration.Core.Assets.AssetBase`1[[Extron.Configuration.Contracts.Assets.Drivers.IDriverCommandAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.Drivers.IDriverCommandAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] _internalChildCollection\n          MemberReference(IdRef=48)\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] AssetBase+_internalChildCollection\n          ObjectNull()\n      String AssetBase+_defaultName\n          BinaryObjectString(ObjectId=49, Value='DriverCommands')\n      String AssetBase+_name\n          MemberReference(IdRef=49)\n      System.Guid AssetBase+_guid\n          ClassWithId ObjectId=-50 Name=System.Guid:\n              _a = 2458436383\n              _b = 50071\n              _c = 18042\n              _d = 169\n              _e = 134\n              _f = 255\n              _g = 167\n              _h = 142\n              _i = 29\n              _j = 19\n              _k = 168\n      System.Nullable`1[[System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]] AssetBase+_maxChildCount\n          ObjectNull()\n      Boolean AssetBase+_disableChildAssetParenting\n          False\n      Extron.Configuration.Drivers.DriverFileAsset AssetBase+_parentAsset\n          MemberReference(IdRef=1)\n@7264\n  ClassWithMembersAndTypes LibraryId=3 ObjectId=29 Name=Extron.Configuration.Core.Assets.AssetBase`1[[Extron.Configuration.Contracts.Assets.Protocols.IProtocolAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.Protocols.IProtocolAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] _internalChildCollection\n          MemberReference(IdRef=52)\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] AssetBase+_internalChildCollection\n          ObjectNull()\n      String AssetBase+_defaultName\n          BinaryObjectString(ObjectId=53, Value='SupportedProtocols')\n      String AssetBase+_name\n          MemberReference(IdRef=53)\n      System.Guid AssetBase+_guid\n          ClassWithId ObjectId=-54 Name=System.Guid:\n              _a = 2458436383\n              _b = 50071\n              _c = 18042\n              _d = 169\n              _e = 134\n              _f = 255\n              _g = 167\n              _h = 142\n              _i = 29\n              _j = 19\n              _k = 168\n      System.Nullable`1[[System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]] AssetBase+_maxChildCount\n          ObjectNull()\n      Boolean AssetBase+_disableChildAssetParenting\n          False\n      Extron.Configuration.Drivers.DriverFileAsset AssetBase+_parentAsset\n          MemberReference(IdRef=1)\n@8331\n  ClassWithMembersAndTypes LibraryId=3 ObjectId=30 Name=Extron.Configuration.Core.Assets.AssetBase`1[[Extron.Configuration.Contracts.Assets.Drivers.IDriverModelAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.Drivers.IDriverModelAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] _internalChildCollection\n          MemberReference(IdRef=56)\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] AssetBase+_internalChildCollection\n          ObjectNull()\n      String AssetBase+_defaultName\n          BinaryObjectString(ObjectId=57, Value='SupportedModels')\n      String AssetBase+_name\n          MemberReference(IdRef=57)\n      System.Guid AssetBase+_guid\n          ClassWithId ObjectId=-58 Name=System.Guid:\n              _a = 2458436383\n              _b = 50071\n              _c = 18042\n              _d = 169\n              _e = 134\n              _f = 255\n              _g = 167\n              _h = 142\n              _i = 29\n              _j = 19\n              _k = 168\n      System.Nullable`1[[System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]] AssetBase+_maxChildCount\n          ObjectNull()\n      Boolean AssetBase+_disableChildAssetParenting\n          False\n      Extron.Configuration.Drivers.DriverFileAsset AssetBase+_parentAsset\n          MemberReference(IdRef=1)\n@9397\n  ClassWithMembersAndTypes LibraryId=3 ObjectId=31 Name=Extron.Configuration.Core.Assets.AssetBase`1[[Extron.Configuration.Contracts.Assets.Automation.IParamAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.Automation.IParamAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] _internalChildCollection\n          MemberReference(IdRef=60)\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] AssetBase+_internalChildCollection\n          ObjectNull()\n      String AssetBase+_defaultName\n          BinaryObjectString(ObjectId=61, Value='DriverParams')\n      String AssetBase+_name\n          MemberReference(IdRef=61)\n      System.Guid AssetBase+_guid\n          ClassWithId ObjectId=-62 Name=System.Guid:\n              _a = 2458436383\n              _b = 50071\n              _c = 18042\n              _d = 169\n              _e = 134\n              _f = 255\n              _g = 167\n              _h = 142\n              _i = 29\n              _j = 19\n              _k = 168\n      System.Nullable`1[[System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]] AssetBase+_maxChildCount\n          ObjectNull()\n      Boolean AssetBase+_disableChildAssetParenting\n          False\n      Extron.Configuration.Drivers.DriverFileAsset AssetBase+_parentAsset\n          MemberReference(IdRef=1)\n@10454\n  ClassWithMembersAndTypes LibraryId=3 ObjectId=32 Name=Extron.Configuration.Core.Assets.Resource.StreamResourceAsset:\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] _internalChildCollection\n          MemberReference(IdRef=64)\n      String ResourceAssetBase+_key\n          BinaryObjectString(ObjectId=65, Value='nec_1_548_v1_0_0.pdf')\n      Object ResourceAssetBase+_content\n          MemberReference(IdRef=66)\n      Object ResourceAssetBase+_tag\n          BinaryObjectString(ObjectId=67, Value='nec_1_548_v1_0_0.pdf')\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] ResourceAssetBase+_internalChildCollection\n          MemberReference(IdRef=64)\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] AssetBase+_internalChildCollection\n          MemberReference(IdRef=64)\n      String AssetBase+_defaultName\n          BinaryObjectString(ObjectId=69, Value='nec_1_548_v1_0_0.pdf')\n      String AssetBase+_name\n          BinaryObjectString(ObjectId=70, Value='nec_1_548_v1_0_0.pdf')\n      System.Guid AssetBase+_guid\n          ClassWithId ObjectId=-71 Name=System.Guid:\n              _a = 2458436383\n              _b = 50071\n              _c = 18042\n              _d = 169\n              _e = 134\n              _f = 255\n              _g = 167\n              _h = 142\n              _i = 29\n              _j = 19\n              _k = 168\n      System.Nullable`1[[System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]] AssetBase+_maxChildCount\n          ObjectNull()\n      Boolean AssetBase+_disableChildAssetParenting\n          False\n      Extron.Configuration.Core.Assets.AssetBase`1[[Extron.Configuration.Contracts.Assets.IResourceAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] AssetBase+_parentAsset\n          MemberReference(IdRef=6)\n@11913\n  ClassWithId ObjectId=33 Name=Extron.Configuration.Core.Assets.Resource.StreamResourceAsset:\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] _internalChildCollection\n          MemberReference(IdRef=64)\n      String ResourceAssetBase+_key\n          BinaryObjectString(ObjectId=65, Value='nec_1_548_v1_0_0.pdf')\n      Object ResourceAssetBase+_content\n          MemberReference(IdRef=66)\n      Object ResourceAssetBase+_tag\n          BinaryObjectString(ObjectId=67, Value='nec_1_548_v1_0_0.pdf')\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] ResourceAssetBase+_internalChildCollection\n          MemberReference(IdRef=64)\n      System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] AssetBase+_internalChildCollection\n          MemberReference(IdRef=64)\n      String AssetBase+_defaultName\n          BinaryObjectString(ObjectId=69, Value='nec_1_548_v1_0_0.pdf')\n      String AssetBase+_name\n          BinaryObjectString(ObjectId=70, Value='nec_1_548_v1_0_0.pdf')\n      System.Guid AssetBase+_guid\n          ClassWithId ObjectId=-71 Name=System.Guid:\n              _a = 2458436383\n              _b = 50071\n              _c = 18042\n              _d = 169\n              _e = 134\n              _f = 255\n              _g = 167\n              _h = 142\n              _i = 29\n              _j = 19\n              _k = 168\n      System.Nullable`1[[System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]] AssetBase+_maxChildCount\n          ObjectNull()\n      Boolean AssetBase+_disableChildAssetParenting\n          False\n      Extron.Configuration.Core.Assets.AssetBase`1[[Extron.Configuration.Contracts.Assets.IResourceAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] AssetBase+_parentAsset\n          MemberReference(IdRef=6)\n@12046\n  ClassWithId ObjectId=35 Name=System.Version:\n      _Major = 1\n      _Minor = 0\n      _Build = 0\n      _Revision = -1\n@12071\n  ClassWithId ObjectId=37 Name=System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      _monitor = MemberReference(IdRef=20)\n      Collection`1+items = MemberReference(IdRef=21)\n@12090\n  ClassWithId ObjectId=42 Name=System.Version:\n      _Major = 1\n      _Minor = 0\n      _Build = 0\n      _Revision = -1\n@12115\n  ClassWithId ObjectId=44 Name=System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      _monitor = MemberReference(IdRef=20)\n      Collection`1+items = MemberReference(IdRef=21)\n@12134\n  ClassWithMembers LibraryId=5 ObjectId=48 Name=System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.Drivers.IDriverCommandAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      _monitor = MemberReference(IdRef=86)\n      Collection`1+items = MemberReference(IdRef=87)\n@12396\n  ClassWithMembers LibraryId=5 ObjectId=52 Name=System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.Protocols.IProtocolAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      _monitor = MemberReference(IdRef=88)\n      Collection`1+items = MemberReference(IdRef=89)\n@12655\n  ClassWithMembers LibraryId=5 ObjectId=56 Name=System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.Drivers.IDriverModelAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      _monitor = MemberReference(IdRef=90)\n      Collection`1+items = MemberReference(IdRef=91)\n@12915\n  ClassWithMembers LibraryId=5 ObjectId=60 Name=System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.Automation.IParamAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      _monitor = MemberReference(IdRef=92)\n      Collection`1+items = MemberReference(IdRef=93)\n@13172\n  ClassWithId ObjectId=64 Name=System.Collections.ObjectModel.ObservableCollection`1[[Extron.Configuration.Contracts.Assets.IAsset, Extron.Configuration.Contracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]:\n      _monitor = MemberReference(IdRef=20)\n      Collection`1+items = MemberReference(IdRef=21)\n</code></pre>\nYou may be able to load the file using some .NET functions, if you first import the driver's libraries. Otherwise, you can use the spec (which is very easy to read) to disassemble the file and extract the contents you want.\n\nAs you noted, there are more files nested inside. Therefore your first step should be to parse the serialized stream to extract everything, then parse the contents of each class member (some of which are complete files, like the PDF and PKP files).\n",
            "votes": "2",
            "user": "nneonneo",
            "time": "Jan 8, 2015 at 4:05",
            "is_accepted": true,
            "comments": [
                {
                    "user": "scott",
                    "text": "<span class=\"comment-copy\">Thank you for the insights! I have Visual Studio for Desktop installed, not familiar with it but would you be able to share your parser or list the steps to open the file in the dump format like yours?</span>",
                    "time": null
                },
                {
                    "user": "nneonneo",
                    "text": "<span class=\"comment-copy\">@scott: Sure thing; I have <a href=\"https://github.com/nneonneo/net-nrbf\" rel=\"nofollow noreferrer\">uploaded the code to GitHub</a>. Keep in mind I am only parsing a small subset of the format, enough only to show what I have above. You may need to extend it to work for the entire file.</span>",
                    "time": null
                },
                {
                    "user": "scott",
                    "text": "<span class=\"comment-copy\">Thank you! I hope the python script does make sense to me. :)</span>",
                    "time": null
                }
            ]
        },
        {
            "content": "Normally, i don't trust google searches for \"xyz file format\", because they return all sorts of unethical \"if you have an xyz file, download our registry cleaner here\" sites. But in this case, one of the links is http://extension.nirsoft.net/pkp, which claims that a .pkp file might be a visual studio packaging project - which actually sounds sensible given the content of the file. \nAlso, one of the strings in the file is the full path it once had: <pre><code>\\\\usa-home10\\home\\wes minner\\programming\\reviews\nec_1_548 [nec lt280]\\finished\nec_1_548_v\n1_0_0.pkp</code></pre>, and a lot of strings contain the company name Extron. Googling for <pre><code>wes minner extron</code></pre> finds this LinkedIn Profile of a guy whose job description is \"Device driver writing and reviewing in Python\".\nI suggest you try one of the following:\n\nget a copy of visual studio and check if it can import your file as a project file\nuse the LinkedIn Profile to contact the guy who created your file and ask him what type of file it is; this might yield better results than using one of the official channels of the company. \n\nSeems sometimes there are non-technical ways of reverse engineering as well ...\n",
            "votes": "1",
            "user": "Guntram Blohm",
            "time": "Jan 5, 2015 at 6:53",
            "is_accepted": false,
            "comments": [
                {
                    "user": "scott",
                    "text": "<span class=\"comment-copy\">Thanks Guntram for your extra pointer! I tried opening the file using Visual Studio but no luck, it just showed the same thing as when I open it using HexEdit. I suspect those chunks of code (python and PDF) were combined and packed using something that is unknown to me yet.</span>",
                    "time": null
                },
                {
                    "user": "scott",
                    "text": "<span class=\"comment-copy\">On your suggestion to contact the dev who made this, I will try that when I exhausted all my options. I am doubtful he will reply though because it looks to me that the driver is intended to be kept obscure to discourage amendment, else it would be in easy editable XML or JSON file with key value pairs of information. I might be wrong about this again.</span>",
                    "time": null
                }
            ]
        }
    ]
}