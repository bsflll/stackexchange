{
    "title": "How to read data from android.car.cluster",
    "link": "https://reverseengineering.stackexchange.com/questions/26930/how-to-read-data-from-android-car-cluster",
    "content": "While performing a vulnerability scan for open ports of an Android Automotive Infotainment system, I found out that port <pre><code>5151</code></pre> is open. Doing a <pre><code>netcat</code></pre> on the open port, reveals a continuous stream of unreadable data.\n<pre><code>kali:~$ nc 192.168.x.x 5151       //IP of infotainment system\n7ò”°R YJøOæÝ½9^çÆC€E†éÃºaI™íÐåY—\n...\n... \n</code></pre>\nHere is a link to the file that contains data read from the port : android-port-5151\nSince I had the root access to the Android system, I could find out that this data is related to <pre><code>android.car.cluster</code></pre>.\n<pre><code>console:/ # netstat -ltpu                                                  \nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program Name\ntcp6       0      0 :::pcrd                 :::*                    LISTEN      4473/android.car.cluster\n</code></pre>\nNow my question is, whether there is a way to read this data that is being pushed to the port <pre><code>5151</code></pre>.\nfor eg. some client application, that I can install on my Kali Machine to read the data on the port. I believe this data might include some critical information about cluster like speed readings, indicators, etc.\nAndroid version used : <pre><code>android-10.0.0_r20</code></pre>.\nKali Machine and Infotainment system are on the same local network.\n",
    "votes": "1",
    "answers": 1,
    "views": "283",
    "tags": [
        "android",
        "networking",
        "security",
        "unknown-data"
    ],
    "user": "gst",
    "time": "Feb 4, 2021 at 8:20",
    "comments": [
        {
            "user": "gst",
            "text": "@blabb Yes I know about the hex editor. But my real question is to how to make sense of this data. Since the data is from android.car.cluster, I believe there is a way to interpret the data that is being published. It could be some cluster related data, like speed readings, indicators, etc.\n",
            "time": null
        },
        {
            "user": "Robert",
            "text": "As long as the data is created by the AOSP part of <pre><code>android.car.cluster</code></pre> it may be easier to check the source code of the app and it's Java/native libraries where a TCP socket is opened and what data is provided. Also download the apk from the head unit if you have adb access and reverse it and compare it if it has been extended by the car/head unit manufacturer with additional proprietary code.\n",
            "time": null
        },
        {
            "user": "blabb",
            "text": "i just googled port 5151 car cluster and it seems there is some info out there\n",
            "time": null
        },
        {
            "user": "pythonpython",
            "text": "So streaming video with some codec? That would explain the netcat result.\n",
            "time": null
        }
    ],
    "answers_data": [
        {
            "content": "I'm going to guess this is MPEG Streaming of some manner.\nHere's what <pre><code>file</code></pre> run at various byte offsets into the first 10k bytes of the file produces:\n<pre><code>598 /dev/stdin: MPEG-4 LOAS, 4 or more streams, 8 or more streams\n838 /dev/stdin: MPEG-4 LOAS\n1232 /dev/stdin: MPEG-4 LOAS\n1696 /dev/stdin: MPEG sequence, H.264 video, baseline @ L 31\n3204 /dev/stdin: MPEG ADTS, AAC, v4 Main, 96 kHz, surround + LFE\n3220 /dev/stdin: MPEG ADTS, layer II, v2, 144 kbps, 16 kHz, Monaural\n3433 /dev/stdin: MPEG ADTS, layer II, v1, 44.1 kHz, JntStereo\n4889 /dev/stdin: MPEG ADTS, AAC, v4 Main, 88.2 kHz, surround + LFE\n5465 /dev/stdin: MPEG ADTS, layer III, v2,   8 kbps, 22.05 kHz, 2x Monaural\n5700 /dev/stdin: MPEG ADTS, AAC, v4 SSR, 88.2 kHz, stereo\n5722 /dev/stdin: MPEG ADTS, layer II, v1,  32 kbps, 48 kHz, 2x Monaural\n6035 /dev/stdin: MPEG ADTS, AAC, v4 Main, 44.1 kHz, stereo+center+LFE\n6207 /dev/stdin: MPEG ADTS, AAC, v2 Main, 64 kHz, surround\n6543 /dev/stdin: MPEG ADTS, AAC, v2, 22.05 kHz, stereo+center+LFE\n6790 /dev/stdin: MPEG ADTS, AAC, v4 SSR, stereo + center\n8039 /dev/stdin: MPEG ADTS, layer II, v1, 48 kHz, 2x Monaural\n8683 /dev/stdin: MPEG ADTS, layer III, v1, 112 kbps, 32 kHz, Stereo\n9296 /dev/stdin: MPEG-4 LOAS\n</code></pre>\nShell Scripted:\n<pre><code>#!/bin/bash\nFILE=$1\nfor I in {1..10000}\ndo\n    RES=`tail -c \"+$I\" \"$FILE\" | file -`\n    echo \"$I $RES\"\ndone\n\n</code></pre>\nHere's everything it found:\n<pre><code>3 /dev/stdin: raw G3 (Group 3) FAX, byte-padded\n7 /dev/stdin: SVR2 pure executable (USS/370)\n10 /dev/stdin: DOS executable (COM, 0x8C-variant)\n33 /dev/stdin: QDOS object '?z_???/??M?U?/?\\????|?~Ru????U?/?}[??7?*?\naC<x??'?EI?Y'\n45 /dev/stdin: DOS executable (COM)\n75 /dev/stdin: PGP Secret Sub-key -\n103 /dev/stdin: PGP Secret Key -\n110 /dev/stdin: DOS executable (COM)\n111 /dev/stdin: zlib compressed data\n151 /dev/stdin: PGP symmetric key encrypted data -\n242 /dev/stdin: DOS executable (COM)\n253 /dev/stdin: PGP Secret Sub-key -\n265 /dev/stdin: amd 29k coff noprebar executable\n343 /dev/stdin: DOS executable (COM, 0x8C-variant)\n384 /dev/stdin: DOS executable (COM, 0x8C-variant)\n396 /dev/stdin: COM executable for DOS\n490 /dev/stdin: PGP key public ring (v0) created Sat Jun 11 06:16:17 1977, 4742 days valid invalid (67) 1337 bits MPI=0xb28d1ec6effb04c5...\n573 /dev/stdin: PRCS packaged project\n596 /dev/stdin: zlib compressed data\n598 /dev/stdin: MPEG-4 LOAS, 4 or more streams, 8 or more streams\n621 /dev/stdin: COM executable for DOS\n638 /dev/stdin: DOS executable (COM, 0x8C-variant)\n682 /dev/stdin: DOS executable (COM)\n718 /dev/stdin: PGP Secret Key -\n723 /dev/stdin: SysEx File - PalmTree\n725 /dev/stdin: PGP Secret Key -\n734 /dev/stdin: COM executable for DOS\n737 /dev/stdin: PGP Secret Key -\n775 /dev/stdin: COM executable for DOS\n788 /dev/stdin: DOS executable (COM)\n823 /dev/stdin: COM executable for DOS\n838 /dev/stdin: MPEG-4 LOAS\n840 /dev/stdin: COM executable for DOS\n929 /dev/stdin: PGP Secret Key -\n940 /dev/stdin: PPMN archive data\n946 /dev/stdin: DOS executable (COM)\n954 /dev/stdin: DOS executable (COM)\n969 /dev/stdin: lif file\n973 /dev/stdin: DOS executable (COM)\n982 /dev/stdin: Encore unsupported executable\n1033 /dev/stdin: mc68k COFF object\n1124 /dev/stdin: COM executable for DOS\n1146 /dev/stdin: PGP Secret Sub-key -\n1210 /dev/stdin: PGP Secret Key -\n1232 /dev/stdin: MPEG-4 LOAS\n1280 /dev/stdin: PARIX executable\n1291 /dev/stdin: executable (RISC System/6000 V3.1) or obj module not stripped\n1331 /dev/stdin: PGP Secret Key -\n1358 /dev/stdin: COM executable for DOS\n1386 /dev/stdin: QDOS object '??????8C???1??a?_?^???M|????!??8??қ?a?'\n1428 /dev/stdin: COM executable for DOS\n1446 /dev/stdin: zlib compressed data\n1465 /dev/stdin: DOS executable (COM)\n1484 /dev/stdin: COM executable for DOS\n1534 /dev/stdin: SysEx File -\n1630 /dev/stdin: Sky archive data\n1639 /dev/stdin: TTComp archive, binary, 4K dictionary\n1677 /dev/stdin: DOS executable (COM)\n1686 /dev/stdin: Dyalog APL component file 32-bit level 2 journaled checksummed version 248.19\n1695 /dev/stdin: JVT NAL sequence, H.264 video, baseline @ L 31\n1696 /dev/stdin: MPEG sequence, H.264 video, baseline @ L 31\n1697 /dev/stdin: raw G3 (Group 3) FAX, byte-padded\n1704 /dev/stdin: MIPSEB MIPS-III ECOFF executable not stripped - version 0.1\n1707 /dev/stdin: DOS executable (COM)\n1711 /dev/stdin: zlib compressed data\n1726 /dev/stdin: raw G3 (Group 3) FAX, byte-padded\n1729 /dev/stdin: COM executable for DOS\n1833 /dev/stdin: DOS executable (COM, 0x8C-variant)\n1899 /dev/stdin: MIPSEB-LE MIPS-III ECOFF executable - version 107.107\n2017 /dev/stdin: MS-DOS executable\n2118 /dev/stdin: DOS executable (COM)\n2378 /dev/stdin: Minix filesystem, V1, 30 char names (big endian), 10256 zones\n2414 /dev/stdin: Minix filesystem, V1, 30 char names, 4681 zones\n2478 /dev/stdin: PGP Secret Key -\n2943 /dev/stdin: DOS executable (COM)\n2958 /dev/stdin: DOS executable (COM)\n3115 /dev/stdin: DOS executable (COM)\n3194 /dev/stdin: TeX font metric data (v????)\n3204 /dev/stdin: MPEG ADTS, AAC, v4 Main, 96 kHz, surround + LFE\n3205 /dev/stdin: SysEx File - OctavePlateau\n3220 /dev/stdin: MPEG ADTS, layer II, v2, 144 kbps, 16 kHz, Monaural\n3231 /dev/stdin: TeX font metric data (??>?3    f\n                                                 A????P)\n3289 /dev/stdin: PGP Secret Sub-key -\n3355 /dev/stdin: DOS executable (COM, 0x8C-variant)\n3367 /dev/stdin: PGP Secret Key -\n3400 /dev/stdin: DOS executable (COM, 0x8C-variant)\n3406 /dev/stdin: SysEx File -\n3425 /dev/stdin: DOS executable (COM, 0x8C-variant)\n3430 /dev/stdin: DOS executable (COM, 0x8C-variant)\n3433 /dev/stdin: MPEG ADTS, layer II, v1, 44.1 kHz, JntStereo\n3468 /dev/stdin: VAX COFF executable\n3469 /dev/stdin: Tower32/600/400 68020 object\n3569 /dev/stdin: SysEx File - Moog\n3577 /dev/stdin: COM executable for DOS\n3579 /dev/stdin: SysEx File - Sequential\n3687 /dev/stdin: COM executable for DOS\n3698 /dev/stdin: DOS executable (COM, 0x8C-variant)\n3703 /dev/stdin: SysEx File - Sequential\n3769 /dev/stdin: Atari 68xxx CPX file (version ec7f)\n3814 /dev/stdin: DOS executable (COM)\n3838 /dev/stdin: COM executable for DOS\n3849 /dev/stdin: TTComp archive, binary, 4K dictionary\n3855 /dev/stdin: PGP Secret Key -\n3914 /dev/stdin: PGP Secret Sub-key -\n3926 /dev/stdin: SysEx File - IDP\n3970 /dev/stdin: COM executable for DOS\n3995 /dev/stdin: PDP-11 UNIX/RT ldp\n4010 /dev/stdin: 370 sysV pure executable\n4142 /dev/stdin: SysEx File - Sequential\n4143 /dev/stdin: Tower/XP rel 2 object not stripped\n4197 /dev/stdin: MS Windows COFF Motorola 68000 object file\n4201 /dev/stdin: COM executable for DOS\n4216 /dev/stdin: DOS executable (COM, 0x8C-variant)\n4218 /dev/stdin: PGP Secret Key -\n4246 /dev/stdin: PDP-11 overlaid pure executable not stripped\n4263 /dev/stdin: PGP Secret Sub-key -\n4287 /dev/stdin: SysEx File - ADA\n4294 /dev/stdin: DOS executable (COM, 0x8C-variant)\n4370 /dev/stdin: PGP Secret Key -\n4409 /dev/stdin: DOS executable (COM)\n4410 /dev/stdin: DOS executable (COM)\n4418 /dev/stdin: 0421 Alliant compact executable common library\n4450 /dev/stdin: PGP Secret Key -\n4482 /dev/stdin: COM executable for DOS\n4511 /dev/stdin: COM executable for DOS\n4572 /dev/stdin: Solitaire Image Recorder format\n4578 /dev/stdin: DOS executable (COM)\n4589 /dev/stdin: COM executable for DOS\n4606 /dev/stdin: SysEx File - Kurzweil/Future Retro, Channel 59\n4630 /dev/stdin: PGP Secret Key -\n4696 /dev/stdin: DOS executable (COM, 0x8C-variant)\n4700 /dev/stdin: Dyalog APL version 1.5\n4702 /dev/stdin: ctab data\n4780 /dev/stdin: BS image, Version 33642, Quantization 35004, (Decompresses to 36657 words)\n4889 /dev/stdin: MPEG ADTS, AAC, v4 Main, 88.2 kHz, surround + LFE\n4934 /dev/stdin: SysEx File - Fender\n4954 /dev/stdin: DOS executable (COM)\n5064 /dev/stdin: SysEx File - Gulbransen\n5220 /dev/stdin: DOS executable (COM, 0x8C-variant)\n5254 /dev/stdin: SVr2 curses screen image, little-endian\n5267 /dev/stdin: PGP Secret Key -\n5281 /dev/stdin: DOS executable (COM, 0x8C-variant)\n5300 /dev/stdin: DOS executable (COM, 0x8C-variant)\n5301 /dev/stdin: DOS executable (COM, 0x8C-variant)\n5333 /dev/stdin: COM executable for DOS\n5397 /dev/stdin: hp200 (68010) BSD\n5465 /dev/stdin: MPEG ADTS, layer III, v2,   8 kbps, 22.05 kHz, 2x Monaural\n5505 /dev/stdin: COM executable for DOS\n5510 /dev/stdin: MySQL table definition file Version 31, MySQL version -1402753788\n5608 /dev/stdin: byte-swapped Berkeley vfont data\n5638 /dev/stdin: DOS executable (COM, 0x8C-variant)\n5656 /dev/stdin: DOS executable (COM)\n5682 /dev/stdin: DOS executable (COM)\n5695 /dev/stdin: SysEx File -\n5700 /dev/stdin: MPEG ADTS, AAC, v4 SSR, 88.2 kHz, stereo\n5712 /dev/stdin: DOS executable (COM, 0x8C-variant)\n5722 /dev/stdin: MPEG ADTS, layer II, v1,  32 kbps, 48 kHz, 2x Monaural\n5728 /dev/stdin: SysEx File - Kawai\n5742 /dev/stdin: squeezed data, original name G??`g(??1`ﮉ:E??ejc?\n5787 /dev/stdin: SysEx File -\n5798 /dev/stdin: PARIX executable\n5812 /dev/stdin: floppy image data (IBM SaveDskF, old)\n5830 /dev/stdin: executable (RISC System/6000 V3.1) or obj module\n5874 /dev/stdin: PGP Secret Sub-key -\n5880 /dev/stdin: DOS executable (COM)\n5882 /dev/stdin: SVR2 pure executable (Amdahl-UTS) not stripped - version 280614372\n5913 /dev/stdin: PGP Secret Sub-key -\n5942 /dev/stdin: COM executable for DOS\n5982 /dev/stdin: COM executable for MS-DOS\n5989 /dev/stdin: COM executable for MS-DOS\n5994 /dev/stdin: COM executable for MS-DOS\n5999 /dev/stdin: COM executable for DOS\n6000 /dev/stdin: MIPSEB-LE ECOFF executable - version 150.146\n6002 /dev/stdin: COM executable for DOS\n6005 /dev/stdin: COM executable for DOS\n6007 /dev/stdin: COM executable for DOS\n6008 /dev/stdin: COM executable for DOS\n6010 /dev/stdin: COM executable for DOS\n6021 /dev/stdin: DOS executable (COM, 0x8C-variant)\n6035 /dev/stdin: MPEG ADTS, AAC, v4 Main, 44.1 kHz, stereo+center+LFE\n6112 /dev/stdin: PGP Secret Key -\n6207 /dev/stdin: MPEG ADTS, AAC, v2 Main, 64 kHz, surround\n6214 /dev/stdin: DOS executable (COM, 0x8C-variant)\n6230 /dev/stdin: DOS executable (COM, 0x8C-variant)\n6265 /dev/stdin: COM executable for DOS\n6321 /dev/stdin: MS Windows COFF PA-RISC object file\n6346 /dev/stdin: DOS executable (COM)\n6347 /dev/stdin: DOS executable (COM)\n6380 /dev/stdin: COM executable for DOS\n6408 /dev/stdin: PGP symmetric key encrypted data - Blowfish (128 bit key, 16 rounds)\n6441 /dev/stdin: SysEx File - Clavia\n6470 /dev/stdin: PGP Secret Sub-key -\n6543 /dev/stdin: MPEG ADTS, AAC, v2, 22.05 kHz, stereo+center+LFE\n6564 /dev/stdin: DOS executable (COM)\n6653 /dev/stdin: DOS executable (COM, 0x8C-variant)\n6684 /dev/stdin: Tower32/800 68010 compatible object object not stripped\n6724 /dev/stdin: SysEx File - Baldwin\n6731 /dev/stdin: DOS executable (COM)\n6790 /dev/stdin: MPEG ADTS, AAC, v4 SSR, stereo + center\n6795 /dev/stdin: DOS executable (COM, 0x8C-variant)\n6797 /dev/stdin: DOS executable (COM, 0x8C-variant)\n6799 /dev/stdin: DOS executable (COM, 0x8C-variant)\n6852 /dev/stdin: PGP Secret Sub-key -\n6941 /dev/stdin: OS9/68K module: re-entrant ghost system-state\n6980 /dev/stdin: DOS executable (COM)\n6985 /dev/stdin: DOS executable (COM, 0x8C-variant)\n7018 /dev/stdin: PGP Secret Sub-key -\n7028 /dev/stdin: VISX image file\n7044 /dev/stdin: DOS executable (COM)\n7067 /dev/stdin: DOS executable (COM)\n7192 /dev/stdin: DOS executable (COM, 0x8C-variant)\n7221 /dev/stdin: PARIX object\n7354 /dev/stdin: PGP Secret Sub-key -\n7373 /dev/stdin: PGP Secret Sub-key -\n7538 /dev/stdin: DOS executable (COM)\n7539 /dev/stdin: DOS executable (COM)\n7659 /dev/stdin: SYMMETRY i386 .o\n7735 /dev/stdin: COM executable for DOS\n7935 /dev/stdin: zlib compressed data\n8011 /dev/stdin: Atari MSA archive data, 63152 sectors per track, starting track: 46999, ending track: 5759\n8018 /dev/stdin: PGP Secret Sub-key -\n8033 /dev/stdin: AIX core file fulldump\n8039 /dev/stdin: MPEG ADTS, layer II, v1, 48 kHz, 2x Monaural\n8050 /dev/stdin: PGP Secret Sub-key -\n8077 /dev/stdin: COM executable for DOS\n8098 /dev/stdin: zlib compressed data\n8110 /dev/stdin: PGP Secret Sub-key -\n8338 /dev/stdin: COM executable for DOS\n8347 /dev/stdin: PGP Secret Key -\n8352 /dev/stdin: PGP Secret Sub-key -\n8382 /dev/stdin: PGP Secret Key -\n8429 /dev/stdin: PGP Secret Sub-key -\n8442 /dev/stdin: COM executable for DOS\n8550 /dev/stdin: PGP Secret Sub-key -\n8561 /dev/stdin: DOS executable (COM)\n8683 /dev/stdin: MPEG ADTS, layer III, v1, 112 kbps, 32 kHz, Stereo\n8727 /dev/stdin: SysEx File - Clarity\n8729 /dev/stdin: DOS executable (COM, 0x8C-variant)\n8734 /dev/stdin: Intel ia64 COFF object file, not stripped, 23296 sections, symbol offset=0x911b1400, 1284708587 symbols, optional header size 57568\n8738 /dev/stdin: SysEx File -\n8742 /dev/stdin: raw G3 (Group 3) FAX\n8746 /dev/stdin: DOS executable (COM)\n8754 /dev/stdin: PDP-11 UNIX/RT ldp\n8755 /dev/stdin: MIPSEB Ucode\n8764 /dev/stdin: MIPSEL-BE Ucode\n8766 /dev/stdin: Intel ia64 COFF object file, stripped, 57560 sections, symbol offset=0x813b142f, -1778167612 symbols, optional header size 32856\n8767 /dev/stdin: GeoSwath RDF\n8769 /dev/stdin: Targa image data - Color 22678 x 14464 x 1 +50305 +848 - 4-bit alpha - top - right - reserved \"B??3@|?q`\"\n8780 /dev/stdin: little endian ispell hash file (?), and 312 string characters\n8831 /dev/stdin: QDOS object 'y)??r????D??-E#<??M?xs??G?'\n8868 /dev/stdin: PGP Secret Sub-key -\n8895 /dev/stdin: SysEx File -\n8900 /dev/stdin: COM executable for DOS\n8916 /dev/stdin: PGP Secret Sub-key -\n8918 /dev/stdin: DOS executable (COM, 0x8C-variant)\n8931 /dev/stdin: PGP Secret Sub-key -\n8932 /dev/stdin: iAPX 286 executable large model (COFF) not stripped\n8988 /dev/stdin: basic-16 executable not stripped\n8999 /dev/stdin: PGP symmetric key encrypted data -\n9109 /dev/stdin: DOS executable (COM, 0x8C-variant)\n9186 /dev/stdin: PGP Secret Key -\n9215 /dev/stdin: DOS executable (COM, 0x8C-variant)\n9245 /dev/stdin: SysEx File - Eventide\n9248 /dev/stdin: lif file\n9275 /dev/stdin: PGP Secret Sub-key -\n9292 /dev/stdin: PGP Secret Sub-key -\n9296 /dev/stdin: MPEG-4 LOAS\n9356 /dev/stdin: DOS executable (COM)\n9366 /dev/stdin: DOS executable (COM, 0x8C-variant)\n9373 /dev/stdin: SysEx File -\n9480 /dev/stdin: DOS executable (COM, 0x8C-variant)\n9496 /dev/stdin: DOS executable (COM, 0x8C-variant)\n9547 /dev/stdin: DOS executable (COM)\n9552 /dev/stdin: DOS executable (COM, 0x8C-variant)\n9555 /dev/stdin: PGP Secret Key -\n9589 /dev/stdin: PGP Secret Key -\n9607 /dev/stdin: COM executable for DOS\n9696 /dev/stdin: PGP Secret Key -\n9742 /dev/stdin: ID tags data version 3710\n9763 /dev/stdin: Dyalog APL component file 64-bit level 1 journaled checksummed version 204.112\n9787 /dev/stdin: Targa image data 24628 x 8654 x 15 +49152 +15116 - 3-bit alpha - top - interleave \"??ƀ6?????).??\n                                                                                                                 ,?7?=??}&ɍ??O?\n                                                                                                                               ?&??''''?)@?P?A??'??^??l??(??gxm??K?j?&x?M??$?@Lt ??D\"\n</code></pre>\n",
            "votes": "1",
            "user": "pythonpython",
            "time": "Feb 4, 2021 at 16:02",
            "is_accepted": false,
            "comments": [
                {
                    "user": "gst",
                    "text": "<span class=\"comment-copy\">Unfortunately, there are no CAN related devices connected to it, neither is a CAN application running on the same.</span>",
                    "time": null
                },
                {
                    "user": "gst",
                    "text": "<span class=\"comment-copy\">can you share the exact command/tool that you used to extract the information.</span>",
                    "time": null
                }
            ]
        }
    ]
}