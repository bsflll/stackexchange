{
    "title": "Cocos2d xxtea game lua decrypt",
    "link": "https://reverseengineering.stackexchange.com/questions/28017/cocos2d-xxtea-game-lua-decrypt",
    "content": "How can I use the 16 byte xxtea byte as python\nI found the password directly but I want to change the bytecode of the password with 16 bytes as in the picture\n\n<pre><code>_BYTE *__fastcall sub_D4CA64(__int64 a1, unsigned int a2, __int64 a3, _DWORD *a4)\n{\n  unsigned int v4; // w25\n  unsigned int v5; // w27\n  int v6; // w22\n  _BOOL4 v11; // w26\n  _DWORD *v12; // x20\n  __int64 v13; // x8\n  __int64 v14; // x9\n  __int64 v15; // x13\n  char v16; // w12\n  int v17; // w11\n  _QWORD *v18; // x0\n  _DWORD *v19; // x21\n  int v20; // w8\n  __int64 v21; // x9\n  int v22; // w10\n  __int64 v23; // x12\n  int v24; // w10\n  __int64 v25; // x8\n  unsigned int v26; // w9\n  unsigned int v27; // w12\n  unsigned int v28; // w13\n  __int64 v29; // x14\n  __int64 v30; // x15\n  unsigned int v31; // w16\n  int v32; // w0\n  __int64 v33; // x1\n  int v34; // w16\n  int v35; // w17\n  __int64 v36; // x24\n  _BYTE *v37; // x23\n  _BYTE *v38; // x0\n  __int64 v39; // x8\n  __int64 v40; // x8\n  int v41; // w9\n  __int64 v42; // x10\n  unsigned int v43; // w11\n  _BYTE *v44; // x13\n  unsigned int v45; // w12\n  unsigned int v46; // w11\n  int v47; // w9\n  char v48; // w11\n\n  v4 = a2 >> 2;\n  if ( (a2 & 3) != 0 )\n    v5 = v4 + 1;\n  else\n    v5 = a2 >> 2;\n  v6 = 4 * v5;\n  v11 = (a2 & 3) != 0;\n  v12 = malloc(4 * v5);\n  memset(v12, 0, 4 * v5);\n  if ( a2 )\n  {\n    v13 = 0LL;\n    v14 = 0LL;\n    do\n    {\n      v15 = (unsigned int)v14 >> 2;\n      v16 = v13 & 0x18;\n      v13 += 8LL;\n      v17 = (*(unsigned __int8 *)(a1 + v14++) << v16) | v12[v15];\n      v12[v15] = v17;\n    }\n    while ( 8LL * a2 != v13 );\n  }\n  v18 = malloc(0x10u);\n  v19 = v18;\n  v20 = 0;\n  v21 = 0LL;\n  *v18 = 0LL;\n  v18[1] = 0LL;\n  do\n  {\n    v22 = *(unsigned __int8 *)(a3 + v21);\n    v23 = 4LL * ((unsigned int)v21++ >> 2);\n    v24 = (v22 << (v20 & 0x18)) | *(_DWORD *)((char *)v18 + v23);\n    v20 += 8;\n    *(_DWORD *)((char *)v18 + v23) = v24;\n  }\n  while ( v21 != 16 );\n  v25 = v5 - 1;\n  if ( v5 != 1 )\n  {\n    v26 = -1640531527 * (0x34 / v5) - 1253254570;\n    if ( -1640531527 * (0x34 / v5) != 1253254570 )\n    {\n      v27 = *v12;\n      do\n      {\n        v28 = (v26 >> 2) & 3;\n        v29 = v4 + v11 - 2;\n        v30 = v5 - 1;\n        do\n        {\n          v31 = v12[v29];\n          v32 = ((v31 >> 5) ^ (4 * v27)) + ((16 * v31) ^ (v27 >> 3));\n          v33 = v30;\n          v34 = v19[v30 & 3 ^ v28] ^ v31;\n          v35 = v12[v30--];\n          v27 = v35 - (v32 ^ (v34 + (v27 ^ v26)));\n          --v29;\n          v12[v33] = v27;\n        }\n        while ( (_DWORD)v30 );\n        v27 = *v12\n            - ((((v12[v25] >> 5) ^ (4 * v27)) + ((16 * v12[v25]) ^ (v27 >> 3))) ^ ((v19[v28] ^ v12[v25]) + (v27 ^ v26)));\n        v26 += 1640531527;\n        *v12 = v27;\n      }\n      while ( v26 );\n    }\n  }\n  v36 = (unsigned int)v12[v25];\n  v37 = 0LL;\n  if ( (unsigned int)v36 >= v6 - 7 && (unsigned int)v36 <= v6 - 4 )\n  {\n    v38 = malloc((int)v36 + 1);\n    v37 = v38;\n    if ( !(_DWORD)v36 )\n    {\n      v40 = 0LL;\nLABEL_27:\n      v38[v40] = 0;\n      *a4 = v36;\n      goto LABEL_28;\n    }\n    if ( (_DWORD)v36 == 1 )\n    {\n      v39 = 0LL;\n    }\n    else\n    {\n      v41 = 0;\n      v42 = 0LL;\n      v39 = (unsigned int)v36 & 0xFFFFFFFE;\n      do\n      {\n        v43 = v12[(unsigned int)v42 >> 2];\n        v44 = &v38[v42];\n        v42 += 2LL;\n        v45 = v43 >> (v41 & 0x10);\n        v46 = v43 >> (v41 & 0x10 | 8);\n        v41 += 16;\n        *v44 = v45;\n        v44[1] = v46;\n      }\n      while ( v39 != v42 );\n      if ( v39 == v36 )\n        goto LABEL_26;\n    }\n    v47 = 8 * v39;\n    do\n    {\n      v48 = v47 & 0x18;\n      v47 += 8;\n      v38[v39] = v12[(unsigned int)v39 >> 2] >> v48;\n      ++v39;\n    }\n    while ( v36 != v39 );\nLABEL_26:\n    v40 = v36;\n    goto LABEL_27;\n  }\nLABEL_28:\n  free(v12);\n  free(v19);\n  return v37;\n}\n</code></pre>\n",
    "votes": "1",
    "answers": 0,
    "views": "510",
    "tags": [
        "decryption"
    ],
    "user": "sessizbyu",
    "time": "Jul 24, 2021 at 21:57",
    "comments": [
        {
            "user": "sessizbyu",
            "text": "up please please help me with this i really need it\n",
            "time": null
        }
    ],
    "answers_data": []
}