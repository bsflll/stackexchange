{
    "title": "reversing stripped & statically linked binary with radare2",
    "link": "https://reverseengineering.stackexchange.com/questions/16355/reversing-stripped-statically-linked-binary-with-radare2",
    "content": "As the question says I need to reverse a stripped elf binary with <pre><code>radare2</code></pre>. This binary is also statically linked. I already reversed it in IDA by identifying statically linked libraries using <pre><code>lscan</code></pre> and importing the <pre><code>.sig</code></pre> files provided by <pre><code>lscan</code></pre> into IDA in order to resolve function names.  \nI don't know how to import these files to <pre><code>radare2</code></pre>. Also I don't know if the same solution applies to <pre><code>radare2</code></pre>.\n",
    "votes": "1",
    "answers": 1,
    "views": "4k",
    "tags": [
        "binary-analysis",
        "elf",
        "radare2"
    ],
    "user": "rustam Shirinov",
    "time": "Sep 17, 2017 at 8:33",
    "comments": [],
    "answers_data": [
        {
            "content": "Seems like <pre><code>lscan</code></pre> is written to work with <pre><code>IDA</code></pre>. However, <pre><code>lscan</code></pre> is based on <pre><code>FLIRT</code></pre> signature files which can be also read by radare2 (See the Zignatures section of this answer). There are several things you can do with <pre><code>radare2</code></pre> to achieve similar results:\nImport IDA databases to radare2\nYou can easily import IDC and IDB files from IDA to radare2 using a simple scripts which exists in radare2ida repository.\n\nThis repository contains a collection of documents, scripts and\n  utilities that will allow you to use IDA and R2, converting projects\n  metadata from one tool to the other and providing tools to integrate\n  them in a more useful way.\n\nExport from IDA \nTo export IDA database to IDC file click on <pre><code>File >> Produce file >> Dump databse to IDC file...</code></pre>\nTo save the current databse as an IDB file click <pre><code>File >> Take database snapshot...</code></pre> or use the shortcut Ctrl+Shift+W\nImport to Radare2\nTo import the IDC metadata to radare2 use idc2r.py which shipped with <pre><code>radare2ida</code></pre>:   \n<pre><code>idc2r.py file.idc > file.r2\n</code></pre>\nThe command reads an IDC file exported from an IDA Pro database and produces an r2 script containing the same comments, names of functions etc. You can import the resulting <pre><code>file.r2</code></pre> by using the dot <pre><code>.</code></pre> command of radare:  \n<pre><code>[0x00000000]> . file.r2\n</code></pre>\nThe <pre><code>.</code></pre> command is used to interpret radare commands from external sources, including files and program output. For example, to omit generation of an intermediate file and import the script directly you can use this combination:\n<pre><code>[0x00000000]> .!idc2r.py < file.idc\n</code></pre>\nZignatures\nradare2 has its own format of the signatures called <pre><code>Zignatures</code></pre>, allowing to both load/apply and create signatures on the fly. They are available under the <pre><code>z</code></pre> command namespace:\n<pre><code>[0x00000000]> z?\n|Usage: z[*j-aof/cs] [args] # Manage zignatures\n| z            show zignatures\n| z*           show zignatures in radare format\n| zj           show zignatures in json format\n| z-zignature  delete zignature\n| z-*          delete all zignatures\n| za[?]        add zignature\n| zo[?]        manage zignature files\n| zf[?]        manage FLIRT signatures\n| z/[?]        search zignatures\n| zc           check zignatures at address\n| zs[?]        manage zignspaces\n</code></pre>\nThe <pre><code>zf</code></pre> subcommands can be handy whenever you deal with FLIRT signatures. Therefore you can import FLIRT signatures from a file:\n<pre><code>[0x00000000]> zf?\n|Usage: zf[dsz] filename # Manage FLIRT signatures\n| zfd filename  open FLIRT file and dump\n| zfs filename  open FLIRT file and scan\n| zfz filename  open FLIRT file and get sig commands (zfz flirt_file > zignatures.sig)\n</code></pre>\nRegardless of FLIRT, you can also use <pre><code>zos [filename]</code></pre> from radare2 to dump signatures to a sdb file and <pre><code>zo [filename]</code></pre> to load it.\nSource Code\nAs similar to <pre><code>list</code></pre> command of <pre><code>dgb</code></pre>, radare allows you to print lines from a source code file. Here's an example:\n<pre><code>$ gcc -m32 -g megabeets.c -o megabeets.bin\n$ r2 megabeets.bin\n[0x08048420]> aa\n[x] Analyze all flags starting with sym. and entry0 (aa)\n[0x08048420]> s main\n[0x080486cd]> CL\nfile .//megabeets.c\nline 36\n  022\n  023  int main(int argc, char *argv[])\n> 024  {\n  025      char *input;\n  026      puts(\"Megabeets\n\");\n</code></pre>\n\nThe <pre><code>C</code></pre> command is used to manage comments and data conversions. You\n  can define a range of program's bytes to be interpreted as either\n  code, binary data or string. It is also possible to execute external\n  code at every specified flag location in order to fetch some metadata,\n  such as a comment, from an external file or database.\n\n\nTo know more I recommend you to read:\n\nAdding Metadata to Disassembly from radar2book \nZignatures chapter from radare2book\nThis post about Zignatures\nradare2 and flirt\nA community driven collection of IDA FLIRT signature files\n",
            "votes": "7",
            "user": "Megabeets",
            "time": "Sep 17, 2017 at 8:41",
            "is_accepted": true,
            "comments": []
        }
    ]
}