{
    "title": "UBIFS image weirdness [SOLVED]",
    "link": "https://reverseengineering.stackexchange.com/questions/32004/ubifs-image-weirdness-solved",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>So, I dumped old routers ubifs image from memory and apparently it can't be read or mounted, throwing errors like \"missing block size\" and \"missing data\" although I see in hexdump it is all there. I checked similar version of router someone else dumped the ubifs image of and mounting the image or reading from it works correctly. I tried <code>ubireader</code> and python script <code>ubidump</code> but nothing works. Should I dump the ubifs from router again or I assume EC header ought to have something to do with it?</p>\n<p>Image that works:</p>\n<pre><code>(base) josip@nela-computer:~/Documents/ubee/new router/images$ binwalk ~/projects/bcm2-dumps/evw32c/_bcm3384TP1_apps.bin_nand_ubifs_bs128k_ps2k.extracted/20000.ubi \n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             UBI erase count header, version: 1, EC: 0x4, VID header offset: 0x800, data offset: 0x1000\n\n(base) josip@nela-computer:~$ hexdump -n 1024 ~/projects/bcm2-dumps/evw32c/_bcm3384TP1_apps.bin_nand_ubifs_bs128k_ps2k.extracted/20000.ubi \n0000000 4255 2349 0001 0000 0000 0000 0000 0400\n0000010 0000 0008 0000 0010 0000 0000 0000 0000\n0000020 0000 0000 0000 0000 0000 0000 0000 0000\n0000030 0000 0000 0000 0000 0000 0000 053f a6d0\n0000040 0000 0000 0000 0000 0000 0000 0000 0000\n*\n0000400\n</code></pre>\n<p>Image that don't:</p>\n<pre><code>(base) josip@nela-computer:~/Documents/ubee/new router/images$ binwalk _output_image3e_linuxapps.bin.extracted/20000.ubi \n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             UBI erase count header, version: 1, EC: 0x2, VID header offset: 0x800, data offset: 0x1000\n\n(base) josip@nela-computer:~$ hexdump -n 1024 ~/Documents/ubee/new router/images/_output_image3e_linuxapps.bin.extracted/20000.ubi \n0000000 4255 2349 0001 0000 0000 0000 0000 0200\n0000010 0000 0008 0000 0010 0000 0000 0000 0000\n0000020 0000 0000 0000 0000 0000 0000 0000 0000\n0000030 0000 0000 0000 0000 0000 0000 9340 8c2d\n0000040 0000 0000 0000 0000 0000 0000 0000 0000\n*\n0000400\n</code></pre>\n<p><strong>EDIT:</strong>\nTurns out I just needed to dump the partition again as the first dump was with errors. The dump of ubifs works now and it shows files.</p>\n<pre><code>(ubifs) josip@nela-computer:~/Downloads/_linuxapps3.bin.extracted$ python ~/projects/ubidump/ubidump.py 20000.ubi -s ./\n==&gt; 20000.ubi &lt;==\n1 named volumes found, 2 physical volumes, blocksize=0x20000\n== volume b'linuxapps' ==\nsaved 52 files\n(ubifs) josip@nela-computer:~/Downloads/_linuxapps3.bin.extracted$ ls\n20000.ubi  linuxapps\n(ubifs) josip@nela-computer:~/Downloads/_linuxapps3.bin.extracted/linuxapps$ cat readme.txt \nThis is the Apps partition for 93383WVG.  Files copied into this directory \nwill be compressed and stored as a JFFS2 filesystem image in the target\n folder (93383LxG).  The final step of the build creates a downloadable bin file called \napps.bin, which can then be downloaded using the DOCSIS application.\n(ubifs) josip@nela-computer:~/Downloads/_linuxapps3.bin.extracted/linuxapps$ cat version.txt \n/home/allan/Linux/LxG171mp4_wifi/targets/3384TP1/apps.bin\nWed Sep 13 09:27:19 CST 2017\nroot@allan-Ubuntu14\ngcc version 4.2.3\nVersion: 1.7.1mp4\n</code></pre>\n</div>",
    "votes": "1",
    "answers": 0,
    "views": "137",
    "tags": [
        "memory",
        "router",
        "dump"
    ],
    "user": "Josip StjepanoviÄ‡",
    "time": "Jun 28, 2023 at 2:24",
    "comments": [],
    "answers_data": []
}