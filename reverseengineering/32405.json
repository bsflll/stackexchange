{
    "title": "Need Help Cracking a Program",
    "link": "https://reverseengineering.stackexchange.com/questions/32405/need-help-cracking-a-program",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>So I've got this <code>.exe</code> that I want to crack. It's an old management system for people in truck loading business.</p>\n<p>I kind of understand what's happening with window API calls but I'm unable to access the credentials that user inputs into the form. If somehow I could get access to that input, I might be able to find where this program takes this input to check against the valid serial keys.</p>\n<p>I've tried searching for strings, but no luck there as well.</p>\n<p>Hoping for some guidance.</p>\n<p>I'm using x64dbg to debug the code, and I followed couple tutorials on YouTube to get started. Most of them were easily able to crack the programs by using string search, but the strings that I want (ones in the registration window) don't show up in the search.</p>\n<p>I've tried setting up breakpoints, but those didn't work as well.</p>\n<p>Only thing I've seen related to the input (serial key) in the debugger so far are the values in the stack. When I start typing out the key, part of it (each of 4 characters) start appearing in the stack in this format, <code>L\"xxxx\"</code>. I tried checking logs, and pinpointed the thread that's responsible for carrying out registration. Last module calls that this program makes are to <code>CoreMessaging.dll</code> and <code>CoreUiComponents.dll</code>. There's also this <code>TextInputForm.dll</code>, that shows up in the stack, whenever I'm typing out the serial key.</p>\n<p>Here are the logs:</p>\n<pre><code>Breakpoint at 0111A00A (entry breakpoint) set!\nDLL Loaded: 77A80000 C:\\Windows\\SysWOW64\\ntdll.dll\nDLL Loaded: 71A40000 C:\\Windows\\SysWOW64\\mscoree.dll\nDLL Loaded: 76500000 C:\\Windows\\SysWOW64\\kernel32.dll\nDLL Loaded: 75F10000 C:\\Windows\\SysWOW64\\KernelBase.dll\nSystem breakpoint reached!\nDLL Loaded: 76B60000 C:\\Windows\\SysWOW64\\advapi32.dll\nDLL Loaded: 77460000 C:\\Windows\\SysWOW64\\msvcrt.dll\nThread 5744 created, Entry: ntdll.77ABCAC0, Parameter: 017E5C28\nDLL Loaded: 77240000 C:\\Windows\\SysWOW64\\sechost.dll\nDLL Loaded: 76BE0000 C:\\Windows\\SysWOW64\\rpcrt4.dll\nDLL Loaded: 719B0000 C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\mscoreei.dll\nDLL Loaded: 76D40000 C:\\Windows\\SysWOW64\\shlwapi.dll\nDLL Loaded: 72980000 C:\\Windows\\SysWOW64\\kernel.appcore.dll\nDLL Loaded: 719A0000 C:\\Windows\\SysWOW64\\version.dll\nDLL Loaded: 6F7E0000 C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\clr.dll\nDLL Loaded: 766E0000 C:\\Windows\\SysWOW64\\user32.dll\nDLL Loaded: 769D0000 C:\\Windows\\SysWOW64\\win32u.dll\nDLL Loaded: 76920000 C:\\Windows\\SysWOW64\\gdi32.dll\nDLL Loaded: 76A70000 C:\\Windows\\SysWOW64\\gdi32full.dll\nDLL Loaded: 71980000 C:\\Windows\\SysWOW64\\vcruntime140_clr0400.dll\nThread 5732 created, Entry: ntdll.77ABCAC0, Parameter: 017E5C28\nDLL Loaded: 76950000 C:\\Windows\\SysWOW64\\msvcp_win.dll\nDLL Loaded: 019E0000 C:\\Windows\\SysWOW64\\ucrtbase_clr0400.dll\nDLL Loaded: 718D0000 C:\\Windows\\SysWOW64\\ucrtbase_clr0400.dll\nDLL Loaded: 772C0000 C:\\Windows\\SysWOW64\\ucrtbase.dll\nDLL Unloaded: 019E0000 ucrtbase_clr0400.dll\nThread 2628 created, Entry: ntdll.77ABCAC0, Parameter: 017E5C28\nDLL Loaded: 75890000 C:\\Windows\\SysWOW64\\imm32.dll\nDLL Loaded: 76160000 C:\\Windows\\SysWOW64\\combase.dll\nDLL Unloaded: 76160000 combase.dll\nEXCEPTION_DEBUG_INFO:\n           dwFirstChance: 1\n           ExceptionCode: 04242420 (CLRDBG_NOTIFICATION_EXCEPTION_CODE)\n          ExceptionFlags: 00000000\n        ExceptionAddress: kernelbase.76048D52\n        NumberParameters: 3\nExceptionInformation[00]: 31415927\nExceptionInformation[01]: clr.6F7E0000\nExceptionInformation[02]: 014FF778\nFirst chance exception on 76048D52 (04242420, CLRDBG_NOTIFICATION_EXCEPTION_CODE)!\nDLL Loaded: 77450000 C:\\Windows\\SysWOW64\\psapi.dll\nThread 5440 created, Entry: clr.6F96B510, Parameter: 00000000\nThread 4228 created, Entry: clr.6F8D1090, Parameter: 01843F78\nDLL Loaded: 6E380000 C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\mscorlib\\faf93f57aa8c4c5dddd9cd0de441d5a1\\mscorlib.ni.dll\nDLL Loaded: 765F0000 C:\\Windows\\SysWOW64\\ole32.dll\nDLL Loaded: 76160000 C:\\Windows\\SysWOW64\\combase.dll\nDLL Loaded: 773E0000 C:\\Windows\\SysWOW64\\bcryptprimitives.dll\nDLL Loaded: 72900000 C:\\Windows\\SysWOW64\\uxtheme.dll\nDLL Loaded: 71840000 C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\clrjit.dll\nDLL Loaded: 77680000 C:\\Windows\\SysWOW64\\oleaut32.dll\nThread 7844 created, Entry: clr.6F8D1090, Parameter: 0185C1D8\nDLL Loaded: 71620000 C:\\Windows\\SysWOW64\\wldp.dll\nDLL Loaded: 71820000 C:\\Windows\\SysWOW64\\amsi.dll\nDLL Loaded: 70CF0000 C:\\Windows\\SysWOW64\\userenv.dll\nDLL Loaded: 75790000 C:\\Windows\\SysWOW64\\profapi.dll\nDLL Loaded: 70C80000 C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.23090.2008-0\\X86\\MpOAV.dll\nDLL Loaded: 70810000 C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.23090.2008-0\\X86\\MpClient.dll\nDLL Loaded: 763F0000 C:\\Windows\\SysWOW64\\crypt32.dll\nDLL Loaded: 769F0000 C:\\Windows\\SysWOW64\\wintrust.dll\nDLL Loaded: 75880000 C:\\Windows\\SysWOW64\\msasn1.dll\nDLL Loaded: 757E0000 C:\\Windows\\SysWOW64\\gpapi.dll\nThread 7464 created, Entry: ntdll.77ABCAC0, Parameter: 0189B5B8\nDLL Loaded: 6D920000 C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\System\\5c00af63074fbeb811ca3b6c1552ed20\\System.ni.dll\nDLL Loaded: 6D100000 C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\System.Core\\611f56c68c2c55b1d118f964dfdc6622\\System.Core.ni.dll\nDLL Loaded: 70700000 C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\System.Configuration\\e029a233012f92553fe6423c55cab701\\System.Configuration.ni.dll\nDLL Loaded: 70410000 C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\System.Drawing\\5b458af6b683d9b9449f798de5c10835\\System.Drawing.ni.dll\nDLL Loaded: 6C290000 C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\System.Windows.Forms\\daf04e26978e0023bf6e58858de15840\\System.Windows.Forms.ni.dll\nDLL Loaded: 01AE0000 C:\\Program Files (x86)\\Leotronic Scales Pvt. Ltd\\WeighPro\\WeighProSQL.DLL\nDLL Loaded: 05CF0000 C:\\Program Files (x86)\\Leotronic Scales Pvt. Ltd\\WeighPro\\WeighProSQL.DLL\nDLL Unloaded: 01AE0000 weighprosql.dll\nThread 6500 created, Entry: combase.7628AF70, Parameter: 018BD240\nThread 8280 created, Entry: ntdll.77ABCAC0, Parameter: 0184F798\nThread 7840 created, Entry: ntdll.77ABCAC0, Parameter: 0184F798\nDLL Loaded: 6BB10000 C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\System.Xml\\8942301a17f33b71c4ba78ae7eff3a07\\System.Xml.ni.dll\nDLL Loaded: 758D0000 C:\\Windows\\SysWOW64\\shell32.dll\nDLL Loaded: 729A0000 C:\\Windows\\SysWOW64\\windows.storage.dll\nSet hardware breakpoint on 777B6580!\nDLL Loaded: 77720000 C:\\Windows\\SysWOW64\\SHCore.dll\nDLL Loaded: 75800000 C:\\Windows\\SysWOW64\\bcrypt.dll\nDLL Loaded: 75860000 C:\\Windows\\SysWOW64\\cryptsp.dll\nDLL Loaded: 75830000 C:\\Windows\\SysWOW64\\rsaenh.dll\nDLL Loaded: 75820000 C:\\Windows\\SysWOW64\\cryptbase.dll\nDLL Loaded: 70BF0000 C:\\Windows\\WinSxS\\x86_microsoft.windows.common-controls_6595b64144ccf1df_5.82.20348.1_none_6a9207a4854d1923\\comctl32.dll\nDLL Loaded: 6B9A0000 C:\\Windows\\WinSxS\\x86_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.20348.1787_none_0d12da645dfca258\\GdiPlus.dll\nDLL Loaded: 6B780000 C:\\Windows\\SysWOW64\\DWrite.dll\nThread 6404 created, Entry: gdiplus.6BA167B0, Parameter: 06201408\nDLL Loaded: 77530000 C:\\Windows\\SysWOW64\\msctf.dll\nDLL Loaded: 72070000 C:\\Windows\\SysWOW64\\TextShaping.dll\nEXCEPTION_DEBUG_INFO:\n           dwFirstChance: 1\n           ExceptionCode: E06D7363 (CPP_EH_EXCEPTION)\n          ExceptionFlags: 00000001\n        ExceptionAddress: kernelbase.76048D52\n        NumberParameters: 3\nExceptionInformation[00]: 19930520\nExceptionInformation[01]: 014FD344\nExceptionInformation[02]: clr.6FFB0AE8\nFirst chance exception on 76048D52 (E06D7363, CPP_EH_EXCEPTION)!\nEXCEPTION_DEBUG_INFO:\n           dwFirstChance: 1\n           ExceptionCode: E06D7363 (CPP_EH_EXCEPTION)\n          ExceptionFlags: 00000001\n        ExceptionAddress: kernelbase.76048D52\n        NumberParameters: 3\nExceptionInformation[00]: 19930520\nExceptionInformation[01]: 00000000\nExceptionInformation[02]: 00000000\nFirst chance exception on 76048D52 (E06D7363, CPP_EH_EXCEPTION)!\nDLL Loaded: 75150000 C:\\Windows\\WinSxS\\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.20348.1_none_d0810af484aa16f0\\comctl32.dll\nThread 3292 created, Entry: clr.6F8D1090, Parameter: 018B38D0\nThread 6080 created, Entry: clr.6F812E80, Parameter: 00000000\nThread 1032 created, Entry: clr.6F8D1090, Parameter: 0698DA20\nDLL Loaded: 70940000 C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\System.Serv759bfb78#\\d413636e87f6d58ce36c6cc45cc291a4\\System.ServiceProcess.ni.dll\nDLL Loaded: 725D0000 C:\\Windows\\SysWOW64\\TextInputFramework.dll\nDLL Loaded: 6B650000 C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\System.Management\\8fbafc2bfab952b673db08298710f689\\System.Management.ni.dll\nDLL Loaded: 706D0000 C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\WMINet_Utils.dll\nDLL Loaded: 76890000 C:\\Windows\\SysWOW64\\clbcatq.dll\nDLL Loaded: 706B0000 C:\\Windows\\SysWOW64\\wbem\\wmiutils.dll\nDLL Loaded: 703A0000 C:\\Windows\\SysWOW64\\wbemcomn.dll\nThread 6080 exit\nDLL Loaded: 70BE0000 C:\\Windows\\SysWOW64\\wbem\\wbemprox.dll\nDLL Loaded: 70690000 C:\\Windows\\SysWOW64\\wbem\\wbemsvc.dll\nDLL Loaded: 6B580000 C:\\Windows\\SysWOW64\\wbem\\fastprox.dll\nEXCEPTION_DEBUG_INFO:\n           dwFirstChance: 1\n           ExceptionCode: C0000005 (EXCEPTION_ACCESS_VIOLATION)\n          ExceptionFlags: 00000000\n        ExceptionAddress: 01A3D1BC\n        NumberParameters: 2\nExceptionInformation[00]: 00000000 Read\nExceptionInformation[01]: 00000000 Inaccessible Address\nFirst chance exception on 01A3D1BC (C0000005, EXCEPTION_ACCESS_VIOLATION)!\nThread 7844 exit\nThread 1032 exit\nEXCEPTION_DEBUG_INFO:\n           dwFirstChance: 1\n           ExceptionCode: C0000005 (EXCEPTION_ACCESS_VIOLATION)\n          ExceptionFlags: 00000000\n        ExceptionAddress: 01A3D1BC\n        NumberParameters: 2\nExceptionInformation[00]: 00000000 Read\nExceptionInformation[01]: 00000000 Inaccessible Address\nFirst chance exception on 01A3D1BC (C0000005, EXCEPTION_ACCESS_VIOLATION)!\nEXCEPTION_DEBUG_INFO:\n           dwFirstChance: 1\n           ExceptionCode: E0434352 (CLR_EXCEPTION)\n          ExceptionFlags: 00000001\n        ExceptionAddress: kernelbase.76048D52\n        NumberParameters: 5\nExceptionInformation[00]: 80070002\nExceptionInformation[01]: 00000000\nExceptionInformation[02]: 00000000\nExceptionInformation[03]: 00000000\nExceptionInformation[04]: clr.6F7E0000\nFirst chance exception on 76048D52 (E0434352, CLR_EXCEPTION)!\nDebugString: \"RegistrationThread-3 has started.\"\nDebugString: \"RegistrationThread-3 has started.\"\nThread 4620 created, Entry: clr.6F8D1090, Parameter: 0698BEC8\nThread 6972 created, Entry: clr.6F8D1090, Parameter: 069967D8\nThread 8392 created, Entry: clr.6F812E80, Parameter: 00000000\nEXCEPTION_DEBUG_INFO:\n           dwFirstChance: 1\n           ExceptionCode: C0000005 (EXCEPTION_ACCESS_VIOLATION)\n          ExceptionFlags: 00000000\n        ExceptionAddress: 01A3D1BC\n        NumberParameters: 2\nExceptionInformation[00]: 00000000 Read\nExceptionInformation[01]: 00000000 Inaccessible Address\nFirst chance exception on 01A3D1BC (C0000005, EXCEPTION_ACCESS_VIOLATION)!\nThread 8392 exit\nEXCEPTION_DEBUG_INFO:\n           dwFirstChance: 1\n           ExceptionCode: C0000005 (EXCEPTION_ACCESS_VIOLATION)\n          ExceptionFlags: 00000000\n        ExceptionAddress: 01A3D1BC\n        NumberParameters: 2\nExceptionInformation[00]: 00000000 Read\nExceptionInformation[01]: 00000000 Inaccessible Address\nFirst chance exception on 01A3D1BC (C0000005, EXCEPTION_ACCESS_VIOLATION)!\nThread 3292 exit\nThread 6972 exit\nDLL Loaded: 72500000 C:\\Windows\\SysWOW64\\CoreMessaging.dll\nDLL Loaded: 72270000 C:\\Windows\\SysWOW64\\CoreUIComponents.dll\nThread 5932 created, Entry: ntdll.77ABCAC0, Parameter: 017E0880\nThread 5524 created, Entry: ntdll.77ABCAC0, Parameter: 017E0880\n</code></pre>\n<p><a href=\"https://i.sstatic.net/KC85P.jpg\" rel=\"nofollow noreferrer\"><img alt=\"Here's the picture of the registration window, and some of the windows api calls it makes\" src=\"https://i.sstatic.net/KC85P.jpg\"/></a></p>\n<p><strong>Update</strong>:</p>\n<p>So I took, @0xC0000022L's advice and used <code>dnspy</code> to decompile the .exe. It was a life saver, and I was able to extract the class that's responsible for registration. Only issue is, there are calls that are obfuscated. It apparently uses <code>confuser</code> and <code>confuserex</code> (as per <code>die</code>) for obfuscating these calls. Can these calls be deobfuscated somehow? I couldn't anything useful on youtube, it's just skiddies there.</p>\n</div>",
    "votes": "0",
    "answers": 0,
    "views": "239",
    "tags": [
        "debugging",
        "binary-analysis",
        "ghidra",
        "x64dbg",
        "debugging-symbols"
    ],
    "user": "The one word assaulter",
    "time": "Oct 19, 2023 at 15:41",
    "comments": [
        {
            "user": "0xC0000022L",
            "text": "<span class=\"comment-copy\">Hi and welcome to RE.SE. Other than the screenshot and some vague wording, how do you imagine anyone will be able to deduce any details about the program you are looking at? Where does Ghidra or x64dbg (both tagged) come in? Please edit your question to add more details so anyone who doesn't sit in front of <i>your</i> computer would be able to fill in the (hopefully few) remaining blanks. Thank you.</span>",
            "time": null
        },
        {
            "user": "The one word assaulter",
            "text": "<span class=\"comment-copy\">Sorry for the vague Information. I've edited it. I hope this will do.</span>",
            "time": null
        },
        {
            "user": "0xC0000022L",
            "text": "<span class=\"comment-copy\">That looks a little better already. Thanks. Without the binary, I doubt there is much other than generic advice that can be given here. It looks like it's a .NET program, which first of all means that ILSpy and similar programs are likely better suited to help here. WinDbg also generally has good support for .NET/CLR programs; for x64dbg I have no experience with .NET. A DLL placement attack with a manipulated <code>mscoree.dll</code> may be a nice way to intercept more stuff from <i>within</i> the process. If those are Windows Forms, you could try a window hook to trigger a break point on button click.</span>",
            "time": null
        },
        {
            "user": "0xC0000022L",
            "text": "<span class=\"comment-copy\">Another thing to run would be Detect-It-Easy (DIE) to scan for known obfuscators and/or runtime packers. The absence of string matches suggests that such techniques could have been employed in creation of the <code>.exe</code> in question.</span>",
            "time": null
        },
        {
            "user": "The one word assaulter",
            "text": "<span class=\"comment-copy\">Hey @0xC0000022L, thanks for all this information. It gives me some stepping stones to begin with. Here's the link to the program, if you wanna check it out yourself, easyupload.io/lwpk01.</span>",
            "time": null
        }
    ],
    "answers_data": []
}