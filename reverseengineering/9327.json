{
    "title": "Assembly analyze C system() function",
    "link": "https://reverseengineering.stackexchange.com/questions/9327/assembly-analyze-c-system-function",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>So I made a very simple C program to study how C works on the inside. It has just 1 line in the main() excluding return 0:</p>\n<pre><code>system(\"cls\");\n</code></pre>\n<p>If I use ollydebugger to analyze this program It will show something like this(text after the semicolons are comments generated by ollydebugger.</p>\n<pre><code>MOV DWORD PTR SS:[ESP],test_1.004030EC     ; ||ASCII \"cls\"\nCALL &lt;JMP.&amp;msvcrt.system&gt;                ; |\\system\n</code></pre>\n<p>Can someone explain what this means, and if I want to change the \"cls\" called in the system() to another command, where is the \"cls\" stored? And how do I modify it?</p>\n</div>",
    "votes": "-2",
    "answers": 1,
    "views": "561",
    "tags": [
        "ollydbg",
        "assembly",
        "c"
    ],
    "user": "Dashadower",
    "time": "Jul 11, 2015 at 12:24",
    "comments": [
        {
            "user": "0xec",
            "text": "<span class=\"comment-copy\">Ascii string <code>cls</code> is stored at virtual address <code>004030EC</code>. In Olly press ,Ctrl + G to go there.</span>",
            "time": null
        }
    ],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>The Ascii string <code>cls</code> is stored at address <code>0x004030EC</code>. Why is it stored at that location is probably compiler related. </p>\n<p>The <code>ESP</code> register holds the address of the top of the stack. What your instruction </p>\n<pre><code>MOV DWORD PTR SS:[ESP],test_1.004030EC     ; ||ASCII \"cls\"\n</code></pre>\n<p>means is to put the value <code>0x004030EC</code> to the address pointed to by <code>ESP</code>. If the value of <code>ESP</code> is, lets say, <code>ESP = 0x0018FF8C</code>, then the value at address <code>0x0018FF8C</code> will be <code>0x004030EC</code> after the above <code>MOV</code> instruction is executed.</p>\n<p>If you want to change the string <code>cls</code> to something else, you can position at the dump window in Olly and press CTRL-G. A popup box will appear and there you will enter <code>0x004030EC</code> and press <code>Ok</code>. After that right click on the first byte at that address, which should be <code>0x63</code> (the letter 'c' from string \"cls\") and choose <code>Binary -&gt; Edit</code>. There you can enter your new string that will be passed to the <code>CALL</code> instruction.</p>\n</div>",
            "votes": "1",
            "user": "ubnix",
            "time": "Jul 13, 2015 at 10:16",
            "is_accepted": false,
            "comments": []
        }
    ]
}