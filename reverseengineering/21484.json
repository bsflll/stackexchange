{
    "title": "Turning p-code generated by VBA (Visual Basic for Applications) back into VBA",
    "link": "https://reverseengineering.stackexchange.com/questions/21484/turning-p-code-generated-by-vba-visual-basic-for-applications-back-into-vba",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>According to the README in <a href=\"https://github.com/bontchev/pcodedmp\" rel=\"nofollow noreferrer\">https://github.com/bontchev/pcodedmp</a> :</p>\n<p>\"As each VBA line is entered into the VBA editor, it is immediately compiled into p-code\"</p>\n<p>\"when you open the source of a macro module in the VBA editor, what is displayed is not the decompressed source code but the p-code decompiled into source\"</p>\n<p>This means that there is a line-to-line correspondence between the p-code and the VBA source code that generates it.</p>\n<p>Is there a tool that can take the dumped p-code and get the VBA source code that generated it? </p>\n<p>So for example, the input would be something like</p>\n<pre><code>Line #0:\n    FuncDefn (Private Sub Document_Open())\nLine #1:\n    LitStr 0x001D \"This could have been a virus!\"\n    Ld vbOKOnly\n    Ld vbInformation\n    Add\n    LitStr 0x0006 \"Virus!\"\n    ArgsCall MsgBox 0x0003\nLine #2:\n    LitStr 0x0008 \"calc.exe\"\n    Paren\n    ArgsCall Shell 0x0001\nLine #3:\n    EndSub\n</code></pre>\n<p>and output</p>\n<pre><code>Private Sub Document_Open()\n    MsgBox \"This could have been a virus!\", vbOKOnly + vbInformation, \"Virus!\"\n    Shell(\"calc.exe\")\nEnd Sub\n</code></pre>\n</div>",
    "votes": "2",
    "answers": 0,
    "views": "2k",
    "tags": [
        "disassembly",
        "disassemblers",
        "decompile",
        "visual-basic",
        "vba"
    ],
    "user": "hyk",
    "time": "Jun 14, 2019 at 11:02",
    "comments": [
        {
            "user": "ComputerVersteher",
            "text": "<span class=\"comment-copy\">How do you get p-code without source-code, except MS-Access Databases? For them have a look at <a href=\"https://www.everythingaccess.com/mdeconversion.asp\" rel=\"nofollow noreferrer\">everythingaccess mdeconversion</a>. They can recover most of source code from ms-access p-code in compiled db's(.ADE, .ACCDE, . MDE)</span>",
            "time": null
        },
        {
            "user": "hyk",
            "text": "<span class=\"comment-copy\">You can get the p-code from documents containing macro's with the tool <a href=\"https://github.com/bontchev/pcodedmp\" rel=\"nofollow noreferrer\">github.com/bontchev/pcodedmp</a> However, you can only fetch the binary and not convert it back into the written source-code form</span>",
            "time": null
        },
        {
            "user": "Rolf Rolles",
            "text": "<span class=\"comment-copy\">Did you try pcode2code? <a href=\"https://github.com/Big5-sec/pcode2code/\" rel=\"nofollow noreferrer\">github.com/Big5-sec/pcode2code</a></span>",
            "time": null
        }
    ],
    "answers_data": []
}