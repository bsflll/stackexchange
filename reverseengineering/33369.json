{
    "title": "Extracting & Parsing Information from a Captured Packet",
    "link": "https://reverseengineering.stackexchange.com/questions/33369/extracting-parsing-information-from-a-captured-packet",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>I am attempting to capture and parse packets being sent between my machine and a game server that has a market place (example marketplace listing below). I can successfully capture the packets that have some of the relevant data but am missing how the \"<em>Expires In</em>\", \"<em>Price</em>\", and \"<em>Price_2</em>\" is represented in the packet (if at all).</p>\n<p>Example rendering on the screen:</p>\n<pre><code>+------------------+--------+------+------+------------+-------+----------+\n| Item Name        | Rarity | Slot | Type | Expires In | Price | Price_2  |\n+------------------+--------+------+------+------------+-------+----------+\n| Ring of Vitality | Epic   | Ring | Ring | 6d 23h 55m | 1,688 | -        |\n| Cobalt Ore       | Rare   | -    | Ore  | 6d 23h 55m | 315   | 52.5 x 6 |\n+------------------+--------+------+------+------------+-------+----------+\n</code></pre>\n<p>Data provided in the packet, converted to ascii:</p>\n<pre><code>*DesignDataItem:Id_Item_RingOfVitality_5001 J?\n;DesignDataItemPropertyType:Id_ItemPropertyType_Effect_VigorRC\n?DesignDataItemPropertyType:Id_ItemPropertyType_Effect_PrimitiveRJ\nFDesignDataItemPropertyType:Id_ItemPropertyType_Effect_ArmorPenetration\nRG\nCDesignDataItemPropertyType:Id_ItemPropertyType_Effect_PhysicalPowerX`jClerkoorCleric#11102875\n  *[\nSorzacSorcerer#10022529\"3LeaderboardRankData:Id_LeaderboardRank_Neophyte_III\n 9&amp;DesignDataItem:Id_Item_CobaltOres_4001 (X  *U\n</code></pre>\n<p>The \"<em>Item Name</em>\" and \"<em>Rarity</em>\" (represented by the \"_5001\") are being represented in parsable, plain-text, but I am unable to figure out how the others are being represented / sent to my computer. To be clear, this isn't an internal, offline market - these listings are being created / canceled / filled on a real-time basis. These values <em>must</em> be being sent to my PC via a packet if they're being rendered on screen, right?</p>\n<p>Raw packet data for reference:</p>\n<pre><code>8a110000b80d00010ae00308b9f6831512f20208d8f0f8c7eb8fc007122a44657369676e446174614974656d3a49645f4974656d5f52696e674f66566974616c6974795f35303031180120024a3f0a3b44657369676e446174614974656d50726f7065727479547970653a49645f4974656d50726f7065727479547970655f4566666563745f5669676f72100352430a3f44657369676e446174614974656d50726f7065727479547970653a49645f4974656d50726f7065727479547970655f4566666563745f5072696d69746976651001524a0a4644657369676e446174614974656d50726f7065727479547970653a49645f4974656d50726f7065727479547970655f4566666563745f41726d6f7250656e6574726174696f6e100d52470a4344657369676e446174614974656d50726f7065727479547970653a49645f4974656d50726f7065727479547970655f4566666563745f506879736963616c506f7765721001580360016a07436c65726b6f6f720f436c6572696323313131303238373518980d20b587b2a0022a5b0a06536f727a61631211536f72636572657223313030323235323918f4ffffffffffffffff0122334c6561646572626f61726452616e6b446174613a49645f4c6561646572626f61726452616e6b5f4e656f70687974655f4949490aa00108b8f68315123908a1818cfbda928002122644657369676e446174614974656d3a49645f4974656d5f436f62616c744f7265735f34303031180620062802580218bb02209987b2a0022a550a0a77636e6d6d7362313233121242617262617269616e23313137383230333122334c6561646572626f61726452616e6b446174613a49645f4c6561646572626f61726452616e6b5f4e656f70687974655f4949490ab60208b7f6831512d201088dabb9b2da92800c122144657369676e446174614974656d3a49645f4974656d5f53706561725f323030311801200228054a4e0a4a44657369676e446174614974656d50726f7065727479547970653a49645f4974656d50726f7065727479547970655f4566666563745f506879736963616c576561706f6e44616d61676510244a4c0a3f44657369676e446174614974656d50726f7065727479547970653a49645f4974656d50726f7065727479547970655f4566666563745f4d6f7665537065656410d8ffffffffffffffff0158031841209987b2a0022a520a0c426c6967687463616c6c6572120d52616e6765722332313938373122334c6561646572626f61726452616e6b446174613a49645f4c6561646572626f61726452616e6b5f4e656f70687974655f4949490a950308b6f6831512af0208f4ff8487db928009122a44657369676e446174614974656d3a49645f4974656d5f52696e674f66566974616c6974795f343030311801201428c7014a3f0a3b44657369676e446174614974656d50726f7065727479547970653a49645f4974656d50726f7065727479547970655f4566666563745f5669676f72100252430a3f44657369676e446174614974656d50726f7065727479547970653a49645f4974656d50726f7065727479547970655f4566666563745f5072696d69746976651001524b0a4744657369676e446174614974656d50726f7065727479547970653a49645f4974656d50726f7065727479547970655f4566666563745f506879736963616c44616d6167654164641001580260016a0a4170706c656461796f6f720e52616e676572233335343034383318bb0920c586b2a0022a530a0952696e676f6461796f121142617262617269616e233439313232333422334c6561646572626f61726452616e6b446174613a49645f4c6561646572626f61726452616e6b5f4e656f70687974655f4949490a9e0108b5f68315123c0890a880aca18e8004122844657369676e446174614974656d3a49645f4974656d5f53696c766572506f776465725f353030311805200428ef01580318c50220bd85b2a0022a500a074359\n</code></pre>\n<p>Thank you in advance for any assistance.</p>\n</div>",
    "votes": "0",
    "answers": 1,
    "views": "66",
    "tags": [
        "wireshark",
        "packet"
    ],
    "user": "Seth Thomas",
    "time": "Jan 26 at 4:11",
    "comments": [],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>First you should identify what's the role of a given packet, then start recovering the data layout so you can read its contents. The item expiration/pricing data should be pulled from the game's backend, although it may be delivered separately and/or in a different format. You never know.</p>\n<p>The strings in the example seem to have a <code>u8</code> exclusive size in front and are not null-terminated, it's hard to say more than that without knowing the protocol.</p>\n</div>",
            "votes": "0",
            "user": "mimak",
            "time": "Feb 11 at 14:28",
            "is_accepted": false,
            "comments": []
        }
    ]
}