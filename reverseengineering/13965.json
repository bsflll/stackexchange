{
    "title": "Reverse Engineering Legacy iPod Click Wheel Games",
    "link": "https://reverseengineering.stackexchange.com/questions/13965/reverse-engineering-legacy-ipod-click-wheel-games",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>I have recently found a bunch of old iPod (pre-touch) games.  These <code>ipg</code> files (similar to modern iOS <code>ipa</code> files).  Are application bundles which contain resources (images, music files, textures), sometimes a localized strings file, and executables.</p>\n<p>Each bundle contains a Manifest.plist file, with executable information.  Below is the manifest for Bomberman 1.0:</p>\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE plist PUBLIC \"-//Apple Computer//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;\n&lt;plist version=\"1.0\"&gt;\n&lt;dict&gt;\n    &lt;key&gt;BuildIdentifier&lt;/key&gt;\n    &lt;string&gt;1465338237-ae7bdef1533\n&lt;/string&gt;\n    &lt;key&gt;Files&lt;/key&gt;\n    &lt;array&gt;\n        &lt;dict&gt;\n            &lt;key&gt;Digest&lt;/key&gt;\n            &lt;string&gt;D576EBCA193EA6C08060394435497CBE52288730&lt;/string&gt;\n            &lt;key&gt;Path&lt;/key&gt;\n            &lt;string&gt;bombLaunchm25.raw.lcd5&lt;/string&gt;\n            &lt;key&gt;Size&lt;/key&gt;\n            &lt;integer&gt;138256&lt;/integer&gt;\n        &lt;/dict&gt;\n        &lt;dict&gt;\n            &lt;key&gt;DRM&lt;/key&gt;\n            &lt;true/&gt;\n            &lt;key&gt;Digest&lt;/key&gt;\n            &lt;string&gt;10A5CD8E82B692D4A3136753639FFE9EC96F9E72&lt;/string&gt;\n            &lt;key&gt;Path&lt;/key&gt;\n            &lt;string&gt;Executables/iPodBomberman_7052137.bin&lt;/string&gt;\n            &lt;key&gt;Size&lt;/key&gt;\n            &lt;integer&gt;425664&lt;/integer&gt;\n            &lt;key&gt;Verify&lt;/key&gt;\n            &lt;true/&gt;\n        &lt;/dict&gt;\n        &lt;dict&gt;\n            &lt;key&gt;Digest&lt;/key&gt;\n            &lt;string&gt;3DBFC1556706CF12555448CC5103FCCB59E6E773&lt;/string&gt;\n            &lt;key&gt;Path&lt;/key&gt;\n            &lt;string&gt;bombLaunchm1a.raw.lcd5&lt;/string&gt;\n            &lt;key&gt;Size&lt;/key&gt;\n            &lt;integer&gt;6176&lt;/integer&gt;\n        &lt;/dict&gt;\n        &lt;dict&gt;\n            &lt;key&gt;DRM&lt;/key&gt;\n            &lt;true/&gt;\n            &lt;key&gt;Digest&lt;/key&gt;\n            &lt;string&gt;99B99192D77939DAB9A7E05AEB9ED564D33ECFDB&lt;/string&gt;\n            &lt;key&gt;Path&lt;/key&gt;\n            &lt;string&gt;Executables/iPodBomberman_7052208.bin&lt;/string&gt;\n            &lt;key&gt;Size&lt;/key&gt;\n            &lt;integer&gt;633344&lt;/integer&gt;\n            &lt;key&gt;Verify&lt;/key&gt;\n            &lt;true/&gt;\n        &lt;/dict&gt;\n    &lt;/array&gt;\n    &lt;key&gt;GUID&lt;/key&gt;\n    &lt;string&gt;20000&lt;/string&gt;\n    &lt;key&gt;Name&lt;/key&gt;\n    &lt;string&gt;Bomberman&lt;/string&gt;\n    &lt;key&gt;Platforms&lt;/key&gt;\n    &lt;array&gt;\n        &lt;dict&gt;\n            &lt;key&gt;BuildID&lt;/key&gt;\n            &lt;integer&gt;7052137&lt;/integer&gt;\n            &lt;key&gt;ExecutablePath&lt;/key&gt;\n            &lt;string&gt;Executables/iPodBomberman_7052137.bin&lt;/string&gt;\n            &lt;key&gt;LaunchingArtwork&lt;/key&gt;\n            &lt;string&gt;bombLaunchm25.raw.lcd5&lt;/string&gt;\n            &lt;key&gt;PlatformID&lt;/key&gt;\n            &lt;integer&gt;1&lt;/integer&gt;\n            &lt;key&gt;PlatformVersion&lt;/key&gt;\n            &lt;integer&gt;1&lt;/integer&gt;\n            &lt;key&gt;Size&lt;/key&gt;\n            &lt;integer&gt;425664&lt;/integer&gt;\n        &lt;/dict&gt;\n        &lt;dict&gt;\n            &lt;key&gt;BuildID&lt;/key&gt;\n            &lt;integer&gt;7052208&lt;/integer&gt;\n            &lt;key&gt;ExecutablePath&lt;/key&gt;\n            &lt;string&gt;Executables/iPodBomberman_7052208.bin&lt;/string&gt;\n            &lt;key&gt;LaunchingArtwork&lt;/key&gt;\n            &lt;string&gt;bombLaunchm1a.raw.lcd5&lt;/string&gt;\n            &lt;key&gt;PlatformID&lt;/key&gt;\n            &lt;integer&gt;2&lt;/integer&gt;\n            &lt;key&gt;PlatformVersion&lt;/key&gt;\n            &lt;integer&gt;1&lt;/integer&gt;\n            &lt;key&gt;Size&lt;/key&gt;\n            &lt;integer&gt;633344&lt;/integer&gt;\n        &lt;/dict&gt;\n        &lt;dict&gt;\n            &lt;key&gt;BuildID&lt;/key&gt;\n            &lt;integer&gt;7052208&lt;/integer&gt;\n            &lt;key&gt;ExecutablePath&lt;/key&gt;\n            &lt;string&gt;Executables/iPodBomberman_7052208.bin&lt;/string&gt;\n            &lt;key&gt;LaunchingArtwork&lt;/key&gt;\n            &lt;string&gt;bombLaunchm1a.raw.lcd5&lt;/string&gt;\n            &lt;key&gt;PlatformID&lt;/key&gt;\n            &lt;integer&gt;3&lt;/integer&gt;\n            &lt;key&gt;PlatformVersion&lt;/key&gt;\n            &lt;integer&gt;1&lt;/integer&gt;\n            &lt;key&gt;Size&lt;/key&gt;\n            &lt;integer&gt;633344&lt;/integer&gt;\n        &lt;/dict&gt;\n    &lt;/array&gt;\n    &lt;key&gt;Version&lt;/key&gt;\n    &lt;string&gt;1.0&lt;/string&gt;\n&lt;/dict&gt;\n&lt;/plist&gt;\n</code></pre>\n<p>The Manifest appears to contain two different builds (one is listed twice), presumably for two different iPod architectures (?).  For each executable there also appears to be an accompanying <code>.bin.sinf</code> file, which I believe contains purchaser information used by Apple's FairPlay DRM.</p>\n<p>Here's where I get stuck:</p>\n<ul>\n<li><p>Running <code>strings</code> on either of the executables, <code>.bin.sinf</code> files, or the <code>.raw.lcd5</code> files prints garbage.</p></li>\n<li><p>Running <code>nm</code> gives me an error that the files are not object files.</p></li>\n<li><p><code>file</code> just tells me that the files are binary data.</p></li>\n<li><p>I cannot use <code>otool</code> because the files are not Mach-O binaries.</p></li>\n</ul>\n<p>According to Wikipedia, all iPods before the 6th gen classic used an ARM processor (one or more 7TDMI-derived CPUs).</p>\n<p>What are my options for dissembling or reading any of the information (strings, etc) of these executables and binary files?</p>\n</div>",
    "votes": "1",
    "answers": 0,
    "views": "392",
    "tags": [
        "ipod"
    ],
    "user": "JAL",
    "time": "Nov 18, 2016 at 8:22",
    "comments": [
        {
            "user": "Jongware",
            "text": "<span class=\"comment-copy\">Modern IPA files are <i>heavily</i> encrypted. Could it be the same for these old files? Your search for plain text strings seems to indicate that.</span>",
            "time": null
        },
        {
            "user": "JAL",
            "text": "<span class=\"comment-copy\">@RadLexus That could be the case.  All of the binaries should be the same for all purchasers, but the <code>sinf</code> contain purchaser-specific keys to start the executable.  But wouldn't it be odd for all the binary files in the bundle to be encrypted?  Surely the game data should be somehow visible.</span>",
            "time": null
        }
    ],
    "answers_data": []
}