{
    "title": "Anti-cheat Memory Scan",
    "link": "https://reverseengineering.stackexchange.com/questions/6046/anti-cheat-memory-scan",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<h1>The Problem</h1>\n<p>I'm attaching a game's process to view/edit my ammo. I've reversed a few games and understand x86 assembly; however, I'm new to the whole <i>anti-debuggers</i> and <i>memory scanning</i> bit. I have searched for resources on how to combat this issue, but still have found nothing. Whenever I attach to the game it still works, but as soon as I change a single instruction it's as if the application \"scans\" it and detects my change, thus causing a crash. Also, sometimes if I happen to \"bypass\" the detection, the anti-cheat always finds a way to kick me out.</p>\n<p>I've read about a few functions that some programs may use, but none of them have really seemed to help.</p>\n<h1>Questions</h1>\n<ol>\n<li>What do these games/applications use to detect this?</li>\n<li>Is there a way to avoid this detection?</li>\n</ol>\n</div>",
    "votes": "1",
    "answers": 2,
    "views": "3k",
    "tags": [
        "x86",
        "anti-debugging"
    ],
    "user": "iScott",
    "time": "Jun 17, 2020 at 9:54",
    "comments": [
        {
            "user": "Guntram Blohm",
            "text": "<span class=\"comment-copy\">Possible duplicate of <a href=\"http://reverseengineering.stackexchange.com/questions/3658/what-ways-is-there-for-an-application-to-detect-that-it-has-been-modified/3661#3661\" title=\"what ways is there for an application to detect that it has been modified\">reverseengineering.stackexchange.com/questions/3658/â€¦</a> ?</span>",
            "time": null
        },
        {
            "user": "Dominik Antal",
            "text": "<span class=\"comment-copy\">Are you sure it's the anticheat thats crashing the app, instead of you messing at the wrong place in memory? Since you didn't mention which AC is this, I'ld recommend you googling for \"warden\" and \"punk buster\" and check game hacking sites for more info on them to get a basic understanding how they work.</span>",
            "time": null
        }
    ],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>Regarding the questions:</p>\n<ol>\n<li>Applications are reading code memory and computing checksums. If checksum not matches predefined value - applications act accordingly.</li>\n<li>There is no general and easy explainable way to avoid such kind of detection. The most common point of such action is patching the code that checks the checksum.</li>\n</ol>\n<p>In your case I'd try to protect the changed memory from reading (by calling <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/aa366898(v=vs.85).aspx\" rel=\"nofollow\">VirtualProtect</a> from injected dll for example) or create breakpoint on reading memory on changed area and check the area of code where changed memory reading will occur - this will be the place where the changed code is read. \nYou'll need either recalculate the checksum with your new changed code or nopify the code that is responsible for incorrect checksum reaction.</p>\n<p>Please note that the checksuming code you'll need to change may be also protected in the same manner.</p>\n</div>",
            "votes": "2",
            "user": "w s",
            "time": "Aug 10, 2014 at 11:03",
            "is_accepted": false,
            "comments": []
        },
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>First, there's no perfect solution. An application running on a computer is subject to all kinds of manipulation. All you can do is take a few reasonable steps to prevent most cheating and manipulation of the client by people who aren't willing to spend enough resources to figure out how to circumvent your anti-cheating measures. </p>\n<p>A few steps you can take include:</p>\n<ol>\n<li><p>Obfuscate the binary by randomizing the linker. This way, any in-memory hacks change every time you push a new version. </p></li>\n<li><p>Embed a secret key in the client. Check for the correct key every time you connect to a client. </p></li>\n<li><p>Obfuscate memory.  Have a set of randomized XOR pads for each memory structure, making it harder for an in-memory hacker to determine how to manipulate memory. </p></li>\n<li><p>Checksum. For each structure, store a checksum of all values which is periodically verified. </p></li>\n<li><p>Constraint validation. For any constrained values, double check them every time they are used for sane values, preferably on the server.</p></li>\n<li><p>Log and ban.  Log any suspicious behavior and immediately ban the user.  Ultimately this is your best deterrent to cheating. </p></li>\n</ol>\n</div>",
            "votes": "1",
            "user": "Jeff-Inventor ChromeOS",
            "time": "Aug 10, 2014 at 20:34",
            "is_accepted": false,
            "comments": []
        }
    ]
}