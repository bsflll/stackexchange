{
    "title": "cisco ip phone 7811 cnu unpack",
    "link": "https://reverseengineering.stackexchange.com/questions/6735/cisco-ip-phone-7811-cnu-unpack",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<pre>\nroot@kali:/var/tmp# /usr/local/bin/binwalk 1.cnu \n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n859773        0xD1E7D         LZMA compressed data, properties: 0xD8, dictionary size: 65536 bytes, uncompressed size: 143729976 bytes\n2167077       0x211125        LZMA compressed data, properties: 0xA2, dictionary size: 1048576 bytes, uncompressed size: 512 bytes\n2462556       0x25935C        Unix path: /usr/local/trace/log.properties\n2491824       0x2605B0        Neighborly text, \"neighborDatater of ipV4Buffer\"\n2496776       0x261908        Unix path: /usr/local/etc/ppid.conf\n2498956       0x26218C        Unix path: /usr/local/etc/localtime\n2541156       0x26C664        HTML document header\n2541164       0x26C66C        HTML document footer\n2548552       0x26E348        Base64 standard index table\n2633552       0x282F50        PARity archive data - file number 29296\n2673864       0x28CCC8        XML document, version: \"1.0\"\n2818416       0x2B0170        XML document, version: \"1.0\"\n2818768       0x2B02D0        XML document, version: \"1.0\"\n2850344       0x2B7E28        XML document, version: \"1.0\"\n2850544       0x2B7EF0        XML document, version: \"1.0\"\n2852484       0x2B8684        XML document, version: \"1.0\"\n2907869       0x2C5EDD        Copyright string: \"Copyright (c) 1998-2004 Glenn Randers-Pehrson\"\n2907918       0x2C5F0E        Copyright string: \"Copyright (c) 1996-1997 Andreas Dilger\"\n2907960       0x2C5F38        Copyright string: \"Copyright (c) 1995-1996 Guy Eric Schalnat, Group 42, Inc.\"\n2914752       0x2C79C0        CRC32 polynomial table, big endian\n2918848       0x2C89C0        CRC32 polynomial table, little endian\n2925631       0x2CA43F        Copyright string: \"Copyright 1995-2005 Mark Adler \"\n2943375       0x2CE98F        Neighborly text, \"neighbor 1 malloc failed MsgQue has not been created : %m \"\n2943423       0x2CE9BF        Neighborly text, \"neighbor: inetdMsgQue has not been created : %m r: msgsnd failed : %m \"\n2943479       0x2CE9F7        Neighborly text, \"neighbor: msgsnd failed : %m pQue open failed : %m \"\n2943527       0x2CEA27        Neighborly text, \"neighbor: cdpRspQue open failed : %m ailed \"\n2943571       0x2CEA53        Neighborly text, \"neighbor 2 malloc failed s response : %m \"\n2943603       0x2CEA73        Neighborly text, \"neighbor: error receiving status response : %m ll info\"\n3016112       0x2E05B0        CRC32 polynomial table, big endian\n3017151       0x2E09BF        Copyright string: \"Copyright 1995-1998 Jean-loup Gailly \"\n3020507       0x2E16DB        Copyright string: \"Copyright 1995-1998 Mark Adler \"\n3979099       0x3CB75B        Unix path: /midp/io/j2me/ssl\n4078794       0x3E3CCA        Neighborly text, \"NeighborIDrIPv6\"\n4078822       0x3E3CE6        Neighborly text, \"NeighborIPrPort\"\n4078850       0x3E3D02        Neighborly text, \"NeighborIPv6orID\"\n4078878       0x3E3D1E        Neighborly text, \"NeighborPortorIP\"\n4078907       0x3E3D3B        Neighborly text, \"NeighborIDrIPv6\"\n4078935       0x3E3D57        Neighborly text, \"NeighborIPrPort\"\n4078963       0x3E3D73        Neighborly text, \"NeighborIPv6RT_INFO_MAX_INDEX\"\n4078991       0x3E3D8F        Neighborly text, \"NeighborPortNTEGER\"\n4081214       0x3E463E        Neighborly text, \"NeighborInfoml\"\n4081584       0x3E47B0        Neighborly text, \"NeighborIPv4AddressghborPortID\"\n4081604       0x3E47C4        Neighborly text, \"NeighborIPv6Addresstatus\"\n4081624       0x3E47D8        Neighborly text, \"NeighborDeviceIDs\"\n4081644       0x3E47EC        Neighborly text, \"NeighborPortID\"\n4217515       0x405AAB        LZMA compressed data, properties: 0xBF, dictionary size: 33554432 bytes, uncompressed size: 25430 bytes\n4238176       0x40AB60        mcrypt 2.2 encrypted data, algorithm: xTEA, mode: CBC, keymode: SHA-1 hash\n4244703       0x40C4DF        LZMA compressed data, properties: 0x5C, dictionary size: 33554432 bytes, uncompressed size: 306730334 bytes\n4254959       0x40ECEF        LZMA compressed data, properties: 0x6C, dictionary size: 16777216 bytes, uncompressed size: 22638 bytes\n4261863       0x4107E7        LZMA compressed data, properties: 0x64, dictionary size: 33554432 bytes, uncompressed size: 19060 bytes\n4337995       0x42314B        LZMA compressed data, properties: 0xC8, dictionary size: 33554432 bytes, uncompressed size: 55919 bytes\n4358895       0x4282EF        LZMA compressed data, properties: 0x6C, dictionary size: 16777216 bytes, uncompressed size: 16244 bytes\n4366171       0x429F5B        LZMA compressed data, properties: 0xD8, dictionary size: 16777216 bytes, uncompressed size: 61006 bytes\n4821851       0x49935B        LZMA compressed data, properties: 0xD8, dictionary size: 16777216 bytes, uncompressed size: 60970 bytes\n4822767       0x4996EF        LZMA compressed data, properties: 0x6C, dictionary size: 16777216 bytes, uncompressed size: 34346 bytes\n4828939       0x49AF0B        LZMA compressed data, properties: 0x88, dictionary size: 16777216 bytes, uncompressed size: 25399 bytes\n4840779       0x49DD4B        LZMA compressed data, properties: 0xC8, dictionary size: 16777216 bytes, uncompressed size: 30250 bytes\n4848731       0x49FC5B        LZMA compressed data, properties: 0xD8, dictionary size: 33554432 bytes, uncompressed size: 18549 bytes\n4859631       0x4A26EF        LZMA compressed data, properties: 0x6C, dictionary size: 16777216 bytes, uncompressed size: 36705 bytes\n4869955       0x4A4F43        LZMA compressed data, properties: 0xC0, dictionary size: 16777216 bytes, uncompressed size: 12353 bytes\n5340435       0x517D13        LZMA compressed data, properties: 0x90, dictionary size: 16777216 bytes, uncompressed size: 34420 bytes\n5345091       0x518F43        LZMA compressed data, properties: 0xC0, dictionary size: 16777216 bytes, uncompressed size: 675291968 bytes\n5363439       0x51D6EF        LZMA compressed data, properties: 0x6C, dictionary size: 16777216 bytes, uncompressed size: 828140908 bytes\n5386331       0x52305B        LZMA compressed data, properties: 0xD8, dictionary size: 16777216 bytes, uncompressed size: 139399747 bytes\n5391071       0x5242DF        LZMA compressed data, properties: 0x5C, dictionary size: 16777216 bytes, uncompressed size: 28269 bytes\n5391327       0x5243DF        LZMA compressed data, properties: 0x5C, dictionary size: 16777216 bytes, uncompressed size: 28781 bytes\n5398339       0x525F43        LZMA compressed data, properties: 0xC0, dictionary size: 16777216 bytes, uncompressed size: 895370334 bytes\n5418207       0x52ACDF        LZMA compressed data, properties: 0x5C, dictionary size: 16777216 bytes, uncompressed size: 31831 bytes\n5423415       0x52C137        LZMA compressed data, properties: 0xB4, dictionary size: 16777216 bytes, uncompressed size: 38193 bytes\n5539594       0x54870A        mcrypt 2.2 encrypted data, algorithm: xTEA, mode: CBC, keymode: 8bit\n5692739       0x56DD43        LZMA compressed data, properties: 0xC0, dictionary size: 16777216 bytes, uncompressed size: 63810 bytes\n5695543       0x56E837        LZMA compressed data, properties: 0xB4, dictionary size: 16777216 bytes, uncompressed size: 289607235 bytes\n5709039       0x571CEF        LZMA compressed data, properties: 0x6C, dictionary size: 16777216 bytes, uncompressed size: 62797 bytes\n5716455       0x5739E7        LZMA compressed data, properties: 0x64, dictionary size: 16777216 bytes, uncompressed size: 2126 bytes\n5719867       0x57473B        LZMA compressed data, properties: 0xB8, dictionary size: 16777216 bytes, uncompressed size: 53619 bytes\n5724903       0x575AE7        LZMA compressed data, properties: 0x64, dictionary size: 16777216 bytes, uncompressed size: 62009 bytes\n5730635       0x57714B        LZMA compressed data, properties: 0xC8, dictionary size: 16777216 bytes, uncompressed size: 25399 bytes\n5744607       0x57A7DF        LZMA compressed data, properties: 0x5C, dictionary size: 16777216 bytes, uncompressed size: 40759 bytes\n5956931       0x5AE543        LZMA compressed data, properties: 0xC0, dictionary size: 16777216 bytes, uncompressed size: 28268 bytes\n5964859       0x5B043B        LZMA compressed data, properties: 0xB8, dictionary size: 16777216 bytes, uncompressed size: 35937 bytes\n5976887       0x5B3337        LZMA compressed data, properties: 0xB4, dictionary size: 16777216 bytes, uncompressed size: 40259 bytes\n5977063       0x5B33E7        LZMA compressed data, properties: 0x64, dictionary size: 16777216 bytes, uncompressed size: 40515 bytes\n5977319       0x5B34E7        LZMA compressed data, properties: 0x64, dictionary size: 16777216 bytes, uncompressed size: 41027 bytes\n5987083       0x5B5B0B        LZMA compressed data, properties: 0x88, dictionary size: 33554432 bytes, uncompressed size: 829402188 bytes\n6020875       0x5BDF0B        LZMA compressed data, properties: 0x88, dictionary size: 16777216 bytes, uncompressed size: 52326 bytes\n6208487       0x5EBBE7        LZMA compressed data, properties: 0x64, dictionary size: 16777216 bytes, uncompressed size: 54315 bytes\n6233327       0x5F1CEF        LZMA compressed data, properties: 0x6C, dictionary size: 16777216 bytes, uncompressed size: 13899 bytes\n6250043       0x5F5E3B        LZMA compressed data, properties: 0xB8, dictionary size: 16777216 bytes, uncompressed size: 14172 bytes\n6257939       0x5F7D13        LZMA compressed data, properties: 0x90, dictionary size: 16777216 bytes, uncompressed size: 51251 bytes\n6465263       0x62A6EF        LZMA compressed data, properties: 0x6C, dictionary size: 16777216 bytes, uncompressed size: 31831 bytes\n6481135       0x62E4EF        LZMA compressed data, properties: 0x6C, dictionary size: 16777216 bytes, uncompressed size: 30250 bytes\n6481419       0x62E60B        LZMA compressed data, properties: 0x88, dictionary size: 16777216 bytes, uncompressed size: 31018 bytes\n6482655       0x62EADF        LZMA compressed data, properties: 0x5C, dictionary size: 16777216 bytes, uncompressed size: 34346 bytes\n6487527       0x62FDE7        LZMA compressed data, properties: 0x64, dictionary size: 16777216 bytes, uncompressed size: 54862 bytes\n6495251       0x631C13        LZMA compressed data, properties: 0x90, dictionary size: 33554432 bytes, uncompressed size: 61006 bytes\n6496311       0x632037        LZMA compressed data, properties: 0xB4, dictionary size: 16777216 bytes, uncompressed size: 8783 bytes\n6649431       0x657657        LZMA compressed data, properties: 0xC8, dictionary size: 33554432 bytes, uncompressed size: 167772160 bytes\n6649887       0x65781F        LZMA compressed data, properties: 0xD0, dictionary size: 33554432 bytes, uncompressed size: 167772160 bytes\n6650271       0x65799F        LZMA compressed data, properties: 0xB4, dictionary size: 33554432 bytes, uncompressed size: 100663296 bytes\n6712044       0x666AEC        Base64 standard index table\n</pre>\n<p>Result is:</p>\n<pre>\nroot@kali:/var/tmp/_1.cnu.extracted# ls\n211125       4107E7.lzma  518F43.lzma  5739E7.lzma  5EBBE7.lzma  657657.lzma\n211125.lzma  42314B.lzma  51D6EF       57473B.lzma  5F1CEF.lzma  65781F\n26C664.html  4282EF.lzma  51D6EF.lzma  575AE7.lzma  5F5E3B.lzma  65781F.lzma\n28CCC8.xml   429F5B.lzma  52305B.lzma  57714B.lzma  5F7D13.lzma  65799F\n2B0170.xml   49935B.lzma  5242DF.lzma  57A7DF.lzma  62A6EF.lzma  65799F.lzma\n2B02D0.xml   4996EF.lzma  5243DF.lzma  5AE543.lzma  62E4EF.lzma  D1E7D\n2B7E28.xml   49AF0B.lzma  525F43.lzma  5B043B.lzma  62E60B.lzma  D1E7D.lzma\n2B7EF0.xml   49DD4B.lzma  52ACDF.lzma  5B3337.lzma  62EADF.lzma\n2B8684.xml   49FC5B.lzma  52C137.lzma  5B33E7.lzma  62FDE7.lzma\n405AAB.lzma  4A26EF.lzma  56DD43.lzma  5B34E7.lzma  631C13.lzma\n40C4DF.lzma  4A4F43.lzma  56E837.lzma  5B5B0B.lzma  632037.lzma\n40ECEF.lzma  517D13.lzma  571CEF.lzma  5BDF0B.lzma  657657\nroot@kali:/var/tmp/_1.cnu.extracted# \n</pre>\n<p>I want to know how to unpack LZMA files or cnu files</p>\n</div>",
    "votes": "0",
    "answers": 1,
    "views": "595",
    "tags": [
        "disassembly",
        "assembly"
    ],
    "user": "nothack",
    "time": "Apr 28, 2017 at 12:52",
    "comments": [],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>Binwalk has already unpacked the LZMA files for you. For example, the LZMA compressed file <code>D1E7D.lzma</code> was decompressed and the decompressed data was saved to the file <code>D1E7D</code>.</p>\n<p>From the binwalk output, this looks very much like an RTOS based firmware. In particular, check the first two decompressed LZMA files for executable code (binwalk's <code>-A</code> option will do a quick check for common opcodes from various architectures).</p>\n<p>Also note the base64 and CRC32 tables found in the main firmware image, which suggests that there is probably uncompressed executable code in the main firmware image as well.</p>\n<p>Most of those LZMA files toward the end of the firmware image are probably compressed HTML / JS / CSS / image files.</p>\n<p>It's hard to know without looking at the firmware, but it appears that this firmware is already \"unpacked\". But you need to find the executable code, figure out the code's expected load address, and start disassembling and reversing the code.</p>\n</div>",
            "votes": "2",
            "user": "devttys0",
            "time": "Nov 29, 2014 at 23:38",
            "is_accepted": false,
            "comments": []
        }
    ]
}