{
    "title": "Need help opening a .img file from a camera firmware (trying to get out of the Meari/Zumimall/PPstrong cloud!)",
    "link": "https://reverseengineering.stackexchange.com/questions/25938/need-help-opening-a-img-file-from-a-camera-firmware-trying-to-get-out-of-the-m",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>I've got a cloud-based battery powered camera which I'm really hoping to get <em>out</em> of the cloud with, in order to enable RTSP or ONVIF (or something local!).</p>\n<p>I've managed to get a .bin file. Binwalk allowed me to get an .img file, and there are many interesting strings from this file. It appears to at least have a filesystem of sorts:</p>\n<pre><code>DECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n3213849       0x310A19        Certificate in DER format (x509 v3), header length: 4, sequence length: 5380\n4199041       0x401281        Certificate in DER format (x509 v3), header length: 4, sequence length: 13692\n5097905       0x4DC9B1        Certificate in DER format (x509 v3), header length: 4, sequence length: 5380\n5184988       0x4F1DDC        Base64 standard index table\n5191688       0x4F3808        Unix path: /home/sound/warning.wav\n5195472       0x4F46D0        Unix path: /home/sound/login.wav\n5196188       0x4F499C        Unix path: /home/sound/restart.wav\n5213511       0x4F8D47        HTML document header\n5213544       0x4F8D68        HTML document footer\n5213635       0x4F8DC3        HTML document header\n5213676       0x4F8DEC        HTML document footer\n5213811       0x4F8E73        HTML document header\n5213995       0x4F8F2B        HTML document footer\n5217731       0x4F9DC3        HTML document header\n5217938       0x4F9E92        HTML document footer\n5218791       0x4FA1E7        HTML document header\n5219471       0x4FA48F        HTML document footer\n5220243       0x4FA793        HTML document header\n5220367       0x4FA80F        HTML document footer\n5221348       0x4FABE4        XML document, version: \"1.0\"\n5242268       0x4FFD9C        SHA256 hash constants, little endian\n5264636       0x5054FC        SHA256 hash constants, little endian\n5275136       0x507E00        PEM certificate\n5280492       0x5092EC        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/kernel/base/core/los_task.c\n5283112       0x509D28        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/kernel/base/mem/mem_bestfit/los_memory.c\n5284576       0x50A2E0        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/kernel/base/ipc/los_mux.c\n5292128       0x50C060        Unix path: /usr/local/etc/zoneinfo\n5292980       0x50C3B4        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/lib/libc/src/time/time64.c\n5294084       0x50C804        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/compat/posix/src/pthread_mutex.c\n5294948       0x50CB64        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/fs/vfs/inode/fs_inode.c\n5295300       0x50CCC4        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/fs/vfs/driver/fs_blockproxy.c\n5298224       0x50D830        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/fs/vfs/bch/src/bchlib_sem.c\n5482780       0x53A91C        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/fs/jffs2/src/fs.c\n5483508       0x53ABF4        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/fs/jffs2/src/readinode.c\n5486632       0x53B828        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/fs/jffs2/src/write.c\n5487060       0x53B9D4        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/fs/jffs2/include/debug.h\n5487516       0x53BB9C        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/fs/jffs2/src/nodelist.c\n5489184       0x53C220        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/fs/jffs2/src/scan.c\n5490792       0x53C868        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/fs/jffs2/src/nodemgmt.c\n5491300       0x53CA64        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/fs/jffs2/src/gc.c\n5505972       0x5403B4        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/platform/bsp/board/hi3518ev300/include/hisoc/i2c.h\n5520924       0x543E1C        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/platform/bsp/board/hi3518ev300/include/hisoc/spi.h\n5521580       0x5440AC        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/platform/bsp/board/hi3518ev300/include/hisoc/uart.h\n5533124       0x546DC4        eCos RTOS string reference: \"ECOST  CPUUSE   CPUUSE10s   CPUUSE1s   mode\"\n5617488       0x55B750        Unix path: /home/cfg/random_para.txt\n5668808       0x567FC8        CRC32 polynomial table, little endian\n6026720       0x5BF5E0        CRC32 polynomial table, little endian\n6077286       0x5CBB66        TIFF image data, big-endian, offset of first image directory: 8\n6078744       0x5CC118        TIFF image data, big-endian, offset of first image directory: 8\n6086620       0x5CDFDC        CRC32 polynomial table, little endian\n6122272       0x5D6B20        Unix path: /home/nie/pro/v103/trunk/libAACenc/src/aacenc_lib.cpp\n6125288       0x5D76E8        Unix path: /home/nie/pro/v103/trunk/libMpegTPEnc/src/tpenc_lib.cpp\n6125413       0x5D7765        Copyright string: \"copyright law and international treaties.\"\n6136076       0x5DA10C        Unix path: /home/nie/pro/v103/trunk/libFDK/include/fixpoint_math.h\n6136840       0x5DA408        Unix path: /home/nie/pro/v103/trunk/libAACenc/src/quantize.cpp\n6139780       0x5DAF84        Unix path: /home/nie/pro/v103/trunk/libAACenc/src/transform.cpp\n6151760       0x5DDE50        Unix path: /home/nie/pro/v103/trunk/libFDK/src/FDK_tools_rom.cpp\n6168775       0x5E20C7        Copyright string: \"copyright holder(s) nor the\"\n6169280       0x5E22C0        Copyright string: \"copyright\"\n6169415       0x5E2347        Copyright string: \"copyright\"\n6169908       0x5E2534        Copyright string: \"Copyright (c) 2003-2014, Jouni Malinen &lt;<a class=\"__cf_email__\" data-cfemail=\"9bf1dbecaab5fdf2\" href=\"/cdn-cgi/l/email-protection\">[email protected]</a>&gt; and contributors\"\n6230532       0x5F1204        Neighborly text, \"Neighboring BSS: freq=%dd\"\n6238636       0x5F31AC        Neighborly text, \"neighboring BSSes ret=%d (%s) - try to scan again (attempt %d)\"\n6239601       0x5F3571        Neighborly text, \"neighboring BSSes prior to enabling 40 MHz channelquest a scan of neighboring BSSes ret=%d (%s) - try to scan again\"\n6239680       0x5F35C0        Neighborly text, \"neighboring BSSes ret=%d (%s) - try to scan againequest a scan of neighboring BSSes ret=%d (%s)\"\n6239760       0x5F3610        Neighborly text, \"neighboring BSSes ret=%d (%s)rdware channel/rate support not supported.\"\n6240780       0x5F3A0C        Neighborly text, \"Neighboring BSS: %02x:%02x:%02x:%02x:%02x:%02x freq=%d pri=%d sec=%dec=%d\"\n6287708       0x5FF15C        SHA256 hash constants, little endian\n6295380       0x600F54        Base64 standard index table\n6302508       0x602B2C        Unix path: /home/ywx389445/z_ss/a_spc010/c_sdk/source/wifi_project/drv/sdio_hi1131sv100/hi1131_driver/driver/platform/inc/oal/liteos/arch/o\n6302796       0x602C4C        Unix path: /home/ywx389445/z_ss/a_spc010/c_sdk/source/wifi_project/drv/sdio_hi1131sv100/hi1131_driver/driver/platform/inc/oal/liteos/arch/o\n6435024       0x6230D0        CRC32 polynomial table, little endian\n6439120       0x6240D0        CRC32 polynomial table, big endian\n6448960       0x626740        CRC32 polynomial table, little endian\n6450040       0x626B78        Unix path: /home/linux/share/code/meari/liteos/liteos_v1.0.0.5/compat/linux/src/completion.c\n</code></pre>\n<p>Here is the file:\n<a href=\"https://drive.google.com/file/d/1mtbAi90BkNAlZ1O501q4dSIY4sRY7xP9/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/1mtbAi90BkNAlZ1O501q4dSIY4sRY7xP9/view?usp=sharing</a></p>\n<p>Any ideas?</p>\n</div>",
    "votes": "1",
    "answers": 1,
    "views": "619",
    "tags": [
        "firmware",
        "linux"
    ],
    "user": "justin",
    "time": "Sep 20, 2020 at 15:46",
    "comments": [
        {
            "user": "Biswapriyo",
            "text": "<span class=\"comment-copy\">Use <code>dd</code> to extract the section of the file that you're interested. Tell <code>dd</code> the starting position, how many bytes you want to extract and the file names.</span>",
            "time": null
        }
    ],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>Really need more info from you to be useful. What's the camera? What's the larger bin file that <code>app.img</code> came from? How did you extract <code>app.img</code> from that bin file with <code>binwalk</code>?</p>\n<p>That said, I took a brief look. <code>app.img</code> is ARM little endian, probably v7, and you can load it into Ghidra. I'm not sure what the base address is. From googling an identifying string in the binary (<code>hi3518ev300</code>), I came across some links that may prove useful.</p>\n<ul>\n<li><a href=\"http://www.hisilicon.com/-/media/Hisilicon/pdf/Surveillance_mobilecam/Hi3518EV300.pdf\" rel=\"nofollow noreferrer\">http://www.hisilicon.com/-/media/Hisilicon/pdf/Surveillance_mobilecam/Hi3518EV300.pdf</a></li>\n<li><a href=\"https://sasecurity.fandom.com/wiki/Hi3518E_IP_Camera\" rel=\"nofollow noreferrer\">https://sasecurity.fandom.com/wiki/Hi3518E_IP_Camera</a></li>\n<li><a href=\"http://web.archive.org/web/20180418081631/https://felipe.astroza.cl/hacking-hi3518-based-ip-camera/\" rel=\"nofollow noreferrer\">http://web.archive.org/web/20180418081631/https://felipe.astroza.cl/hacking-hi3518-based-ip-camera/</a></li>\n<li><a href=\"https://cdn.hackaday.io/files/19356828127104/Hi3518%20DataSheet.pdf\" rel=\"nofollow noreferrer\">https://cdn.hackaday.io/files/19356828127104/Hi3518%20DataSheet.pdf</a></li>\n<li><a href=\"https://gist.github.com/JanLoebel/b5dafcda555323785d32ccb7d643dbcd\" rel=\"nofollow noreferrer\">https://gist.github.com/JanLoebel/b5dafcda555323785d32ccb7d643dbcd</a></li>\n<li><a href=\"https://gist.github.com/gabonator/3d2bc36e9eb62c52742d45113126c1ba\" rel=\"nofollow noreferrer\">https://gist.github.com/gabonator/3d2bc36e9eb62c52742d45113126c1ba</a></li>\n<li><a href=\"https://github.com/PeterEmbedded/Hi3518E-IP-Camera\" rel=\"nofollow noreferrer\">https://github.com/PeterEmbedded/Hi3518E-IP-Camera</a></li>\n<li><a href=\"http://marcusjenkins.com/hacking-cheap-ebay-ip-camera/\" rel=\"nofollow noreferrer\">http://marcusjenkins.com/hacking-cheap-ebay-ip-camera/</a></li>\n<li><a href=\"https://www.burglaryalarmsystem.com/technology-news/china-ip-camera-configuration-firmware.html\" rel=\"nofollow noreferrer\">https://www.burglaryalarmsystem.com/technology-news/china-ip-camera-configuration-firmware.html</a></li>\n</ul>\n</div>",
            "votes": "2",
            "user": "hairlessbear",
            "time": "Sep 25, 2020 at 18:09",
            "is_accepted": false,
            "comments": [
                {
                    "user": "justin",
                    "text": "<span class=\"comment-copy\">Thanks for the help - here is the larger bin file: <a href=\"http://cdn-meari-us-oss-us-west-1.meari.com.cn/firmware/gray/ppstrong-b5-ctv-3.2.1.20200708-upgrade.bin\" rel=\"nofollow noreferrer\">cdn-meari-us-oss-us-west-1.meari.com.cn/firmware/gray/…</a> and the camera is a Zumimall \"Wireless Rechargeable Battery Powered WiFi Camera\".</span>",
                    "time": null
                }
            ]
        }
    ]
}