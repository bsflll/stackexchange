{
    "title": "Decompiling .pyc file to 0 byte .py file",
    "link": "https://reverseengineering.stackexchange.com/questions/24835/decompiling-pyc-file-to-0-byte-py-file",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>i am doing the CTF-like challenges. One of these tasks need us to decompiling <strong>Python bytecode 3.8</strong> (.pyc file) into py file. However, the py file that generated by pyc file is 0 byte\nThe original file's name is <code>flag.py</code> Here are my procedures.</p>\n<ol>\n<li><p>Rename the file: <code>flag.py</code> -&gt; <code>flag.pyc</code></p></li>\n<li><p>Use <code>uncompyle6</code>tool and type command: <code>uncompyle6 flag.pyc &gt; flag.py</code> </p></li>\n<li><p>It will generate <code>flag.py</code> file, however it is <strong>0 byte</strong>. And <strong>after several hours</strong>, it is still <strong>0 byte</strong>.</p></li>\n<li><p>If i interrupt the command line tool by keyboard, the <code>flag.py</code> file will have the comment:</p></li>\n</ol>\n<pre><code> uncompyle6 version 3.6.6\n Python bytecode 3.8 (3413)\n Decompiled from: Python 3.8.0 \n [GCC 4.2.1 Compatible Clang 4.0.1 (tags/RELEASE_401/final)]\n Embedded file name: flag.o.py\n Compiled at: 2020-04-24 16:09:51\n Size of source mod 2**32: 2476187 bytes\n</code></pre>\n<p>My environment is MacOS, Python 3.8.0. </p>\n<p>The .pyc file is small and I've already checked the magic number of the file's header, it is Python 3.8.0.\nThe unusual thing of this pyc file is that there are several thousands of <code>ff 00</code> at the end of the file. </p>\n<pre><code>55 0d 0d 0a 00 00 00 00\n...\nff 00 ff 00 ff 00 ff 00 \n...\nff 00 ff 00 ff 00 ff 00 \nb9 01 0c 06 0a 01 08 01\n\n</code></pre>\n<p>Any Suggestions?</p>\n</div>",
    "votes": "3",
    "answers": 1,
    "views": "5k",
    "tags": [
        "python",
        "decompile"
    ],
    "user": "FRANKfisher",
    "time": "Apr 26, 2020 at 13:58",
    "comments": [],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>It's possible that the <em>pyc</em> file is obfuscated/malformed in a way that it trips uncompyle6. Rather than decompiling you can try disassembling the file instead.</p>\n<p>The <a href=\"https://docs.python.org/3/library/dis.html\" rel=\"nofollow noreferrer\"><code>dis</code></a> module can disassemble Python bytecode. You can use it as follows.</p>\n<pre><code>import marshal, dis\n\nf = open(\"flag.pyc\", \"rb\")\nf.seek(16) # Skip 16 byte header (for Python 3.8)\nco = marshal.load(f)\nprint(dis.dis(co))\n</code></pre>\n<p>There also exists other Python disassemblers libraries like <a href=\"https://github.com/rocky/python-xdis\" rel=\"nofollow noreferrer\"><code>xdis</code></a>. After installing the package (<code>pip install xdis</code>) you can simply run <code>pydisasm flag.pyc</code> to disassemble the <em>pyc</em>.</p>\n<p>Once you have figured out the reason it trips uncompyle6, you can remove those parts and re-assemble a corrected <em>pyc</em> using <a href=\"https://github.com/rocky/python-xasm\" rel=\"nofollow noreferrer\">xasm</a> which can then be decompiled.</p>\n</div>",
            "votes": "3",
            "user": "0xec",
            "time": "Apr 26, 2020 at 17:24",
            "is_accepted": true,
            "comments": [
                {
                    "user": "FRANKfisher",
                    "text": "<span class=\"comment-copy\">Hi, @0xec.Thanks for your answer! I have disassembled the .pyc file. However, i am not sure how to figure out the reason. Could you give me a hint? Thank you so much!</span>",
                    "time": null
                },
                {
                    "user": "0xec",
                    "text": "<span class=\"comment-copy\">@FRANKfisher Please add the disassembled code or the pyc file to the question. Without that it's difficult to answer.</span>",
                    "time": null
                }
            ]
        }
    ]
}