{
    "title": "Identifying the logic in remote control data packets",
    "link": "https://reverseengineering.stackexchange.com/questions/29946/identifying-the-logic-in-remote-control-data-packets",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>I have a set of 4 power sockets that can be turned on and off with an RF remote.\nThat remote has 4 pairs of on/off buttons along with a master pair that can control all sockets at once.</p>\n<p>Initially, the power sockets do not know about the remote, one needs to \"program\" the socket by pressing the desired \"ON\" button while the socket is in learning mode.</p>\n<p>Sniffing the 433MHz signal is quite easily done and repeating captured signals works just fine, so there does not appear to be any kind of security here.</p>\n<p>Out of curiosity, I wanted to understand the structure of data sent to these sockets and have figured out that it's made of 24 bits with the following structure:</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>Nibble</th>\n<th>Usage</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>5</td>\n<td>Remote Id</td>\n</tr>\n<tr>\n<td>1-4</td>\n<td>Action code</td>\n</tr>\n<tr>\n<td>0</td>\n<td>Button Id</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>So for instance, if I receive <code>5ae940</code>, the Remote Id is <code>5</code>, the Button Id is <code>0</code> and the action code is <code>ae94</code></p>\n<p>Recording multiple button presses, I discovered that the same button, On for A channel for instance, rolls between 4 possible action codes. And using a second set of power sockets bought 3 years ago shows that they are cross compatible with the newer one, with a different set of 4 possible action codes.</p>\n<p>When placing the power socket in learning mode, there is only one button press needed, so the socket itself has a way to identify any of the four possible action codes as equivalent to the one it has learnt.</p>\n<p>What I have a hard time figuring out is what makes those 4 possible action codes related to each other.</p>\n<p>Here are the captured packets and their associated action:</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>Set year</th>\n<th>A<br/>On</th>\n<th>A<br/>Off</th>\n<th>B<br/>On</th>\n<th>B<br/>Off</th>\n<th>C<br/>On</th>\n<th>C<br/>Off</th>\n<th>D<br/>On</th>\n<th>D<br/>Off</th>\n<th>Master<br/>On</th>\n<th>Master<br/>Off</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>2019</td>\n<td><code>bf756c</code><br/><code>b7441c</code><br/><code>bd9c5c</code><br/><code>be3aac</code></td>\n<td><code>b20e7c</code><br/><code>b5212c</code><br/><code>b9d88c</code><br/><code>b8c0bc</code></td>\n<td><code>b6af35</code><br/><code>b453f5</code><br/><code>b0f6e5</code><br/><code>bc1705</code></td>\n<td><code>b16bc5</code><br/><code>b3b995</code><br/><code>bb8dd5</code><br/><code>bae245</code></td>\n<td><code>b20e7e</code><br/><code>b5212e</code><br/><code>b9d88e</code><br/><code>b8c0be</code></td>\n<td><code>bf756e</code><br/><code>b7441e</code><br/><code>bd9c5e</code><br/><code>be3aaz</code></td>\n<td><code>b16bc7</code><br/><code>b3b997</code><br/><code>bb8dd7</code><br/><code>bae247</code></td>\n<td><code>b6af37</code><br/><code>b453f7</code><br/><code>b0f6e7</code><br/><code>bc1707</code></td>\n<td><code>b20e72</code><br/><code>b52122</code><br/><code>b9d882</code><br/><code>b8c0b2</code></td>\n<td><code>bf7562</code><br/><code>b74412</code><br/><code>bd9c52</code><br/><code>be3aa2</code></td>\n</tr>\n<tr>\n<td>2022</td>\n<td><code>5ae940</code><br/><code>592870</code><br/><code>52acb0</code><br/><code>530d30</code></td>\n<td><code>5814a0</code><br/><code>5d5b20</code><br/><code>54cf10</code><br/><code>559090</code></td>\n<td><code>5ae944</code><br/><code>592874</code><br/><code>52acb4</code><br/><code>530d34</code></td>\n<td><code>5814a4</code><br/><code>5d5b24</code><br/><code>54cf14</code><br/><code>559094</code></td>\n<td><code>5ae94c</code><br/><code>59287c</code><br/><code>52acbc</code><br/><code>530d3c</code></td>\n<td><code>5814ac</code><br/><code>5d5b2c</code><br/><code>54cf1c</code><br/><code>55909c</code></td>\n<td><code>5814a2</code><br/><code>5d5b22</code><br/><code>54cf12</code><br/><code>559092</code></td>\n<td><code>5ae942</code><br/><code>592872</code><br/><code>52acb2</code><br/><code>530d32</code></td>\n<td><code>5814aa</code><br/><code>5d5b2a</code><br/><code>54cf1a</code><br/><code>55909a</code></td>\n<td><code>5ae94a</code><br/><code>59287a</code><br/><code>52acba</code><br/><code>530d3a</code></td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>So in 2019, I bought remote with Id <code>b</code> and in 2002 the new remote has Id <code>5</code></p>\n<p>What can be seen is that if bit 1 of the button Id is set, then the meaning of the action code is reversed.</p>\n<p>What I could not figure out yet is how to detect that a given button Id is the \"Master\" one for the remote. For remote <code>5</code>, it could be because <code>a</code> is the binary complement of the remote Id, but this does not work for remote Id <code>b</code></p>\n<p>And as already mentioned above, I cannot figure out the logic that connects together any given set of 4 action codes. As a reference, here are the 6 sets I have so far:</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>Set 1</th>\n<th>Set 2</th>\n<th>Set 3</th>\n<th>Set 4</th>\n<th>Set 5</th>\n<th>Set 6</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>f756</code><br/><code>7441</code><br/><code>d9c5</code><br/><code>e3aa</code></td>\n<td><code>20e7</code><br/><code>5212</code><br/><code>9d88</code><br/><code>8c0b</code></td>\n<td><code>6af3</code><br/><code>453f</code><br/><code>0f6e</code><br/><code>c170</code></td>\n<td><code>16bc</code><br/><code>3b99</code><br/><code>b8dd</code><br/><code>ae24</code></td>\n<td><code>ae94</code><br/><code>9287</code><br/><code>2acb</code><br/><code>30d3</code></td>\n<td><code>814a</code><br/><code>d5b2</code><br/><code>4cf1</code><br/><code>5909</code></td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>I have tried various things like xor-ing, and-ing, or-ing values in a group, comparing bits set to 1 in any given values but I could not figure out what makes those group of 4 values related to each other.</p>\n<p>I understand that this is quite a lengthy message, but I wanted to make sure that I share all the discoveries I made into this endeavor.</p>\n<p>I totally admit that I can store the above 6 sets of values in a constant array and be done with it, but this would leave an itch in my brain...</p>\n<p>Many thanks in advance for any suggestions, things to try, hints...</p>\n<hr/>\n<p><strong>EDIT 2002 02 05</strong></p>\n<p>The remote appears to have a global value indicated which of the next four possible values is to be used.</p>\n<p>If we consider the 2022 remote, On button A is in the <code>ae94</code>, <code>9287</code>, <code>2acb</code>, <code>30d3</code> group and On button D is in the <code>814a</code>, <code>d5b2</code>, <code>4cf1</code>, <code>5909</code> group.<br>\nHere are the codes used following the button presses in that sequence:</br></p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>Button</th>\n<th>Code used</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>On A</td>\n<td><code>ae94</code></td>\n</tr>\n<tr>\n<td>On D</td>\n<td><code>d5b2</code></td>\n</tr>\n<tr>\n<td>On A</td>\n<td><code>2acb</code></td>\n</tr>\n<tr>\n<td>On A</td>\n<td><code>30d3</code></td>\n</tr>\n<tr>\n<td>On D</td>\n<td><code>814a</code></td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>As you can see, some values are \"skipped\" because another button was pressed.</p>\n<p>Taking the battery off for a while and placing it back on does not change the codes that are sent by the remote.</p>\n<p>Both sets are sold by LIDL under the Silvercrest brand, the one from 2019 having those references:</p>\n<p>IAN 284705<br>\nArticle# 1 04772 1706</br></p>\n<p>While the one from 2022 has those:</p>\n<p>Reference 36626_2101<br>\nModel 8 50 50 00066</br></p>\n<p>Both remotes look like this:</p>\n<p><a href=\"https://i.sstatic.net/X5TUu.jpg\" rel=\"nofollow noreferrer\"><img alt=\"Silvercrest remote\" src=\"https://i.sstatic.net/X5TUu.jpg\"/></a></p>\n<p>The whole point of this research is to be able to make the plugin for the <a href=\"https://github.com/cpainchaud/RFLink32/blob/master/RFLink/Plugins/Plugin_016.c\" rel=\"nofollow noreferrer\">RFLink32</a> project much more flexible. Indeed, it currently uses the \"truth table\" approach which only works with my own set of sockets.</p>\n</div>",
    "votes": "2",
    "answers": 1,
    "views": "98",
    "tags": [
        "radio-interception"
    ],
    "user": "OBones",
    "time": "Feb 5, 2022 at 14:58",
    "comments": [],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>is the next step in a sequence of on action like</p>\n<pre><code>f756\n7441\nd9c5\ne3aa\n</code></pre>\n<p>the same, also when another action comes in between?\nDid you tried if action code is generated in some way by remote id, button id, 1-4 (0-3)?\nI think in learning mode it needs only to learn remote id, and other are known by algorithm used.</p>\n<p><strong>Edit 220205</strong></p>\n<p>so there is a counter# 0-3 to consider. Just an idea to work out: you have input remote id, button id, counter# and action will be calculated by CRC-16 (because of variability of codes) or whatever.\nTo be clear: I'm not expert in that matter, just sharing my ideas as I'm working on similar issue.</p>\n<p><strong>Edit 220212</strong></p>\n<p>Looking over the dataset again, I think it is possible just to do some assumptions for the algorithm behind, some of them can be tested, some not, just because of lack of data.</p>\n<ol>\n<li>I agree that remoteID is nibble#1, maybe hardcoded or as per DIP switch in remote</li>\n<li>nibble#5 is switchID as you said, and I think its generated by algorithm. All sockets need to know independent from remote  what switchID the master is, depending on send remoteID, specifically a \"2\" could be code for socket \"D\" or master.\nAssumption could be, that switchID for master is \"<code>remoteID ^ F</code>\" and \"<code>remoteID ^ 9</code>\" depending on bit1 at remoteIDs is set or not. The same works similar with bit2 set or not set for remoteID. Several other methods are possible, but cannot be verified due to lack of data with other remoteIDs. Maybe there is also a method that works for all remoteID, without any \"if-clause\".</li>\n<li>I think, for actionCode there is not any roting code needed for proper work. When \"A\"-On is pressed, then pressing 3 other buttons, and again \"A\"-on it will send the same message again. For me the 4 options seems just obfuscation. At least for \"2022\" remote it's worth to try with only one code for \"On\" and \"off\" each. And if that is true, why not also for \"2019\" remote?\nThis theory can be easily verified: switch on \"A\", press 3 times a button and remote is far away from socket, then again \"A\" off. When this repeated key is accepted, no rotating code is needed.\nHowever, this doesn't give any clue at the moment how action code is generated.</li>\n</ol>\n<p><strong>Edit 220213</strong></p>\n<p>In some articles on this remote I have found my assumption confirmed that no rolling code is needed to switch on/off. A single action code per remoteID should suffice.\nHowever the method to generate the action code is unknown, since almost 10 years now. Best information seems to be a semi-encryption method using table substitution <a href=\"https://www.mikrocontroller.net/topic/468243\" rel=\"nofollow noreferrer\">here</a>, \"AnBan\". Sometimes it is called Quigg GT-1000 protocol, details also unknown. As it comes to the point that a 14Pin chip inside generates the codes all discussions ends without better result.\nMaybe someone else being more clever will find out the details.</p>\n</div>",
            "votes": "3",
            "user": "dieter reichl",
            "time": "Mar 7, 2022 at 12:59",
            "is_accepted": false,
            "comments": []
        }
    ]
}