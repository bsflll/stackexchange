{
    "title": "What values do I use for Freescale ARM imx233 μP in IDA Pro “memory layout dialog” for RAM and ROM?",
    "link": "https://reverseengineering.stackexchange.com/questions/13762/what-values-do-i-use-for-freescale-arm-imx233-%ce%bcp-in-ida-pro-memory-layout-dialo",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>What is the memory address information I should plug into IDA for this BIN file?</p>\n<p><strong>GOAL</strong>:</p>\n<p>To disassemble a BIN file extracted from firmware.sb</p>\n<p>This BIN file contains the low level board initialization, SDRAM clocks, power, Interrupt Controller, LCD, duart, and more.</p>\n<p>I need the values passed to the LCD, duart and other to know what exact hardware my board uses and to know if firmware for an earlier board will work on a later board.</p>\n<p>I will use these values to create linux drivers at a later date. (LCD)</p>\n<p>Ref this <a href=\"https://reverseengineering.stackexchange.com/questions/13720/how-to-make-freescale-imx233-mp3-player-boot-with-identical-type-player-firmware\">question</a>.</p>\n<p><strong>BACKGROUND INFO</strong>:</p>\n<p>Board initialization sequence:</p>\n<p>Part of the this BIN file is loaded into the on chip RAM (OCRAM) for minimal board init. \nThis code is executed and will init the rest of the board most important for this question the SDRAM.\nMore of this BIN file will load into the SDRAM then execute and init the rest of the board. This BIN will then load and pass control to the OS. </p>\n<p>Basically a boot loader.</p>\n<p>Here is a simple example of this using my custom u-boot and kernel. Oversimplified and information removed for brevity. Actual <a href=\"http://pastebin.com/yRxf1svF\" rel=\"nofollow noreferrer\">BIN file</a> info.</p>\n<pre><code>LOAD    addr=0x00001000 len=0x00001ef4\nCALL    addr=0x00001000 arg=0x00000000\nLOAD    addr=0x40002000 len=0x000368ec\nLOAD    addr=0x40600000 len=0x002ed3c8\nLOAD    addr=0x40a00000 len=0x00002b1e\nCALL    addr=0x40002000 arg=0x00000000\n</code></pre>\n<p>This is part of the <a href=\"http://www.icpdf.com/FREESCALE_datasheet/MCIMX233DAG4B_pdf_12997699/MCIMX233DAG4B_1529.html\" rel=\"nofollow noreferrer\">memory map</a> for this μP.</p>\n<pre><code>OCRAM 0x00000000 - 0x00007FFF 32KB\nSDRAM 0x40000000 - 0x5FFFFFFF 512MB\nPeripherals 0x80000000 - 0xBFFFFFFF\n</code></pre>\n<p>Example of <a href=\"http://www.icpdf.com/FREESCALE_datasheet/MCIMX233DAG4B_pdf_12997699/MCIMX233DAG4B_1530.html\" rel=\"nofollow noreferrer\">Peripherals</a>:</p>\n<pre><code>CLKCTRL 0x80040000 - 0x80041FFF\nDBGUART 0x80070000 - 0x80071FFF\n</code></pre>\n<p>The μP is a Freescale mx23 or imx233.</p>\n<p>This board has 16MB SDRAM 0x40000000 - 0x01000000</p>\n<p>In the “ARM architecture options” <a href=\"http://3.bp.blogspot.com/-COKB6o6fBJE/Ubd4-TUSzYI/AAAAAAAAAQw/km7kDeNoUB8/s1600/Screen+Shot+2013-06-11+at+9.21.48+PM.png\" rel=\"nofollow noreferrer\">dialog</a> I set:</p>\n<p>Base architecture as <strong>ARMv5TEJ</strong>.</p>\n<p>VFP instructions as <strong>NONE</strong></p>\n<p>Thumb instructions as <strong>Thumb</strong></p>\n<hr/>\n<p>In the “Disassembly memory organization” <a href=\"http://4.bp.blogspot.com/-ioHEcxtZQk8/Ubd2BBkIdlI/AAAAAAAAAQI/pCalNgAYN9M/s1600/Screen+Shot+2013-06-11+at+9.06.42+PM.png\" rel=\"nofollow noreferrer\">dialog</a> I am unsure what to set.</p>\n<p>Is the RAM section my SDRAM, 0x40000000 - 0x01000000?</p>\n<p>Is the ROM section my OCRAM, 0x00000000 - 0x00007FFF?</p>\n<p>What about Input file loading address, file offset, loading size?</p>\n<p>Would the loading size be the 16MB of my SDRAM?</p>\n<p>Where does the peripherals addresses go?</p>\n</div>",
    "votes": "2",
    "answers": 1,
    "views": "524",
    "tags": [
        "ida",
        "disassembly",
        "arm",
        "memory"
    ],
    "user": "jc__",
    "time": "Apr 13, 2017 at 12:49",
    "comments": [],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>I'll make this brief:</p>\n<blockquote>\n<p>Is the RAM section my SDRAM, 0x40000000 - 0x01000000?</p>\n</blockquote>\n<p>Yes, this is correct. But AFAIK not too important. IDA will create different segment for different code parts based on this input, but will handle fine which ever values are entered.</p>\n<blockquote>\n<p>Is the ROM section my OCRAM, 0x00000000 - 0x00007FFF?</p>\n</blockquote>\n<p>Yes, this is again correct but again AFAIK it's not too important.</p>\n<blockquote>\n<p>What about Input file loading address, file offset, loading size?</p>\n</blockquote>\n<p>for low-level code executed, and especially for boot loaders, the loading address should be specified in the chip's datasheet.</p>\n<blockquote>\n<p>Would the loading size be the 16MB of my SDRAM?</p>\n</blockquote>\n<p>Yep. IDA will add the RAM address space as an additional segment for you.</p>\n<blockquote>\n<p>Where does the peripherals addresses go?</p>\n</blockquote>\n<p>IDA doesn't explicitly support peripherals, you'll need to include those in your RAM definition or create a different segment manually after the file is loaded. You'll need to manually specify what peripheral is exposed at each address either by adding different segments for different peripherals or by creating and naming variables/structures. </p>\n</div>",
            "votes": "1",
            "user": "NirIzr",
            "time": "Oct 19, 2016 at 21:32",
            "is_accepted": true,
            "comments": []
        }
    ]
}