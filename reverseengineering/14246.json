{
    "title": "Write own obfuscator in Python [closed]",
    "link": "https://reverseengineering.stackexchange.com/questions/14246/write-own-obfuscator-in-python",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<div>\n<aside class=\"s-notice s-notice__info post-notice js-post-notice mb16\" role=\"status\">\n<div class=\"d-flex fd-column fw-nowrap\">\n<div class=\"d-flex fw-nowrap\">\n<div class=\"flex--item wmn0 fl1 lh-lg\">\n<div class=\"flex--item fl1 lh-lg\">\n<div>\n<b>Closed</b>. This question needs to be more <a href=\"/help/closed-questions\">focused</a>. It is not currently accepting answers.\n                                \n                            </div>\n</div>\n</div>\n</div>\n</div>\n<hr class=\"my12 outline-none baw0 bb bc-blue-400\"/>\n<div class=\"fw-nowrap fc-black-500\">\n<div class=\"d-flex fd-column lh-md\">\n<div class=\"mb0 d-flex\">\n<div class=\"flex--item mr8\">\n<svg aria-hidden=\"true\" class=\"svg-icon iconLightbulb\" height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M15 6.38A6.5 6.5 0 0 0 7.78.04h-.02A6.5 6.5 0 0 0 2.05 5.6a6.3 6.3 0 0 0 2.39 5.75c.49.39.76.93.76 1.5v.24c0 1.07.89 1.9 1.92 1.9h2.75c1.04 0 1.92-.83 1.92-1.9v-.2c0-.6.26-1.15.7-1.48A6.3 6.3 0 0 0 15 6.37M4.03 5.85A4.5 4.5 0 0 1 8 2.02a4.5 4.5 0 0 1 5 4.36 4.3 4.3 0 0 1-1.72 3.44c-.98.74-1.5 1.9-1.5 3.08v.1H7.2v-.14c0-1.23-.6-2.34-1.53-3.07a4.3 4.3 0 0 1-1.64-3.94M10 18a1 1 0 0 0 0-2H7a1 1 0 1 0 0 2z\"></path></svg>\n</div>\n<p><b>Want to improve this question?</b> Update the question so it focuses on one problem only by <a href=\"/posts/14246/edit\">editing this post</a>.</p>\n</div>\n<div class=\"mb0 mt6 d-flex\">\n<p class=\"ml24 pl2\">Closed <span class=\"relativetime\" title=\"2016-12-27 12:02:39Z\">8 years ago</span>.</p>\n</div>\n<div class=\"ml24 pl2\">\n</div>\n</div>\n</div>\n<div class=\"mt24 d-flex gsx gs8\">\n<a class=\"s-btn s-btn__outlined flex--item js-post-notice-edit-post\" href=\"/posts/14246/edit\">\n                        Improve this question\n                    </a>\n</div>\n</aside>\n</div>\n<p>I want to create my own, static obfuscator for any executables. What is the best way to do it with python? How should I start or what sources should I learn to do it? Anyon can give me some tips or links connected with this topic?</p>\n</div>",
    "votes": "0",
    "answers": 1,
    "views": "1k",
    "tags": [
        "python"
    ],
    "user": "Developus",
    "time": "8 years ago",
    "comments": [],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>You should start with reading documents.\nYour problem definition is too broad to be covered by reading sources of already existing solutions. </p>\n<ol>\n<li>You need to learn the executable formats you are intending to work with, \"any executable\" is too broad (ELF, PE, jar, whatever else ?)</li>\n<li>You need to learn the platform architecture (is it ARM, MIPS, x64 ?)</li>\n<li>After that you need to define the list of obfuscating transformations you want to apply to the executable of type of your choice .</li>\n<li>All the rest depends very much on the list of the transformations and information you'll have to apply these transformations.</li>\n</ol>\n<p>Here is the reading list (unfortunately, it is far from being covering the whole problem) </p>\n<ol>\n<li><a href=\"https://researchspace.auckland.ac.nz/bitstream/handle/2292/3491/TR148.pdf\" rel=\"nofollow noreferrer\">Taxonomy of obfuscating transformations - classic work by Collberg and others </a></li>\n<li><a href=\"https://dspace.mit.edu/handle/1721.1/64489#files-area\" rel=\"nofollow noreferrer\">Studies in program obfuscation - if you want to have some theoretical background on math around the obfuscation</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Portable_Executable\" rel=\"nofollow noreferrer\">PE format - go by links from wiki, there are a lot</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Executable_and_Linkable_Format\" rel=\"nofollow noreferrer\">ELF format - the same if you want to obfuscate elf executables</a></li>\n<li><a href=\"https://software.intel.com/en-us/articles/intel-sdm\" rel=\"nofollow noreferrer\">Intel SDM - the best and definitive definition of Intel processors assembly language, replace it with similar document about your platform if you choose to obfuscate non-intel binaries</a></li>\n<li><a href=\"https://tuts4you.com/download.php?list.86\" rel=\"nofollow noreferrer\">tuts2you downloads section related to obfuscation - some articles inside</a></li>\n<li>In addition I'd recommend you to follow @Rolf Rolles, he wrote some excellent articles on deobfuscation, such as <a href=\"http://www.openrce.org/articles/full_view/28\" rel=\"nofollow noreferrer\">this</a> or <a href=\"https://www.usenix.org/legacy/events/woot09/tech/full_papers/rolles.pdf\" rel=\"nofollow noreferrer\">this</a>.</li>\n</ol>\n<p>After reading this you'll be able to search for more fine-grained information.</p>\n<p>The most approachable methodology to deal with the issue is using <a href=\"http://llvm.org\" rel=\"nofollow noreferrer\">LLVM</a>.\nLLVM has python bindings that probably can be used for this.\nThere are some works related to obfuscation with this methodology, but none of them has complete solution in python, for example</p>\n<ol>\n<li><a href=\"http://0vercl0k.tuxfamily.org/bl0g/?p=260\" rel=\"nofollow noreferrer\">Example of simple obfuscator with LLVM</a></li>\n<li><a href=\"https://github.com/obfuscator-llvm/obfuscator/\" rel=\"nofollow noreferrer\">You'll probably find something interesting here, more invested LLVM based obfuscator</a></li>\n<li><a href=\"http://blog.quarkslab.com/deobfuscation-recovering-an-ollvm-protected-program.html\" rel=\"nofollow noreferrer\">By the way, here is work on deobfuscating results of one of version of obfuscator mentioned before</a></li>\n<li><a href=\"https://github.com/trailofbits/mcsema\" rel=\"nofollow noreferrer\">McSema - a framework for transforming executable to LLVM IR.</a> - you'll need it to read the executable and transform it into the form related to LLVM.</li>\n</ol>\n<p>Your question is actually huge, and I'm far from covering the topic.\nHowever this topic is very interesting, and I wish you good luck with that :)</p>\n<p>UPDATE: </p>\n<p>As it appears from comments the topic starter wants to write as a starter something similar to UPX, which looks much simpler.</p>\n<p>Here is a list of links that may be helpful for that:</p>\n<ol>\n<li><a href=\"https://github.com/upx/upx\" rel=\"nofollow noreferrer\">UPX source code</a> - it is not python, but good for reference</li>\n<li><a href=\"https://github.com/erocarrera/pefile\" rel=\"nofollow noreferrer\">pefile</a> is a multi-platform Python module to parse and work with Portable Executable (aka PE) files.</li>\n</ol>\n<p>I'd suggest to learn PE format first, and read the code of UPX.</p>\n</div>",
            "votes": "2",
            "user": "w s",
            "time": "Dec 26, 2016 at 11:39",
            "is_accepted": true,
            "comments": [
                {
                    "user": "Developus",
                    "text": "<span class=\"comment-copy\">Thanks so much. I know that question is too broad. I want to create an obfuscator for PE files first. Platform architecure is x64. So at the beginning I should understand the form I want to obfuscate and then go deepper? I'm interesting in RE, but in practical side I decided to create something like UPX packer.</span>",
                    "time": null
                },
                {
                    "user": "w s",
                    "text": "<span class=\"comment-copy\">You need to understand the form (PE) - or you'll not be able to create a valid executable, the platform (x64) - or you'll not be able to add something meaningful to the executable, and you need to choose specific obfuscating transformations set to apply. UPX, by the way, is not obfuscator, but packer: it scrambles and archives IAT and the original code and AFIK unpacks it prior to the execution.</span>",
                    "time": null
                },
                {
                    "user": "Developus",
                    "text": "<span class=\"comment-copy\">So maybe at the begining, write own packer instead of obfuscator would be simpler? I should try same way - learn PE format and go step by step through your list?</span>",
                    "time": null
                },
                {
                    "user": "w s",
                    "text": "<span class=\"comment-copy\">I'll update the answer</span>",
                    "time": null
                }
            ]
        }
    ]
}