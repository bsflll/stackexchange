{
    "title": "How to get which Tedit is referenced when retrieving text",
    "link": "https://reverseengineering.stackexchange.com/questions/32957/how-to-get-which-tedit-is-referenced-when-retrieving-text",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>Reversing a borland builder 6 application, I came across this function: @Controls@TControl@GetText$qqrv</p>\n<p>Now, the two parameters for the function are:</p>\n<pre><code>LEA param_2=&gt;local_8,[EBP + -0x4]\nMOV param_1,dword ptr [param_1 + 0x288]\n</code></pre>\n<p>I know that param_2 is the address where the returned value of the function will be stored.</p>\n<p>I know that param_1 is the address of the address of the form, so param_1 is 050f6d70. I go there and find address D83F4400 (00443FD8) I right click the address and choose follow in dump, at 00443FD8 I find some sort of form:</p>\n<pre><code>00443FD8  FC EA 47 00 B4 19 47 00 F8 E9 47 00 78 2E 48 00  üêG.´.G.øéG.x.H.  \n00443FE8  04 09 47 00 A0 21 47 00 CC 0D 47 00 00 32 48 00  ..G. !G.Ì.G..2H.  \n00443FF8  94 2E 48 00 8C 2E 48 00 64 7B 44 00 F4 4C 47 00  ..H...H.d{D.ôLG.  \n00444008  14 4D 47 00 CC 4A 47 00 BC 07 47 00 70 08 47 00  .MG.ÌJG.¼.G.p.G.  \n00444018  B4 0E 47 00 6C 31 47 00 64 4B 47 00 E0 4B 47 00  ´.G.l1G.dKG.àKG.  \n00444028  28 47 47 00 C4 4B 47 00 84 25 47 00 70 2D 47 00  (GG.ÄKG..%G.p-G.  \n00444038  6C 80 44 00 70 2C 47 00 28 81 44 00 0C 2D 47 00  l.D.p,G.(.D..-G.  \n00444048  CC 81 44 00 A4 34 47 00 80 49 47 00 60 4C 47 00  Ì.D.¤4G..IG.`LG.  \n00444058  10 7C 44 00 4C 7E 44 00 08 7E 44 00 D0 7F 44 00  .|D.L~D..~D.Ð.D.  \n00444068  7C 7E 44 00 2C 7E 44 00 E0 7E 44 00 34 7F 44 00  |~D.,~D.à~D.4.D.  \n00444078  05 54 45 64 69 74 90 90 84 40 44 00 07 05 54 45  <a class=\"__cf_email__\" data-cfemail=\"725c2637161b065c5c5c32365c5c5c2637\" href=\"/cdn-cgi/l/email-protection\">[email protected]</a>  \n00444088  64 69 74 D8 3F 44 00 44 3F 44 00 33 00 08 53 74  ditØ?D.D?D.3..St  \n00444098  64 43 74 72 6C 73 2A 00 BC DD 48 00 20 01 00 FF  dCtrls*.¼ÝH. ..ÿ  \n004440A8  20 01 00 FF 01 00 00 00 00 00 00 80 01 00 00 00   ..ÿ............  \n004440B8  0A 00 0A 41 75 74 6F 53 65 6C 65 63 74 BC DD 48  ...AutoSelect¼ÝH  \n004440C8  00 1F 01 00 FF 30 7C 44 00 01 00 00 00 00 00 00  ....ÿ0|D........  \n004440D8  80 01 00 00 00 0B 00 08 41 75 74 6F 53 69 7A 65  ........AutoSize  \n004440E8  60 20 46 00 1C 01 00 FF 44 7C 44 00 01 00 00 00  ` F....ÿD|D.....  \n004440F8  00 00 00 80 01 00 00 00 0C 00 0B 42 6F 72 64 65  ...........Borde  \n00444108  72 53 74 79 6C 65 DC 3D 44 00 23 01 00 FF 68 7C  rStyleÜ=D.#..ÿh|  \n00444118  44 00 01 00 00 00 00 00 00 80 00 00 00 00 0D 00  D...............  \n00444128  08 43 68 61 72 43 61 73 65 2C 89 45 00 54 00 00  .CharCase,.E.T..  \n00444138  FF 38 11 47 00 54 11 47 00 00 00 00 80 05 00 00  ÿ8.G.T.G........  \n00444148  80 0E 00 05 43 6F 6C 6F 72 BC DD 48 00 D5 00 00  ....Color¼ÝH.Õ..  \n00444158  FF 2C 4D 47 00 50 4D 47 00 00 00 00 80 00 00 00  ÿ,MG.PMG........  \n00444168  80 0F 00 05 43 74 6C 33 44 D8 E8 46 00 5A 00 00  ....Ctl3DØèF.Z..  \n00444178  FF 5A 00 00 FF 01 00 00 00 00 00 00 80 F4 FF FF  ÿZ..ÿ........ôÿÿ  \n00444188  FF 10 00 0A 44 72 61 67 43 75 72 73 6F 72 C8 EA  ÿ...DragCursorÈê  \n00444198  46 00 49 00 00 FF 3C 00 00 FE 01 00 00 00 00 00  F.I..ÿ&lt;..þ......  \n004441A8  00 80 00 00 00 00 11 00 08 44 72 61 67 4D 6F 64  .........DragMod  \n004441B8  65 BC DD 48 00 45 00 00 FF 78 0F 47 00 01 00 00  e¼ÝH.E..ÿx.G....  \n004441C8  00 00 00 00 80 01 00 00 00 12 00 07 45 6E 61 62  ............Enab  \n004441D8  6C 65 64 7C 8C 45 00 50 00 00 FF B0 10 47 00 C0  led|.E.P..ÿ°.G.À  \n004441E8  10 47 00 00 00 00 80 00 00 00 80 13 00 04 46 6F  .G............Fo  \n004441F8  6E 74 BC DD 48 00 21 01 00 FF 7C 7C 44 00 01 00  nt¼ÝH.!..ÿ||D...  \n00444208  00 00 00 00 00 80 01 00 00 00 14 00 0D 48 69 64  .............Hid  \n00444218  65 53 65 6C 65 63 74 69 6F 6E 5C EF 46 00 E4 00  eSelection\\ïF.ä.  \n00444228  00 FF E4 00 00 FF 01 00 00 00 00 00 00 80 03 00  .ÿä..ÿ..........  \n00444238  00 00 15 00 07 49 6D 65 4D 6F 64 65 E4 EF 46 00  .....ImeModeäïF.  \n00444248  E8 00 00 FF E8 00 00 FF 01 00 00 00 00 00 00 80  è..ÿè..ÿ........  \n00444258  00 00 00 80 16 00 07 49 6D 65 4E 61 6D 65 10 DE  .......ImeName.Þ  \n00444268  48 00 18 01 00 FF 90 7C 44 00 01 00 00 00 00 00  H....ÿ.|D.......  \n00444278  00 80 00 00 00 00 17 00 09 4D 61 78 4C 65 6E 67  .........MaxLeng  \n00444288  74 68 BC DD 48 00 22 01 00 FF C0 7C 44 00 01 00  th¼ÝH.\"..ÿÀ|D...  \n00444298  00 00 00 00 00 80 00 00 00 00 18 00 0A 4F 45 4D  .............OEM  \n004442A8  43 6F 6E 76 65 72 74 BC DD 48 00 47 00 00 FF 5C  Convert¼ÝH.G..ÿ\\  \n004442B8  11 47 00 01 00 00 00 00 00 00 80 00 00 00 00 19  .G..............  \n004442C8  00 0B 50 61 72 65 6E 74 43 6F 6C 6F 72 BC DD 48  ..ParentColor¼ÝH  \n004442D8  00 D6 00 00 FF 5C 4D 47 00 01 00 00 00 00 00 00  .Ö..ÿ\\MG........  \n004442E8  80 01 00 00 00 1A 00 0B 50 61 72 65 6E 74 43 74  ........ParentCt  \n004442F8  6C 33 44 BC DD 48 00 46 00 00 FF DC 10 47 00 01  l3D¼ÝH.F..ÿÜ.G..  \n00444308  00 00 00 00 00 00 80 01 00 00 00 1B 00 0A 50 61  ..............Pa  \n00444318  72 65 6E 74 46 6F 6E 74 BC DD 48 00 6A 00 00 FF  rentFont¼ÝH.j..ÿ  \n00444328  18 11 47 00 01 00 00 00 00 00 00 80 01 00 00 00  ..G.............  \n00444338  1C 00 0E 50 61 72 65 6E 74 53 68 6F 77 48 69 6E  ...ParentShowHin  \n00444348  74 E4 DD 48 00 1D 01 00 FF 44 7D 44 00 01 00 00  täÝH....ÿD}D....  \n00444358  00 00 00 00 80 00 00 00 00 1D 00 0C 50 61 73 73  ............Pass  \n00444368  77 6F 72 64 43 68 61 72 90 C1 44 00 5C 00 00 FF  wordChar.ÁD.\\..ÿ  \n00444378  AC 0F 47 00 01 00 00 00 00 00 00 80 00 00 00 80  ¬.G.............  \n00444388  1E 00 09 50 6F 70 75 70 4D 65 6E 75 BC DD 48 00  ...PopupMenu¼ÝH.  \n00444398  1E 01 00 FF CC 7D 44 00 01 00 00 00 00 00 00 80  ...ÿÌ}D.........  \n004443A8  00 00 00 00 1F 00 08 52 65 61 64 4F 6E 6C 79 BC  .......ReadOnly¼  \n004443B8  DD 48 00 69 00 00 FF FC 10 47 00 D4 10 47 00 00  ÝH.i..ÿü.G.Ô.G..  \n004443C8  00 00 80 00 00 00 80 20 00 08 53 68 6F 77 48 69  ....... ..ShowHi  \n004443D8  6E 74 FC EA 46 00 80 4D 47 00 00 4E 47 00 01 00  ntüêF..MG..NG...  \n004443E8  00 00 00 00 00 80 FF FF FF FF 21 00 08 54 61 62  ......ÿÿÿÿ!..Tab  \n004443F8  4F 72 64 65 72 BC DD 48 00 D4 00 00 FF 18 4E 47  Order¼ÝH.Ô..ÿ.NG  \netc etc.\n</code></pre>\n<p>And then I'm stuck, I went through all the functions involved in that function but I was unable to determine how the function find out which TEdit retrieve the text from.</p>\n<p>Is there any way either in x64dbg, ghidra,ollydbg or Ida pro to find out how it knows? or even a script/plugin that gives the reference when you run a sort of analysis?</p>\n</div>",
    "votes": "0",
    "answers": 0,
    "views": "48",
    "tags": [
        "ida",
        "debugging",
        "c++",
        "ghidra",
        "x64dbg"
    ],
    "user": "mark",
    "time": "May 7, 2024 at 14:42",
    "comments": [],
    "answers_data": []
}