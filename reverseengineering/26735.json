{
    "title": "How to download restricted backup config file on HG8245H router",
    "link": "https://reverseengineering.stackexchange.com/questions/26735/how-to-download-restricted-backup-config-file-on-hg8245h-router",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>I have HG8245H router and I want to download backup config file to which I dont have access as regular user in my case its caled <code>root</code>. So I downloaded firmware of my router and extracted it using binwalk and found .asp files in particlar <a href=\"https://pastebin.com/uhc33fKy\" rel=\"nofollow noreferrer\">cfgfile.asp</a> and <a href=\"https://pastebin.com/Rse2ayRr\" rel=\"nofollow noreferrer\">cfgfileroot.asp</a>. Cfgfile.asp contain this snippet of java code below which is missing in page from where I should download configs so I opened `Inspect Elements in Firefox and add it in side java tags</p>\n<pre><code>function backupSetting() {\n \n    var Form = new webSubmitForm();\n    Form.setAction('cfgfiledown.cgi?&amp;RequestFile=html/management/cfgfile.asp');\n    Form.addParameter('x.X_HW_Token', getValue('onttoken'));\n    Form.submit();\n}\n</code></pre>\n<p>Also <code>cfgfileroot.asp</code> had missing html code so I added that to after regular code</p>\n<pre><code>  &lt;table width=\"100%\" height=\"5\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt; \n    &lt;tr&gt; \n      &lt;td&gt; &lt;/td&gt; \n    &lt;/tr&gt; \n  &lt;/table&gt; \n  &lt;table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\"&gt; \n    &lt;tr&gt; \n      &lt;td&gt; &lt;input style=\"width:150px\" class=\"submit\" name=\"saveconfigbutton\" id=\"saveconfigbutton\" type='button' onClick='SaveSetting()' BindText=\"s0709\"&gt; &lt;/td&gt; \n      &lt;td&gt; &lt;input style=\"width:150px\" class=\"submit\" name=\"btnsaveandreboot\" id=\"btnsaveandreboot\" type='button' onClick='SaveandReboot()' BindText=\"s070a\"&gt; &lt;/td&gt; \n    &lt;/tr&gt; \n  &lt;/table&gt; \n&lt;/div&gt; \n&lt;table width=\"100%\" height=\"18\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt; \n  &lt;tr&gt; \n    &lt;td&gt; &lt;/td&gt; \n  &lt;/tr&gt; \n&lt;/table&gt; \n&lt;script language=\"JavaScript\" type=\"text/javascript\"&gt;\n    if(curUserType != sysUserType)\n    {\n        document.write('&lt;div id=\"downloadConfig\" style=\"display:none\"&gt; ');\n    }\n    else\n    {\n        document.write('&lt;div id=\"downloadConfig\"&gt; ');\n    }\n&lt;/script&gt;\n\n  &lt;table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"&gt; \n    &lt;tr&gt; \n      &lt;td class=\"prompt\"&gt; \n        &lt;table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"&gt; \n          &lt;tr&gt; \n            &lt;td class=\"title_common\" BindText=\"s070b\"&gt;&lt;/td&gt; \n          &lt;/tr&gt; \n        &lt;/table&gt;\n      &lt;/td&gt; \n    &lt;/tr&gt; \n  &lt;/table&gt; \n  &lt;table width=\"100%\" height=\"5\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt; \n    &lt;tr&gt; \n      &lt;td&gt; &lt;/td&gt; \n    &lt;/tr&gt; \n  &lt;/table&gt; \n  &lt;table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\"&gt; \n    &lt;tr&gt; \n      &lt;td&gt; \n        &lt;input class=\"submit\" style=\"width:220px\" name=\"downloadconfigbutton\" id=\"downloadconfigbutton\" type='button' onClick='backupSetting()' BindText=\"s070c\" &gt;\n      &lt;/td&gt; \n    &lt;/tr&gt; \n  &lt;/table&gt; \n&lt;/div&gt; \n&lt;form action=\"cfgfileupload.cgi?RequestFile=html/management/reset.asp&amp;FileType=config&amp;RequestToken=&lt;%HW_WEB_GetToken();%&gt;\" method=\"post\" enctype=\"multipart/form-data\" name=\"fr_uploadSetting\" id=\"fr_uploadSetting\"&gt; \n  \n&lt;script language=\"JavaScript\" type=\"text/javascript\"&gt;\n    if(curUserType != sysUserType)\n    {\n        document.write('&lt;div id=\"uploadConfig\" style=\"display:none\"&gt;');\n    }\n    else\n    {\n        document.write('&lt;div id=\"uploadConfig\"&gt;');\n    }\n&lt;/script&gt;\n\n    &lt;table width=\"100%\" height=\"10%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"&gt; \n      &lt;tr&gt; \n        &lt;td class=\"prompt\"&gt; \n          &lt;table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"&gt; \n            &lt;tr&gt; \n              &lt;td class=\"title_common\" BindText=\"s070d\"&gt;&lt;/td&gt; \n            &lt;/tr&gt; \n          &lt;/table&gt;\n        &lt;/td&gt; \n      &lt;/tr&gt; \n    &lt;/table&gt; \n    &lt;table width=\"100%\" height=\"5\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt; \n      &lt;tr&gt; \n        &lt;td&gt; &lt;/td&gt; \n      &lt;/tr&gt; \n    &lt;/table&gt; \n    &lt;table&gt; \n      &lt;tr&gt; \n        &lt;td BindText=\"s070e\"&gt;&lt;/td&gt; \n        &lt;td&gt; \n            &lt;div class=\"filewrap\"&gt; \n            &lt;div class=\"fileupload\"&gt; \n              &lt;input type=\"hidden\" name=\"onttoken\" id=\"hwonttoken\" value=\"&lt;%HW_WEB_GetToken();%&gt;\"&gt; \n              &lt;input type=\"text\" id=\"f_file\" autocomplete=\"off\" readonly=\"readonly\" /&gt; \n              &lt;input type=\"file\" name=\"browse\" id=\"t_file\" size=\"1\"  onblur=\"StartFileOpt();\" onchange=\"fchange();\" /&gt; \n              &lt;input id=\"btnBrowse\" type=\"button\" class=\"submit\" BindText=\"s070f\" /&gt; \n            &lt;/div&gt; \n            &lt;/div&gt;\n        &lt;/td&gt; \n        &lt;td&gt; &lt;input class=\"submit\" name=\"btnSubmit\" id=\"btnSubmit\" type='button' onclick='uploadSetting();' BindText=\"s0710\" /&gt; &lt;/td&gt; \n      &lt;/tr&gt; \n    &lt;/table&gt; \n  &lt;/div&gt; \n&lt;/form&gt; \n\n&lt;script&gt;\nvar all = document.getElementsByTagName(\"td\");\nfor (var i = 0; i &lt; all.length; i++)\n{\n    var b = all[i];\n    var c = b.getAttribute(\"BindText\");\n    if(c == null)\n    {\n        continue;\n    }\n    b.innerHTML = ssmpLanguage[c];\n}\n\nvar all = document.getElementsByTagName(\"input\");\nfor (var i = 0; i &lt; all.length; i++)\n{\n    var b = all[i];\n    var c = b.getAttribute(\"BindText\");\n    if(c == null)\n    {\n        continue;\n    }\n    b.value = ssmpLanguage[c];\n}\n&lt;/script&gt;\n</code></pre>\n<p>Here is how it look's modified</p>\n<p><a href=\"https://i.sstatic.net/ujcIw.png\" rel=\"nofollow noreferrer\"><img alt=\"enter image description here\" src=\"https://i.sstatic.net/ujcIw.png\"/></a></p>\n<p>After that I gone from this page displayed below</p>\n<p><a href=\"https://i.sstatic.net/gXZtS.png\" rel=\"nofollow noreferrer\"><img alt=\"enter image description here\" src=\"https://i.sstatic.net/gXZtS.png\"/></a></p>\n<p>to</p>\n<p><a href=\"https://i.sstatic.net/Tbdny.png\" rel=\"nofollow noreferrer\"><img alt=\"enter image description here\" src=\"https://i.sstatic.net/Tbdny.png\"/></a></p>\n<p>But when I click <code>Downlod configuration file</code> nothing happens :(</p>\n<p>If you have HG8245 or HG8245H plese log in as in my case telecomadmin or user with wich you can access to backup config and send me content of <a href=\"https://192.168.100.1:80/html/managment/cfgfileroot.asp\" rel=\"nofollow noreferrer\">https://192.168.100.1:80/html/managment/cfgfileroot.asp</a> that page</p>\n</div>",
    "votes": "0",
    "answers": 0,
    "views": "3k",
    "tags": [
        "router"
    ],
    "user": "Vido",
    "time": "Jan 9, 2021 at 23:59",
    "comments": [
        {
            "user": "Mato",
            "text": "<span class=\"comment-copy\">Hello, I have the same problem with this router: I would need to get a configuration file. Did you solve it somehow? I bought new unlocked HG8245H router for experiments. I can send you content of cfgfileroot.asp. Please contact me.</span>",
            "time": null
        },
        {
            "user": "Vido",
            "text": "<span class=\"comment-copy\">Hi @Mato I was able to get <code>cfgfileroot.asp</code> but could not dump config file it does not want to dump it even when I click on backup button</span>",
            "time": null
        },
        {
            "user": "Mato",
            "text": "<span class=\"comment-copy\">Hi @Vido thanks for reply. It is a big pity. Have you any other idea? I see your other question <a href=\"https://reverseengineering.stackexchange.com/questions/26837/recreating-ping-command-injection-using-curl-instead-using-web-page-on-huawei-ro\" title=\"recreating ping command injection using curl instead using web page on huawei ro\">reverseengineering.stackexchange.com/questions/26837/â€¦</a> is the right way? Can I help you with something with full access to unlocked HG8245H? Thanks.</span>",
            "time": null
        },
        {
            "user": "Vido",
            "text": "<span class=\"comment-copy\">@Mato sorry I dont have any idea</span>",
            "time": null
        },
        {
            "user": "Mato",
            "text": "<span class=\"comment-copy\">:-( I found this <a href=\"https://github.com/logon84/Hacking_Huawei_HG8012H_ONT\" rel=\"nofollow noreferrer\">github.com/logon84/Hacking_Huawei_HG8012H_ONT</a> yet. It seems interesting, what do you think?</span>",
            "time": null
        }
    ],
    "answers_data": []
}