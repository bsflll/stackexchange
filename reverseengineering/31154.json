{
    "title": "Ghidra: Ignoring partial resolution of indirect",
    "link": "https://reverseengineering.stackexchange.com/questions/31154/ghidra-ignoring-partial-resolution-of-indirect",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>The decompiled code for a function shows \"Warning: Ignoring partial resolution of indirect\" and I am not able to determine the values of variables <code>local_18</code> in this decompile:</p>\n<pre><code>uint FUN_0004f404(int param_1)\n\n{\n  int iVar1;\n  undefined4 local_820;\n  undefined4 uStack2076;\n  undefined4 uStack2072;\n  undefined4 uStack2068;\n  undefined4 local_810;\n  undefined4 uStack2060;\n  undefined4 local_808;\n  undefined4 local_20;\n  uint local_1c;\n  undefined4 local_18;\n  undefined2 local_14;\n  undefined2 local_12;\n  undefined4 local_10;\n  undefined local_b;\n  undefined local_a;\n  undefined local_9;\n  \n  local_9 = 4;\n  local_a = 3;\n  local_18 = 0;\n  local_14 = 0;\n  local_20 = 0;\n  local_1c = 0;\n  local_10 = 0x80000300;\n  local_12 = 7;\n                    /* WARNING: Ignoring partial resolution of indirect */\n  local_18._0_1_ = 0x55;\n                    /* WARNING: Ignoring partial resolution of indirect */\n  local_14._0_1_ = 7;\n  local_b = 6;\n  if (param_1 == 0xff) {\n    iVar1 = somefunc((byte *)&amp;local_18,6,&amp;local_20,8);\n...\n</code></pre>\n<p>The ARM assembly for this section of code looks like:</p>\n<pre><code>                         *******************************************************\n                         *                      FUNCTION                       *\n                         *******************************************************\n                         undefined FUN_0004f404()\n           undefined       r0:1         &lt;RETURN&gt;\n           undefined1      Stack[-0x9]  local_9                            XREF[3]:   0004f41c(W), \n                                                                                      0004f45c(R), \n                                                                                      0004f4c0(R)  \n           undefined1      Stack[-0xa]  local_a                            XREF[3]:   0004f424(W), \n                                                                                      0004f464(R), \n                                                                                      0004f4dc(R)  \n           undefined1      Stack[-0xb]  local_b                            XREF[13]:  0004f42c(W), \n                                                                                      0004f474(R), \n                                                                                      0004f47c(W), \n                                                                                      0004f490(R), \n                                                                                      0004f498(W), \n                                                                                      0004f4ac(R), \n                                                                                      0004f4b4(W), \n                                                                                      0004f4c8(R), \n                                                                                      0004f4d0(W), \n                                                                                      0004f4e4(R), \n                                                                                      0004f4ec(W), \n                                                                                      0004f504(R), \n                                                                                      0004f50c(W)  \n           undefined4      Stack[-0x10  local_10                           XREF[3]:   0004f458(W), \n                                                                                      0004f644(W), \n                                                                                      0004f648(R)  \n           undefined2      Stack[-0x12  local_12                           XREF[3]:   0004f470(W), \n                                                                                      0004f4f0(R), \n                                                                                      0004f514(R)  \n           undefined2      Stack[-0x14  local_14                           XREF[1]:   0004f43c(W)  \n           undefined4      Stack[-0x18  local_18                           XREF[1]:   0004f434(W)  \n           undefined4      Stack[-0x1c  local_1c                           XREF[2,1]: 0004f44c(W), \n                                                                                      0004f63c(R), \n                                                                                      0004f634(R)  \n           undefined4      Stack[-0x20  local_20                           XREF[1]:   0004f444(W)  \n           undefined2      Stack[-0x80  local_808                          XREF[1]:   0004f588(W)  \n           undefined4      Stack[-0x81  local_810                          XREF[1]:   0004f584(*)  \n           undefined4      Stack[-0x82  local_820                          XREF[2]:   0004f57c(*), \n                                                                                      0004f600(*)  \n           undefined4      Stack[-0x82  local_824                          XREF[3]:   0004f414(W), \n                                                                                      0004f530(R), \n                                                                                      0004f5cc(R)  \n           undefined4      Stack[-0x83  local_830                          XREF[1]:   0004f5c0(W)  \n                         FUN_0004f404                              XREF[1]:   other_func:000508a4\n      0004f404 00 48 2d      stmdb     sp!,{r11 lr}\n               e9\n      0004f408 04 b0 8d      add       r11,sp,#0x4\n               e2\n      0004f40c 82 de 4d      sub       sp,sp,#0x820\n               e2\n      0004f410 08 d0 4d      sub       sp,sp,#0x8\n               e2\n      0004f414 20 08 0b      str       r0,[r11,#local_824]\n               e5\n      0004f418 04 30 a0      mov       r3,#0x4\n               e3\n      0004f41c 05 30 4b      strb      r3,[r11,#local_9]\n               e5\n      0004f420 03 30 a0      mov       r3,#0x3\n               e3\n      0004f424 06 30 4b      strb      r3,[r11,#local_a]\n               e5\n      0004f428 00 30 a0      mov       r3,#0x0\n               e3\n      0004f42c 07 30 4b      strb      r3,[r11,#local_b]\n               e5\n      0004f430 00 30 a0      mov       r3,#0x0\n               e3\n      0004f434 14 30 0b      str       r3,[r11,#local_18]\n               e5\n      0004f438 00 30 a0      mov       r3,#0x0\n               e3\n      0004f43c b0 31 4b      strh      r3,[r11,#local_14]\n               e1\n      0004f440 00 30 a0      mov       r3,#0x0\n               e3\n      0004f444 1c 30 0b      str       r3,[r11,#local_20]\n               e5\n      0004f448 00 30 a0      mov       r3,#0x0\n               e3\n      0004f44c 18 30 0b      str       r3,[r11,#local_1c]\n               e5\n      0004f450 03 3c a0      mov       r3,#0x300\n               e3\n      0004f454 00 30 48      movt      r3,#0x8000\n               e3\n      0004f458 0c 30 0b      str       r3,[r11,#local_10]\n               e5\n      0004f45c 05 30 5b      ldrb      r3,[r11,#local_9]\n               e5\n      0004f460 73 20 ff      uxth      r2,r3\n               e6\n      0004f464 06 30 5b      ldrb      r3,[r11,#local_a]\n               e5\n      0004f468 73 30 ff      uxth      r3,r3\n               e6\n      0004f46c 03 30 82      add       r3,r2,r3\n               e0\n      0004f470 be 30 4b      strh      r3,[r11,#local_12]\n               e1\n      0004f474 07 30 5b      ldrb      r3,[r11,#local_b]\n               e5\n      0004f478 01 20 83      add       r2,r3,#0x1\n               e2\n      0004f47c 07 20 4b      strb      r2,[r11,#local_b]\n               e5\n      0004f480 04 20 4b      sub       r2,r11,#0x4\n               e2\n      0004f484 03 30 82      add       r3,r2,r3\n               e0\n      0004f488 55 20 a0      mov       r2,#0x55\n               e3\n      0004f48c 10 20 43      strb      r2,[r3,#-0x10]\n               e5\n      0004f490 07 30 5b      ldrb      r3,[r11,#local_b]\n               e5\n      0004f494 01 20 83      add       r2,r3,#0x1\n               e2\n      0004f498 07 20 4b      strb      r2,[r11,#local_b]\n               e5\n      0004f49c 04 20 4b      sub       r2,r11,#0x4\n               e2\n      0004f4a0 03 30 82      add       r3,r2,r3\n               e0\n      0004f4a4 55 20 e0      mvn       r2,#0x55\n               e3\n      0004f4a8 10 20 43      strb      r2,[r3,#-0x10]\n               e5\n      0004f4ac 07 30 5b      ldrb      r3,[r11,#local_b]\n               e5\n      0004f4b0 01 20 83      add       r2,r3,#0x1\n               e2\n      0004f4b4 07 20 4b      strb      r2,[r11,#local_b]\n               e5\n      0004f4b8 04 20 4b      sub       r2,r11,#0x4\n               e2\n      0004f4bc 03 30 82      add       r3,r2,r3\n               e0\n      0004f4c0 05 20 5b      ldrb      r2,[r11,#local_9]\n               e5\n      0004f4c4 10 20 43      strb      r2,[r3,#-0x10]\n               e5\n      0004f4c8 07 30 5b      ldrb      r3,[r11,#local_b]\n               e5\n      0004f4cc 01 20 83      add       r2,r3,#0x1\n               e2\n      0004f4d0 07 20 4b      strb      r2,[r11,#local_b]\n               e5\n      0004f4d4 04 20 4b      sub       r2,r11,#0x4\n               e2\n      0004f4d8 03 30 82      add       r3,r2,r3\n               e0\n      0004f4dc 06 20 5b      ldrb      r2,[r11,#local_a]\n               e5\n      0004f4e0 10 20 43      strb      r2,[r3,#-0x10]\n               e5\n      0004f4e4 07 30 5b      ldrb      r3,[r11,#local_b]\n               e5\n      0004f4e8 01 20 83      add       r2,r3,#0x1\n               e2\n      0004f4ec 07 20 4b      strb      r2,[r11,#local_b]\n               e5\n      0004f4f0 be 20 5b      ldrh      r2,[r11,#local_12]\n               e1\n      0004f4f4 72 20 ef      uxtb      r2,r2\n               e6\n      0004f4f8 04 10 4b      sub       r1,r11,#0x4\n               e2\n      0004f4fc 03 30 81      add       r3,r1,r3\n               e0\n      0004f500 10 20 43      strb      r2,[r3,#-0x10]\n               e5\n      0004f504 07 30 5b      ldrb      r3,[r11,#local_b]\n               e5\n      0004f508 01 20 83      add       r2,r3,#0x1\n               e2\n      0004f50c 07 20 4b      strb      r2,[r11,#local_b]\n               e5\n      0004f510 03 10 a0      cpy       r1,r3\n               e1\n      0004f514 be 30 5b      ldrh      r3,[r11,#local_12]\n               e1\n      0004f518 23 34 a0      mov       r3,r3, lsr #0x8\n               e1\n      0004f51c 73 30 ff      uxth      r3,r3\n               e6\n      0004f520 73 20 ef      uxtb      r2,r3\n               e6\n      0004f524 04 30 4b      sub       r3,r11,#0x4\n               e2\n      0004f528 01 30 83      add       r3,r3,r1\n               e0\n      0004f52c 10 20 43      strb      r2,[r3,#-0x10]\n               e5\n      0004f530 20 38 1b      ldr       r3,[r11,#local_824]\n               e5\n      0004f534 ff 00 53      cmp       r3,#0xff\n               e3\n      0004f538 1d 00 00      bne       LAB_0004f5b4\n               1a\n      0004f53c 1c 20 4b      sub       r2,r11,#0x1c\n               e2\n      0004f540 14 00 4b      sub       r0,r11,#0x14\n               e2\n      0004f544 08 30 a0      mov       r3,#0x8\n               e3\n      0004f548 06 10 a0      mov       r1,#0x6\n               e3\n      0004f54c 44 fe ff      bl        stuff::somefunc                   undefined somefunc(\n               eb\n...\n</code></pre>\n<p>I have no experience with assembly, and I'm having a difficult time trying to understand what is going on here.  I know that <code>local_18</code> is supposed to contain an array of 6 bytes when it is passed to <code>somefunc</code>, and I need to understand what those bytes are.  Can anyone help me to decipher what is going on here?</p>\n</div>",
    "votes": "2",
    "answers": 0,
    "views": "100",
    "tags": [
        "ghidra",
        "arm"
    ],
    "user": "mattmunee",
    "time": "Nov 18, 2022 at 20:13",
    "comments": [],
    "answers_data": []
}