{
    "title": "Decoding serial data package",
    "link": "https://reverseengineering.stackexchange.com/questions/18050/decoding-serial-data-package",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>I have an assignment at work, to get information from Jenbacher generator and show values in new  SCADA system. It has a B&amp;R CP260 PLC with RS232 port and RS232 to RS485 converter. Currently it’s connected to old Winows XP PC via COM port. From hardware settings on PC I can see that it uses <strong>9600 baud 8N1</strong>. It <strong>sends data packets every 5 seconds (without request)</strong>. There is about 30 different variables that are shown in the old SCADA system (a lot of BOOLs and about 8 analog values. <strong>The whole system is 15 years old</strong>. I used RealTerm to read 10 packages in HEX and I got some data.</p>\n<p>I wrote down active power from screen with every packet received and I have some variables that are not changing so often (didn’t change while reading packets) :</p>\n<p>Operating hours – <strong>81521</strong></p>\n<p>Total active power – <strong>80578,3</strong></p>\n<p>Total reactive power – <strong>1053,5</strong></p>\n<p>Active power from screen whit each packet received:</p>\n<p>1)  <strong>852</strong> kW</p>\n<p>2)  <strong>853</strong> kW</p>\n<p>3)  <strong>843</strong> kW</p>\n<p>4)  <strong>840</strong> kW</p>\n<p>5)  <strong>851</strong> kW</p>\n<p>6)  <strong>856</strong> kW</p>\n<p>7)  <strong>848</strong> kW</p>\n<p>8)  <strong>841</strong> kW</p>\n<p>9)  <strong>848</strong> kW</p>\n<p>10) <strong>852</strong> kW</p>\n<p>Active power is changing on screen with every packet received, so it must be sending power updates with every packet, but I can’t find it in the packet. I found Op hours, total active, reactive power in some packets, but it is not consistent. </p>\n<p><em>Update:</em></p>\n<p>Discovered values in <strong>bold</strong> :</p>\n<p><strong>13E71</strong> - OP hours</p>\n<p><strong>C4B97</strong> - Tot. active power</p>\n<p><strong>2927</strong> - Tot. reactive power</p>\n<p>Data:</p>\n<p><pre><code>\n1)\nFF01020810408000000001040820400000000104082040000000010000010408A060AA15B8010208\n10408000000001040820400000000104082040000000010408204000000001040820400000000104\n08204000000001040820400000000104082040000000010408204000000001040820400000000104\n08204000000001040820400000000104082040000000010408204040AA03490308DB405360010428\n3052000004420102081040BF2101F404F0056B0A10406024023F09C3265891608D022D09534D5869\n6021024A024E09034D5869601B0248091B4DD89A602460A3024E016268D2398000<strong>2927</strong>0D8A0D5060\n16020850630C20400000000114CC1440800000000114AC2040000000010408204000000A7100CC00\nC80154018D055B2A58D440D6FF8C0391234CAB2022C1F600860024012A03A105B60D2040000006A1\n01040820400000000104082040000000010408204000000001040820400000000104082040000000\n01040820400000000104082040000000010408204000000001040820400000000104082040000000\n0104082040000000010408204000000001040820400000000104082040000000ED<br/>\n2)<br/>\nFF01020810408000000001040820400000000104082040000000010000010408A060AA15B8010208\n10408000000001040820400000000104082040000000010408204000000001F40104082040000000\n01040820400000000104082040000000010408204000000001040820400000000104082040000000\n010408204000000001040820400000000104082040000000FD0134A8A540A900D003BD0AEC010428\n3052000004420102081040BF2201F404D1056B0A104060D202400239097324183360170248094B4D\n984860D2024E09FB24589A602360D202430250093B499834602700182DBA0E1040CA270341022898\n16020850630C20400000000114CC14408000000001142C3040000000010408204000000A75016400\nCA00CA018D055B2A58D440D5FF880DFA899859811304DB00430091012A03E8014B0000000003E800\n00000000000000000000000000000000000000000000000000000000000000000000000000000000\n00000000000000000000000000000000000000000000000000000000000000000000000000000000\n0000000000000000000000000000000000FB<br/>\n3)<br/>\nFF00000000000000000000000000000000000000000080010000000001148CB53157000000010408\n20400000000104082040000000010408204000000001040820400000FE0104082040000000010408\n20400000000104082040000000010408204000000001040820400000000104082040000000010408\n204000000001040820400000000104082040000000FD013468D2406A006703BD0AEC010428305200\n0004420102081040BF2001F404CD018E010248586960900239097324582360170247094B4D984860\nD2024E09FB24589A602360D20243024F024709334D981240834B970000A57634503580C03E710102\n28EC0C20400000000114AC1440800000000104880104082040000000010408A020F700E600CA00CA\n018E05632E98D440D2FF990DEA8D98AC818704BF008401042A3065407401320000010468205D0000\n00010408204000000001040820400000000104082040000000010408204000000001040820400000\n00010408204000000001040820400000000104082040000000010408204000000001040820400000\n00010408204000000001040820400000000104082040000000010408204087<br/>\n4)<br/>\nFF01020810408000000001040820400000000104082040000000010000010408A060AA15B8010208\n10408000000001040820400000000104082040000000010408204000000001040820400000000104\n08204000000001040820400000000104082040000000010408204000000001040820400000000104\n0820400000000104082040000000010408204000000001040820404024034903E8DB405B60010428\n3052000004420102081040BF2101F404F3056B0A104060D2024209CB24D899608D022E092B4D5869\n6021024A024E09FB24589A608D02490243024E093B499834602700182DBA0E1040CA270341022898\n16020850630C20400000000114AC1440800000000104A8000001040820400000000154A80B203E80\nF900E5018D055B2A58D44096FF8D0D3A234C5E208382D3008401E42A306540740143000001046820\n5D000000010408204000000001040820400000000104082040000000010408204000000001040820\n40000000010408204000000001040820400000000104082040000000010408204000000001040820\n40000000010408204000000001040820400000000104083040000000000000007DFF<br/>\n5)\nFF00000000000000000000000000000000000000000080010000000000015415B800000000000000\n00000000000000000000000000000000000000000000000000000000000000000000000000000000\n00000000000000000000000000000000000000000000000000000000000000000000000000000000\n00000000010408204000034D1A480DA0B640B701FF0102281852800002420102081040BF2201F404\nEC018D010248586960688139098324982360170244094B4D984860A5024E09FB24589A608D024A02\n43024D093B49D824602700182DBA0E1040CA27034102289816020850630C204000000001148C1C40\n8000000001140C1840800000000104082040000575016400CA00CA018D055B2A58D440D7FF8903A1\n23ECAB206482E8011A0D1052C02A03A10596020810408003E8010208104080000000010408204000\n00000104082040000000010408204000000001040820400000000104082040000000010408204000\n00000104082040000000010408204000000001040820400000000104082040000000010408204000\n000001040820400000000104082040000090<br/>\n6)<br/>\nFF01020810408000000001040820400000000104082040000000010000010408A060AA15B8010208\n10408000000001040820400000000104082040000000010408204000000001F40104082040000000\n01040820400000000104082040000000010408204000000001040820400000000104082040000000\n010408204000000001040820400000000104082040000000FD0134086D206A006803B90BCC000005\n060A204081420102081040BF2201F404D4056B0A104060D202430238023009B32498916068814902\n4209534DD89A6024589A608D024A0243024C0247093B49981240834B970000A57634102580C03E71\n010228EC0C204000000001148C1C408000000001140C1840800000000104082040000575016400CA\n00CA018D055B2A58D440DA2135E835B0579020C11640480091012A03A105D60D2040000006A10104\n08204000000001040820400000000104082040000000010408204000000001040820400000000104\n08204000000001040820400000000104082040000000010408204000000001040820400000000104\n08204000000001040820400000000104082040000000010408204000000009FD<br/>\n7)<br/>\nFF01020810408000000001040820400000000104082040000080010000010608F060FF15B8000000\n000000000000000000000000000000000000000000000000000000FF000000000000000000000000\n00000000000000000000000000000000000000000000000000000000000000000000000000000000\n0000000000000000000000FF00035003520067036D01FF000001900000024200000000FC2201F404\nCC018E0000024902430238022F0235022E024202490241024A024F023F0249023502490242024B02\n470247024E000<strong>C4B97</strong>0000<strong>2927</strong>035000023E71010228EC0C20400000000114AC1440800000000114\n8C3040000000010408204000000A75016400CA00CA018E05632E98D440492937881AB0F0810A04D1\n0112091052C02A03A105B6061020800003A101040820400000000104082040000000010408204000\n00000104082040000000010408204000000001040820400000000104082040000000010408204000\n00000104082040000000010408204000000001040820400000000104082040000000010408204000\n000001040820400000006DFF<br/>\n8)<br/>\nFF01020810408000000001040820400000000104082040000000010000010408A060AA15B8010208\n10408000000001040820400000000104082040000000010408204000000001040820400000000104\n08204000000001040820400000000104082040000000010408204000000001040820400000000104\n08204000000001040820400000000104082040000000010408204040D2035200D003B5130C104080\n0190010248984880000000F181168C3F30F8C08D000009964D30488138022E09AB24989160488149\n024109534DD89A6024589A602360D2024209534DD8246024602700182DBA0E1040CA270341022898\n16020850630C20400000000114CC1440800000000104A8000001040820400000000154880F203E80\nF900E5018E055B2A58D44094FF950DDA8D182BC1FF04C60112099054606540740139010208104040\n74000001040820400000000104082040000000010408204000000001040820400000000104082040\n00000001040820400000000104082040000000010408204000000001040820400000000104082040\n0000000104082040000000010408204000000001040820400000000104082040003B<br/>\n9)<br/>\nFF01020810408000000001040820400000000104082040000000010000010408A060AA15B8010208\n10408000000001040820400000000104082040000000010408204000000001040820400000000104\n08204000000001040820400000000104082040000000010408204000000001040830408000000000\n0000000000000000000000000000000000000000000000035003520067036D020000000190000002\n4200000000FC2101F404F3018D0000024902420239022E0234022D024102490241024A024F023F02\n490236024A0241024902460247024E000<strong>C4B97</strong>0000<strong>2927</strong>034F000<strong>13E71</strong>0000191F00000000000001\n8D00000000000000FC0000000000000000000005DB00E600E500E5018D018B018D035BFF8D036704\nC3050D04D500430090012A03E8015C0000000003A101040820400000000104082040000000010408\n20400000000104082040000000010408204000000001040820400000000104082040000000010408\n20400000000104082040000000010408204000000001040820400000000104082040000000010408\n2040000000010408204000000091FF<br/>\n10)<br/>\nFF01020810408000000001040820400000000104082040000000010000010408A060AA15B8010208\n10408000000001040820400000000104082040000000010408204000000001F40104082040000000\n01040820400000000104082040000000010408204000000001040820400000000104082040000000\n010408204000000001040820400000000104082040000000FD013488B540A900CE03B50BEC010428\n3052000004420102081040BF2101F404E1056B0A104060D2024109CB24589160CD022D090B495869\n6090024A024F023F094B4D982360A50241094B4D98346024602700182DBA0E1040CA270341022898\n16020850630C204000000001148C1C40800000000114EC3040000000010408204000000A7D00CC00\nCA00CA018D055B2A58D440A531374889305A811C04E5008401142E3065407401610000010468205D\n00000001040820400000000104082040000000010408204000000001040820400000000104082040\n00000001040820400000000104082040000000010408204000000001040820400000000104082040\n000000010408204000000001040820400000000104082040000000010408204069  </code></pre></p>\n<p></p>\n</div>",
    "votes": "0",
    "answers": 1,
    "views": "443",
    "tags": [
        "hex",
        "serial-communication",
        "protocol"
    ],
    "user": "coddr",
    "time": "Apr 20, 2018 at 21:27",
    "comments": [
        {
            "user": "user22967",
            "text": "<span class=\"comment-copy\">It might be useful if you annotated the fields you already decoded in the packet dumps.</span>",
            "time": null
        },
        {
            "user": "coddr",
            "text": "<span class=\"comment-copy\">Done! As i mentioned, it's not consistent. I can see values in some packets, but maybe it is coincidence and i'm reading it wrong.</span>",
            "time": null
        }
    ],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>So I got it working, turns out I used wrong parity, din't know you can override davice manager port settings from VB. Thanks.</p>\n</div>",
            "votes": "-1",
            "user": "coddr",
            "time": "Apr 25, 2018 at 17:35",
            "is_accepted": true,
            "comments": []
        }
    ]
}