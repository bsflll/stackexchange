{
    "title": "Analysis of BusyBox Shell router U-Boot firmware",
    "link": "https://reverseengineering.stackexchange.com/questions/22776/analysis-of-busybox-shell-router-u-boot-firmware",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>I am trying to get access to the BusyBox Shell and if possible to get a firmware dump.</p>\n<p>The \"U-Boot\" has limited possibilities but what is good is \"sf - SPI flash sub-system\".</p>\n<p>Can anyone help me get access to the shell? Or a dump of the whole firmware without SOIC8 clip.</p>\n<p>I use a UART interface on the hardware:</p>\n<pre><code>Starting kernel ...\n\nLinux version 2.6.30.9 (root@grant-virtual-machine) (gcc version 4.4.6 (Realtek RSDK-1.5.6p2) ) #141 Mon Jun 17 11:13:56 CST 2019 [luna SDK 1.0.51]\nRTL9602C PLL\nCPU revision is: 0000dc02\nDetermined physical RAM map:\n memory: 02eff000 @ 00000000 (usable)\n memory: 00eff000 @ 03000000 (usable)\nII: Kernel command line modified: mtdparts=rtk_spi_nor_mtd -&gt;   mtdparts=physmap-flash\nZone PFN ranges:\n  Normal   0x00000000 -&gt; 0x00003eff\nMovable zone start PFN for each node\nearly_node_map[2] active PFN ranges\n    0: 0x00000000 -&gt; 0x00002eff\n    0: 0x00003000 -&gt; 0x00003eff\nBuilt 1 zonelists in Zone order, mobility grouping on.  Total pages: 15744\nKernel command line: console=ttyS0,115200   mtdparts=physmap-flash:256K(boot),8K(env),8K(env2),1776K(config),4M(k0),10M(r0) root=31:5\nroot_dev_setup line 180 root: 31:5\nicache: 64kB/32B, dcache: 32kB/32B, scache: 0kB/0B\nNR_IRQS:128\nPID hash table entries: 256 (order: 8, 1024 bytes)\nconsole [ttyS0] enabled\n</code></pre>\n<pre><code>U-Boot 2011.12.M (Sep 29 2017 - 16:08:09)\n\nSPI-F: EF4018/MMIO16-1 1x16 MB (plr_flash_info @ 83c23714)\nLoading 8192B env. variables from offset 0x40000\nLoading 8192B env. variables from offset 0x42000\n*** Warning - bad CRC, using default environment\n\nLoaded 8192B env. variables from offset 0x40000\nmtdparts0=mtdparts=rtk_spi_nor_mtd:256K(boot),8K(env),8K(env2),1776K(config),4M(k0),10M(r0) root=31:5\nNet:   LUNA GMAC\nWarning: eth device name has a space!\n\nHit any key to stop autoboot:  0\n## Booting kernel from Legacy Image at 94200000 ...\n   Image Name:   Linux Kernel Image\n   Created:      2019-06-17   3:16:33 UTC\n   Image Type:   MIPS Linux Kernel Image (lzma compressed)\n   Data Size:    2528816 Bytes = 2.4 MB\n   Load Address: 80000000\n   Entry Point:  80000000\n   Verifying Checksum ... OK\n   Uncompressing Kernel Image ... OK\n</code></pre>\n<pre><code>#printenv\nbaudrate=115200\nbootargs_base=console=ttyS0,115200\nbootcmd=setenv bootargs ${bootargs_base} ${mtdparts0};bootm ${img0_kernel}\nbootdelay=5\nerase_cfgfs=sf erase ${fl_cfgfs} +${fl_cfgfs_sz}\nerase_env=sf erase ${fl_env} +${fl_env_sz};sf erase ${fl_env2} +${fl_env_sz}\nethact=LUNA GMAC\n\nfl_boot_sz=40000\nfl_cfgfs=44000\nfl_cfgfs_sz=1bc000\nfl_env=40000\nfl_env2=42000\nfl_env_sz=2000\nfl_kernel1=200000\nfl_kernel1_sz=400000\nfl_rootfs1=600000\nfl_rootfs1_sz=a00000\nfx1000_init=mw bb000084 00000048\nimg0_kernel=94200000\nipaddr=192.168.1.3\nmtdparts0=mtdparts=rtk_spi_nor_mtd:256K(boot),8K(env),8K(env2),1776K(config),4M(k0),10M(r0) root=31:5\nnetmask=255.255.255.0\nserverip=192.168.1.7\nsgmii_init=mw bb000084 00000044\nstderr=serial\nstdin=serial\nstdout=serial\nupb=tftp 80000000 plr.img; crc32 ${fileaddr} ${filesize}; sf erase 0 +${fl_boot_sz}; sf write ${fileaddr} 0 ${filesize}\nupk=tftp 80000000 uImage; crc32 ${fileaddr} ${filesize}; sf erase ${fl_kernel1} +${fl_kernel1_sz}; sf write ${fileaddr} ${fl_kernel1} ${filesize}\nupr=tftp 80000000 rootfs; crc32 ${fileaddr} ${filesize}; sf erase ${fl_rootfs1} +${fl_rootfs1_sz}; sf write ${fileaddr} ${fl_rootfs1} ${filesize}\nupv=tftp 80000000 vm.img;upvmimg ${fileaddr}\nyu=loady 80000000; cp.b 80000000 81000000 ${filesize}; cmp.b 80000000 81000000 ${filesize}; sf erase 0 ${filesize}; sf write 80000000 0 ${filesize}\nEnvironment size: 1442/8187 bytes`\n</code></pre>\n<pre><code>#md 94200000\n94200000: 27051956 2d28951a 5d070611 00269630    '..V-(..]....&amp;.0\n94200010: 80000000 80000000 2f808b2c 05050203    ......../..,....\n94200020: 4c696e75 78204b65 726e656c 20496d61    Linux Kernel Ima\n94200030: 67650000 00000000 00000000 00000000    ge..............\n94200040: 5d000000 013c76b6 00000000 00000600    ]....&lt;v.........\n94200050: 0395c7e8 666e5ec6 cddf5cd3 7f860981    ....fn^...\\.....\n94200060: 66e4e47d 16454378 ba7286d7 10ac0e5f    f..}.ECx.r....._\n94200070: f4548875 7fd45d23 8321e1d6 6fac3711    .T.u..]#.!..o.7.\n94200080: a7076c68 3c27aa4a b8951c97 f585008d    ..lh&lt;'.J........\n94200090: ec4f63f7 f8f232aa 1ce8ee62 fc24a98f    .Oc...2....b.$..\n942000a0: 333ae099 be5ca694 d30dce2b a68c092e    3:...\\.....+....\n942000b0: 12e311f5 86510704 357b1219 64c20547    .....Q..5{..d..G\n942000c0: eaed521e e00f8734 f0708316 d5433715    ..R....4.p...C7.\n942000d0: 285ceb11 2f3b455b 69650bef d9a0f557    (\\../;E[ie.....W\n942000e0: 1ae81e50 d473f125 bdfe34b3 e3cdab52    ...P.s.%..4....R\n942000f0: 3db532b3 8ccfc480 559a1511 a90508ff    =.2.....U.......\n</code></pre>\n<pre><code>#help\n?               - alias for 'help'\nbase            - print or set address offset\nbdinfo          - print Board Info structure\nboot            - boot default, i.e., run 'bootcmd'\nbootd           - boot default, i.e., run 'bootcmd'\nbootm           - boot application image from memory\nbootp           - boot image via network using BOOTP/TFTP protocol\nbtg             - bus traffic generator sub-system\ncmp             - memory compare\nconinfo         - print console devices and information\ncp              - memory copy\ncrc32           - checksum calculation\necho            - echo args to console\neditenv         - edit environment variable\nenv             - environment handling commands\ngo              - start application at address 'addr'\nhelp            - print command description/usage\niminfo          - print header information for application image\nimxtract        - extract a part of a multi-image\nitest           - return true/false on integer compare\nloadb           - load binary file over serial line (kermit mode)\nloads           - load S-Record file over serial line\nloady           - load binary file over serial line (ymodem mode)\nloop            - infinite loop on address range\nmd              - memory display\nmdram_test      - mdram_test   - do DRAM test.\nmm              - memory modify (auto-incrementing address)\nmtest           - simple RAM read/write test\nmw              - memory write (fill)\nnm              - memory modify (constant address)\nprintenv        - print environment variables\nreset           - Perform RESET of the CPU\nreset_all       - Perform whole chip RESET of the CPU\nreset_sw        - Perform software RESET\nrun             - run commands in an environment variable\nsaveenv         - save environment variables to persistent storage\nsetenv          - set environment variables\nsf              - SPI flash sub-system\nsleep           - delay execution for some time\nsource          - run script from memory\ntftpboot        - boot image via network using TFTP protocol\nupvmimg         - update kernel and rootfs by vmimg format on luna platform\nversion         - print monitor, compiler and linker version\n</code></pre>\n</div>",
    "votes": "2",
    "answers": 1,
    "views": "1k",
    "tags": [
        "firmware",
        "hardware",
        "firmware-analysis"
    ],
    "user": "M4RC0_RS",
    "time": "Dec 22, 2019 at 19:41",
    "comments": [
        {
            "user": "Дмитрий Цой",
            "text": "<span class=\"comment-copy\">Hi could you share Realtek RSDK-1.5.6p2 •\tluna SDK V1.9.0 SDK ?</span>",
            "time": null
        }
    ],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>adding <code>single</code> to bootargs should drop you into a root shell, e.g. try:</p>\n<pre><code>setenv bootargs ${bootargs_base} single ${mtdparts0}\nbootm ${img0_kernel}\n</code></pre>\n</div>",
            "votes": "1",
            "user": "0xC0000022L",
            "time": "Dec 23, 2019 at 19:28",
            "is_accepted": false,
            "comments": []
        }
    ]
}