{
    "title": "would be possible to deobfuscate javascript code? [closed]",
    "link": "https://reverseengineering.stackexchange.com/questions/17972/would-be-possible-to-deobfuscate-javascript-code",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<div>\n<aside class=\"s-notice s-notice__info post-notice js-post-notice mb16\" role=\"status\">\n<div class=\"d-flex fd-column fw-nowrap\">\n<div class=\"d-flex fw-nowrap\">\n<div class=\"flex--item wmn0 fl1 lh-lg\">\n<div class=\"flex--item fl1 lh-lg\">\n<div>\n<b>Closed.</b> This question is <a href=\"/help/closed-questions\">off-topic</a>. It is not currently accepting answers.\n                                \n                            </div>\n</div>\n</div>\n</div>\n</div>\n<hr class=\"my12 outline-none baw0 bb bc-blue-400\"/>\n<div class=\"fw-nowrap fc-black-500\">\n<div class=\"d-flex fd-column lh-md\">\n<div class=\"mb0 d-flex\">\n<div class=\"flex--item mr8\">\n<svg aria-hidden=\"true\" class=\"svg-icon iconLightbulb\" height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M15 6.38A6.5 6.5 0 0 0 7.78.04h-.02A6.5 6.5 0 0 0 2.05 5.6a6.3 6.3 0 0 0 2.39 5.75c.49.39.76.93.76 1.5v.24c0 1.07.89 1.9 1.92 1.9h2.75c1.04 0 1.92-.83 1.92-1.9v-.2c0-.6.26-1.15.7-1.48A6.3 6.3 0 0 0 15 6.37M4.03 5.85A4.5 4.5 0 0 1 8 2.02a4.5 4.5 0 0 1 5 4.36 4.3 4.3 0 0 1-1.72 3.44c-.98.74-1.5 1.9-1.5 3.08v.1H7.2v-.14c0-1.23-.6-2.34-1.53-3.07a4.3 4.3 0 0 1-1.64-3.94M10 18a1 1 0 0 0 0-2H7a1 1 0 1 0 0 2z\"></path></svg>\n</div>\n<p> Questions asking for help <b>reverse-engineering a specific system</b> are off-topic unless they demonstrate an understanding of the concepts involved and clearly identify a specific problem.</p>\n</div>\n<div class=\"mb0 mt6 d-flex\">\n<p class=\"ml24 pl2\">Closed <span class=\"relativetime\" title=\"2018-04-13 18:44:41Z\">7 years ago</span>.</p>\n</div>\n<div class=\"ml24 pl2\">\n</div>\n</div>\n</div>\n<div class=\"mt24 d-flex gsx gs8\">\n<a class=\"s-btn s-btn__outlined flex--item js-post-notice-edit-post\" href=\"/posts/17972/edit\">\n                        Improve this question\n                    </a>\n</div>\n</aside>\n</div>\n<p>the code is:\n<a href=\"https://pastebin.com/wTkB81v4\" rel=\"nofollow noreferrer\">https://pastebin.com/wTkB81v4</a></p>\n<p>would be possible to deobfuscate the code to get the original code?</p>\n</div>",
    "votes": "-2",
    "answers": 1,
    "views": "835",
    "tags": [
        "javascript"
    ],
    "user": "My Dear",
    "time": "7 years ago",
    "comments": [
        {
            "user": "Igor Skochinsky",
            "text": "<span class=\"comment-copy\">yes, but we won't just do it for you. Describe what you tried and what difficulties you encountered.</span>",
            "time": null
        },
        {
            "user": "sudhackar",
            "text": "<span class=\"comment-copy\">Try <a href=\"http://jsnice.org/\" rel=\"nofollow noreferrer\">jsnice.org</a>. I tried it. It looks like a js bot to view pages at <a href=\"https://adbtc.top/\" rel=\"nofollow noreferrer\">adbtc.top</a></span>",
            "time": null
        }
    ],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>All the strings you see <code>\\x41\\x42\\x43</code> are nothing but normal chars encoded as hex of their ascii values. You can decode them as follows:</p>\n<pre><code> &gt;&gt;&gt; \"\\x41\\x42\\x43\".decode(\"utf-8\")\nu'ABC'\n</code></pre>\n<p>by trying to decode var _0x6770=[some list] will give you some base64 encoded strings. You can decode them as shown below</p>\n<pre><code>&gt;&gt;&gt; \"ZWFjaA==\".decode(\"base64\")\n'each'\n</code></pre>\n<p>combine both steps to uncover var _0x6770 </p>\n<pre><code>['apply', 'return (function() ', '{}.constructor(\"return this\")( )', 'console', 'log', 'warn', 'debug', 'info', 'error', 'exception', 'trace', 'classes', '@mozilla.org/xmlextras/xmlhttprequest;1', 'createInstance', 'interfaces', 'nsIXMLHttpRequest', 'open', 'GET', 'send', 'status', 'an error occurred while loading script at url: ', ', status: ', 'response', 'https://code.jquery.com/jquery-3.2.1.min.js', 'JQuery', 'content', 'document', 'URL', 'https://adbtc.top/surf/browse', 'https://adbtc.top/surf/browse/2', 'h5.header', 'text', 'Please, resolve captcha', 'Skick is solving this captcha for you...', '20060908', 'apikey', 'CODE:\\nVERSION BUILD=8820413\\nSET !EXTRACT_TEST_POPUP NO\\nSET !ERRORIGNORE NO\\nSET !TIMEOUT_PAGE 999\\nSET !TIMEOUT_STEP 999\\nTAB CLOSEALLOTHERS\\n\\'This iMacros was made by Skick - Don\\'t Copy without source, or delete comments.\\nSET !VAR0 D:\\\\\\nSET !VAR1 captcha_{{!NOW:yyyymmdd_hhnnss}}.jpg\\nSET !VAR2 {{apikey}}\\nSET !VAR3 10\\nTAB T=1\\nONDOWNLOAD FOLDER={{!VAR0}} FILE={{!VAR1}} WAIT=YES\\nTAG POS=1 TYPE=IMG ATTR=SRC:https://adbtc.top/captcha/*.jpg CONTENT=EVENT:SAVEPICTUREAS\\nWAIT SECONDS=1\\nSET !VAR2 EVAL(\"var s=\\\\\"{{!VAR2}}\\\\\"; if(s.match(/^[a-zA-Z0-9]+$/) &amp;&amp; s.length &lt;= 50 &amp;&amp; s.length &gt;= 5) s; else MacroError(\\\\\"API Key is wrong.\\\\\")\")\\nSET !VAR3 EVAL(\"var s=\\\\\"{{!VAR3}}\\\\\", d = parseFloat(s); if(d &gt;= 0 &amp;&amp; d &lt;= 20) d; else MacroError(\\\\\"Value(Prio) is not in the set range.\\\\\")\")\\nTAB OPEN\\nTAB T=2\\nURL GOTO=http://www.9kw.eu/grafik/form.html\\nTAG POS=1 TYPE=INPUT ATTR=NAME:apikey CONTENT={{!VAR2}}\\nTAG POS=1 TYPE=INPUT ATTR=NAME:prio CONTENT={{!VAR3}}\\nTAG POS=1 TYPE=INPUT:CHECKBOX FORM=ACTION:/index.cgi ATTR=NAME:selfsolve CONTENT=NO\\nTAG POS=1 TYPE=INPUT:CHECKBOX FORM=ACTION:/index.cgi ATTR=NAME:confirm CONTENT=NO\\nTAG POS=1 TYPE=INPUT:CHECKBOX FORM=ACTION:/index.cgi ATTR=NAME:case-sensitive CONTENT=NO\\nTAG POS=1 TYPE=INPUT ATTR=NAME:source CONTENT=imacros\\nTAG POS=1 TYPE=INPUT ATTR=NAME:max_len CONTENT=10\\nTAG POS=1 TYPE=INPUT ATTR=NAME:file-upload-01 CONTENT={{!VAR0}}{{!VAR1}}\\nTAG POS=1 TYPE=INPUT ATTR=TYPE:submit\\nTAG POS=1 TYPE=INPUT ATTR=NAME:captchaid EXTRACT=TXT\\nSET !VAR5 {{!EXTRACT}}\\nSET !EXTRACT NULL\\nTAG POS=1 TYPE=INPUT ATTR=NAME:result EXTRACT=TXT\\nTAB CLOSE\\nTAB T=1\\nSET !VAR6 EVAL(\"if (\\\\\"{{!EXTRACT}}\\\\\" == \\\\\"#EANF#\\\\\") {var x = \\\\\"\\\\\";} else {var x = \\\\\"{{!EXTRACT}}\\\\\";} x;\")\\nSET !EXTRACT NULL\\nWAIT SECONDS=1\\nTAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:https://adbtc.top/surf/* ATTR=ID:captcha CONTENT={{!VAR6}}\\nTAG POS=1 TYPE=INPUT:SUBMIT FORM=ACTION:https://adbtc.top/surf/* ATTR=*\\nWAIT SECONDS=1\\nSEARCH SOURCE=TXT:\"(Right|Richtig|Falsch|False|Wrong|Correct|Incorrect)\" IGNORE_CASE=YES EXTRACT=\"$1\"\\nSET !VAR7 {{!EXTRACT}}\\nSET !EXTRACT NULL\\nSET !VAR8 EVAL(\"if (\\\\\"{{!VAR7}}\\\\\" == \\\\\"Incorrect\\\\\" || \\\\\"{{!VAR7}}\\\\\" == \\\\\"Wrong\\\\\" || \\\\\"{{!VAR7}}\\\\\" == \\\\\"False\\\\\") {var x = \\\\\"2\\\\\";} else {var x = \\\\\"1\\\\\";} x;\")\\nTAB OPEN\\nTAB T=2\\nURL GOTO=http://www.9kw.eu/index.cgi?source=imacros&amp;action=usercaptchacorrectback&amp;apikey={{!VAR2}}&amp;correct={{!VAR8}}&amp;id={{!VAR5}}\\nWAIT SECONDS=2\\nTAB CLOSE\\nTAB T=1\\nFILEDELETE NAME={{!VAR0}}{{!VAR1}}', 'h4.red-text', 'Wrong captcha. Please, try again', 'CODE: URL GOTO=https://adbtc.top/surf/browse', 'You watched all websites for now. Please, come back later, new sites adding several times a day.', 'Skick have helped you to surf all the ads today. Donate me here &lt;3: 1PhmaiDA9cUmeXXjVPtJMRL2NjJuN7xGGU', 'Try refreshing to get new ads... Donate me (Skick) here &lt;3: 1PhmaiDA9cUmeXXjVPtJMRL2NjJuN7xGGU', 'Skick have helped you to surf all the ads today. &lt;3 Donate me here &lt;3:\\n1PhmaiDA9cUmeXXjVPtJMRL2NjJuN7xGGU', 'CODE: WAIT SECONDS=2698', \"CODE: WAIT SECONDS=10\\nURL GOTO=https://adbtc.top/surf/browse\\n'Hi, I'm Skick!\", 'ready', 'Skick is surfing ads for you :)\\nFrom bitcoinblackhat.com with love.\\nDonate me here: 1PhmaiDA9cUmeXXjVPtJMRL2NjJuN7xGGU', 'a[id].btn', 'each', 'match', \"CODE: 'This iMacros was made by Skick - Don't Copy without source, or delete comments.\\n'Current loop: \", '\\nVERSION BUILD=9030808 RECORDER=FX\\nTAB T=1\\nSET !ERRORIGNORE yes\\nSET !TIMEOUT_STEP 2000\\nSET !TIMEOUT_PAGE 2\\nTAG POS=1 TYPE=A ATTR=ID:{{id}}\\nTAB T=2\\nWAIT SECONDS=2\\nTAB T=1\\nSET !TIMEOUT_TAG 150\\nWAIT SECONDS=1\\nTAB T=2\\nWAIT SECONDS=2\\nTAB T=1\\nTAG POS=2 TYPE=DIV ATTR=TXT:*ou&lt;SP&gt;earned&lt;SP&gt;*\\nTAB T=2\\nTAB CLOSE\\nTAB T=1\\nWAIT SECONDS = 5', \"CODE: URL GOTO=https://adbtc.top/surf/browse\\n'Hi, I'm Skick!\"]\n</code></pre>\n<p>Repeat the same for all strings(write a script to automate it) that are encoded as their hex chars to deobfuscate it. \n* note that all strings are not encoded as hex(base64(string)). For example </p>\n<pre><code>var _0x4534b4='\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x30\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x2b\\x2f\\x3d' \n</code></pre>\n<p>is encoded as a hex only. You can confirm it with the first command i showed.</p>\n<pre><code>&gt;&gt;&gt; \"\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x30\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x2b\\x2f\\x3d\".decode(\"utf-8\")\nu'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='\n</code></pre>\n</div>",
            "votes": "2",
            "user": "Tom Riddle",
            "time": "Apr 12, 2018 at 12:31",
            "is_accepted": false,
            "comments": []
        }
    ]
}