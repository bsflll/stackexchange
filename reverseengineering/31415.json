{
    "title": "How can I detect which Android native function that is hooked by Mobile Substrate: MSHookFunction?",
    "link": "https://reverseengineering.stackexchange.com/questions/31415/how-can-i-detect-which-android-native-function-that-is-hooked-by-mobile-substrat",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>I want to detect hook behavior of MSHookFunction on Android. This is Mobile Substrate I use in my test app <a href=\"https://github.com/Breathleas/Android-Hooking-Template-Cydia-Substrate/tree/master/jni/Substrate\" rel=\"nofollow noreferrer\">https://github.com/Breathleas/Android-Hooking-Template-Cydia-Substrate/tree/master/jni/Substrate</a></p>\n<p>After complete function hook. I tried comparing the <code>.text</code> section between the in-memory module and the shared object lib file but couldn't find the trampoline function. Here is the Frida script on the codeshare that I referenced <a href=\"https://codeshare.frida.re/@lichao890427/find-android-hook/\" rel=\"nofollow noreferrer\">https://codeshare.frida.re/@lichao890427/find-android-hook/</a>. The origin function is hooked but <code>.text</code> section data in memory is same with shared object lib file. I also used memory tools like Cheat Engine or Game-Guardian (on Android) to look for the offset I hooked in memory and found it wasn't replaced. So, how did MSHookFunction work and how can I detect hooked functions ?</p>\n</div>",
    "votes": "2",
    "answers": 0,
    "views": "213",
    "tags": [
        "android",
        "function-hooking",
        "frida"
    ],
    "user": "Ken Kem",
    "time": "Jan 16, 2023 at 3:08",
    "comments": [],
    "answers_data": []
}