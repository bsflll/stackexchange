{
    "title": "How identify witch cpu run assembly [duplicate]",
    "link": "https://reverseengineering.stackexchange.com/questions/18605/how-identify-witch-cpu-run-assembly",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<div>\n<aside class=\"s-notice s-notice__info post-notice js-post-notice mb16\" role=\"status\">\n<div class=\"d-flex fd-column fw-nowrap\">\n<div class=\"d-flex fw-nowrap\">\n<div class=\"flex--item wmn0 fl1 lh-lg\">\n<div class=\"flex--item fl1 lh-lg\">\n<div>\n<b>This question already has answers here</b>:\n                                \n                            </div>\n</div>\n</div>\n</div>\n<div class=\"flex--item mb0 mt4\">\n<a dir=\"ltr\" href=\"/questions/2897/tool-or-data-for-analysis-of-binary-code-to-detect-cpu-architecture\">Tool or data for analysis of binary code to detect CPU architecture</a>\n<span class=\"question-originals-answer-count\">\n                                (6 answers)\n                            </span>\n</div>\n<div class=\"flex--item mb0 mt8\">Closed <span class=\"relativetime\" title=\"2018-06-27 13:08:47Z\">6 years ago</span>.</div>\n</div>\n</aside>\n</div>\n<p>I have around 300 bytes of binary machine code.</p>\n<p>I don't know which instruction set the code is for so I can't open it with IDA.</p>\n<p>Is there any tool that can help identify the instruction set?</p>\n</div>",
    "votes": "2",
    "answers": 2,
    "views": "2k",
    "tags": [
        "ida",
        "disassembly",
        "machine-code"
    ],
    "user": "FIF9K9J",
    "time": "6 years ago",
    "comments": [
        {
            "user": "julian",
            "text": "<span class=\"comment-copy\">Developing techniques for identification of the target architecture of object code is a challenge being actively researched. The approach used by <code>binwalk</code> is scanning for opcode signatures. See <a href=\"https://www.sciencedirect.com/science/article/pii/S1742287615000523\" rel=\"nofollow noreferrer\">Automatic classification of object code using machine learning</a> as an example of a different approach.</span>",
            "time": null
        }
    ],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>There are several tools to identify the opcodes in a file.</p>\n<ol>\n<li><p><code>binwalk</code></p>\n<p>If your blob is an archive and mix several files or has no magic numbers at the beginning, then try to run <code>binwalk</code> on it with the following options (see <a href=\"https://github.com/ReFirmLabs/binwalk/wiki/Usage\" rel=\"nofollow noreferrer\">binwalk's documentation</a> for more details):</p>\n<pre><code>#&gt; binwalk --opcodes myfile.bin\n</code></pre>\n<p>If you are using IDA, you can also use this <a href=\"https://github.com/ReFirmLabs/binwalk/wiki/Using-the-Binwalk-IDA-Plugin\" rel=\"nofollow noreferrer\">binwalk IDA plugin</a>.</p>\n<p><a href=\"https://i.sstatic.net/4aGnG.png\" rel=\"nofollow noreferrer\"><img alt=\"Binwalk IDA Plugin Menu\" src=\"https://i.sstatic.net/4aGnG.png\"/></a></p>\n<p><a href=\"https://i.sstatic.net/5sqfr.png\" rel=\"nofollow noreferrer\"><img alt=\"Result of the Binwalk IDA Plugin\" src=\"https://i.sstatic.net/5sqfr.png\"/></a></p></li>\n<li><p><code>file</code></p>\n<p>If your file has some magic numbers, then the easiest way would be to run a <code>file</code> on it. This program identify a lot of different file formats and display a lot of information about each format.</p>\n<pre><code>#&gt; file myfile.bin\n</code></pre></li>\n</ol>\n</div>",
            "votes": "3",
            "user": "perror",
            "time": "Jun 26, 2018 at 17:47",
            "is_accepted": false,
            "comments": [
                {
                    "user": "FIF9K9J",
                    "text": "<span class=\"comment-copy\">I don't have a bin fie,  I just have 400 bytes of hex  , I can copy it to bin file</span>",
                    "time": null
                },
                {
                    "user": "perror",
                    "text": "<span class=\"comment-copy\">Then, <code>binwalk</code>...</span>",
                    "time": null
                },
                {
                    "user": "perror",
                    "text": "<span class=\"comment-copy\">Ah, you can also use this <a href=\"https://github.com/ReFirmLabs/binwalk/wiki/Using-the-Binwalk-IDA-Plugin\" rel=\"nofollow noreferrer\">binwalk IDAplugin</a>.</span>",
                    "time": null
                },
                {
                    "user": "zerocool",
                    "text": "<span class=\"comment-copy\">what if the code is a vm code this method won't work special if it is handmade vm @perror</span>",
                    "time": null
                },
                {
                    "user": "perror",
                    "text": "<span class=\"comment-copy\">If you can see the bytes, then you can extract it... there is no magic here.</span>",
                    "time": null
                }
            ]
        },
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>You might try to use <a href=\"https://github.com/airbus-seclab/cpu_rec\" rel=\"nofollow noreferrer\"><strong>cpu_rec</strong></a> it claims to be able to identify a wide variety of architectures by analyzing the raw binary data ( 70 architectures).</p>\n<p>cpu_rec is a tool that recognizes cpu instructions in an arbitrary binary file. It can be used as a standalone tool, or as a plugin for <a href=\"https://github.com/ReFirmLabs/binwalk\" rel=\"nofollow noreferrer\">binwalk</a>.  </p>\n<h1>How to use the tool</h1>\n<h2>As a binwalk module</h2>\n<p>Add the flag <code>-%</code> when using binwalk.</p>\n<p>Be patient. Waiting a few minutes for the result is to be expected.\nOn my laptop the tool takes 25 seconds and 1 Gb of RAM\nto create the signatures for 70 architectures, and then the analysis\nof a binary takes one minute per Mb.\nIf you want the tool to be faster, you can remove some architectures,\nif you know that your binary is not one of them (typically Cray or\nMMIX are not found in a firmware).</p>\n<h2>As a standalone tool</h2>\n<p>Just run the tool, with the binary file(s) to analyze as argument(s)\nThe tool will try to match an architecture for the whole file, and\nthen to detect the largest binary chunk that corresponds to a CPU\narchitecture; usually it is the right answer.</p>\n<p>If the result is not satisfying, prepending twice <code>-v</code> to the arguments\nmakes the tool very verbose; this is helpful when adding a new\narchitecture to the corpus.</p>\n<p>If <a href=\"https://github.com/LRGH/elfesteem\" rel=\"nofollow noreferrer\">https://github.com/LRGH/elfesteem</a> is installed, then the\ntool also extract the text section from ELF, PE, Mach-O or COFF\nfiles, and outputs the architecture corresponding to this section;\nthe possibility of extracting the text section is also used when\nbuilding a corpus from full binary files.</p>\n<p>Option <code>-d</code> followed by a directory dumps the corpus in that directory;\nusing this option one can reconstruct the default corpus.</p>\n<h1>Examples</h1>\n<p>Running the tool as a binwalk module typically results in:</p>\n<pre><code>shell_prompt&gt; binwalk -% corpus/PE/PPC/NTDLL.DLL corpus/MSP430/goodfet32.hex\n\nTarget File:   .../corpus/PE/PPC/NTDLL.DLL\nMD5 Checksum:  d006a2a87a3596c744c5573aece81d77\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             None (size=0x5800, entropy=0.620536)\n22528         0x5800          PPCel (size=0x4c800, entropy=0.737337)\n335872        0x52000         None (size=0x1000, entropy=0.720493)\n339968        0x53000         IA-64 (size=0x800, entropy=0.491011)\n342016        0x53800         None (size=0x22000, entropy=0.727501)\n\nTarget File:   .../corpus/MSP430/goodfet32.hex\nMD5 Checksum:  4b295284024e2b6a6257b720a7168b92\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             MSP430 (size=0x5200, entropy=0.472185)\n20992         0x5200          None (size=0xe00, entropy=0.467086)\n</code></pre>\n<p>We can notice that during the analysis of <code>PPC/NTDLL.DLL</code>\na small chunk has been identified as <code>IA-64</code>.\nThis is an erroneous detection, due to the fact that\nthe IA-64 architecture has statistical properties similar\nto data sections.</p>\n<p>If the entropy value is above 0.9, it is probably encrypted or compressed\ndata, and therefore the result of cpu_rec should be meaningless.</p>\n<p>Known architectures in the default corpus<br/>\n<a href=\"https://en.wikipedia.org/wiki/Freescale_68HC08\" rel=\"nofollow noreferrer\"><code>68HC08</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Freescale_68HC11\" rel=\"nofollow noreferrer\"><code>68HC11</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Intel_MCS-51\" rel=\"nofollow noreferrer\"><code>8051</code></a>\n<a href=\"https://en.wikipedia.org/wiki/DEC_Alpha\" rel=\"nofollow noreferrer\"><code>Alpha</code></a>\n<a href=\"https://en.wikipedia.org/wiki/ARC_(processor)\" rel=\"nofollow noreferrer\"><code>ARcompact</code></a>\n<a href=\"https://en.wikipedia.org/wiki/ARM_architecture\" rel=\"nofollow noreferrer\"><code>ARM64</code> <code>ARMeb</code> <code>ARMel</code> <code>ARMhf</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Atmel_AVR\" rel=\"nofollow noreferrer\"><code>AVR</code></a>\n<a href=\"https://en.wikipedia.org/wiki/ETRAX_CRIS\" rel=\"nofollow noreferrer\"><code>AxisCris</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Blackfin\" rel=\"nofollow noreferrer\"><code>Blackfin</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Cell_(microprocessor)\" rel=\"nofollow noreferrer\"><code>Cell-SPU</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Clipper_architecture\" rel=\"nofollow noreferrer\"><code>CLIPPER</code></a>\n<a href=\"https://en.wikipedia.org/wiki/CompactRISC\" rel=\"nofollow noreferrer\"><code>CompactRISC</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Cray\" rel=\"nofollow noreferrer\"><code>Cray</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Adapteva\" rel=\"nofollow noreferrer\"><code>Epiphany</code></a>\n<a href=\"https://en.wikipedia.org/wiki/FR-V_(microprocessor)\" rel=\"nofollow noreferrer\"><code>FR-V</code></a>\n<a href=\"http://www.fujitsu.com/downloads/MICRO/fma/pdfmcu/hm91101-cm71-10102-2e.pdf\" rel=\"nofollow noreferrer\"><code>FR30</code></a>\n<a href=\"https://en.wikipedia.org/wiki/FTDI\" rel=\"nofollow noreferrer\"><code>FT32</code></a>\n<a href=\"https://en.wikipedia.org/wiki/H8_Family\" rel=\"nofollow noreferrer\"><code>H8-300</code></a>\n<a href=\"https://en.wikipedia.org/wiki/HP_FOCUS\" rel=\"nofollow noreferrer\"><code>HP-Focus</code></a>\n<a href=\"https://en.wikipedia.org/wiki/PA-RISC\" rel=\"nofollow noreferrer\"><code>HP-PA</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Intel_i860\" rel=\"nofollow noreferrer\"><code>i860</code></a>\n<a href=\"https://en.wikipedia.org/wiki/IA-64\" rel=\"nofollow noreferrer\"><code>IA-64</code></a>\n<a href=\"http://www.ic72.com/pdf_file/v/165699.pdf\" rel=\"nofollow noreferrer\"><code>IQ2000</code></a>\n<a href=\"https://www.renesas.com/en-eu/products/microcontrollers-microprocessors/m16c.html\" rel=\"nofollow noreferrer\"><code>M32C</code></a>\n<a href=\"https://www.renesas.com/en-eu/products/microcontrollers-microprocessors/m32r.html\" rel=\"nofollow noreferrer\"><code>M32R</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Motorola_68000_series\" rel=\"nofollow noreferrer\"><code>M68k</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Motorola_88000\" rel=\"nofollow noreferrer\"><code>M88k</code></a>\n<a href=\"https://en.wikipedia.org/wiki/M%C2%B7CORE\" rel=\"nofollow noreferrer\"><code>MCore</code></a>\n<a href=\"https://en.wikipedia.org/wiki/LatticeMico32\" rel=\"nofollow noreferrer\"><code>Mico32</code></a>\n<a href=\"https://en.wikipedia.org/wiki/MicroBlaze\" rel=\"nofollow noreferrer\"><code>MicroBlaze</code></a>\n<a href=\"https://en.wikipedia.org/wiki/MIPS_instruction_set\" rel=\"nofollow noreferrer\"><code>MIPS16</code> <code>MIPSeb</code> <code>MIPSel</code></a>\n<a href=\"https://en.wikipedia.org/wiki/MMIX\" rel=\"nofollow noreferrer\"><code>MMIX</code></a>\n<a href=\"https://en.wikipedia.org/wiki/MN103\" rel=\"nofollow noreferrer\"><code>MN10300</code></a>\n<a href=\"http://moxielogic.org/blog/\" rel=\"nofollow noreferrer\"><code>Moxie</code></a>\n<a href=\"https://en.wikipedia.org/wiki/TI_MSP430\" rel=\"nofollow noreferrer\"><code>MSP430</code></a>\n<a href=\"http://osdk.andestech.com/index.html\" rel=\"nofollow noreferrer\"><code>NDS32</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Nios_II\" rel=\"nofollow noreferrer\"><code>NIOS-II</code></a>\n<a href=\"https://en.wikipedia.org/wiki/OCaml\" rel=\"nofollow noreferrer\"><code>OCaml</code></a>\n<a href=\"https://en.wikipedia.org/wiki/PDP-11\" rel=\"nofollow noreferrer\"><code>PDP-11</code></a>\n<a href=\"https://en.wikipedia.org/wiki/PIC_microcontroller\" rel=\"nofollow noreferrer\"><code>PIC10</code> <code>PIC16</code> <code>PIC18</code> <code>PIC24</code></a>\n<a href=\"https://en.wikipedia.org/wiki/PowerPC\" rel=\"nofollow noreferrer\"><code>PPCeb</code> <code>PPCel</code></a>\n<a href=\"https://en.wikipedia.org/wiki/RISC-V\" rel=\"nofollow noreferrer\"><code>RISC-V</code></a>\n<a href=\"https://www.renesas.com/en-eu/products/microcontrollers-microprocessors/rl78.html\" rel=\"nofollow noreferrer\"><code>RL78</code></a>\n<a href=\"https://en.wikipedia.org/wiki/ROMP\" rel=\"nofollow noreferrer\"><code>ROMP</code></a>\n<a href=\"https://www.renesas.com/en-eu/products/microcontrollers-microprocessors/rx.html\" rel=\"nofollow noreferrer\"><code>RX</code></a>\n<a href=\"https://en.wikipedia.org/wiki/IBM_System/390_ES/9000_Enterprise_Systems_Architecture_ESA_family\" rel=\"nofollow noreferrer\"><code>S-390</code></a>\n<a href=\"https://en.wikipedia.org/wiki/SPARC\" rel=\"nofollow noreferrer\"><code>SPARC</code></a>\n<a href=\"https://en.wikipedia.org/wiki/STM8\" rel=\"nofollow noreferrer\"><code>STM8</code></a>\n<a href=\"https://sourceware.org/cgen/gen-doc/xstormy16.html\" rel=\"nofollow noreferrer\"><code>Stormy16</code></a>\n<a href=\"https://en.wikipedia.org/wiki/SuperH\" rel=\"nofollow noreferrer\"><code>SuperH</code></a>\n<a href=\"https://en.wikipedia.org/wiki/TILEPro64\" rel=\"nofollow noreferrer\"><code>TILEPro</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Toshiba_TLCS#90\" rel=\"nofollow noreferrer\"><code>TLCS-90</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Texas_Instruments_TMS320\" rel=\"nofollow noreferrer\"><code>TMS320C2x</code> <code>TMS320C6x</code></a>\n<a href=\"https://en.wikipedia.org/wiki/V850\" rel=\"nofollow noreferrer\"><code>V850</code></a>\n<a href=\"https://en.wikipedia.org/wiki/VAX\" rel=\"nofollow noreferrer\"><code>VAX</code></a>\n<a href=\"https://www.slideshare.net/AdaCore/controls-and-dataservices\" rel=\"nofollow noreferrer\"><code>Visium</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Bellmac_32\" rel=\"nofollow noreferrer\"><code>WE32000</code></a>\n<a href=\"https://en.wikipedia.org/wiki/X86-64\" rel=\"nofollow noreferrer\"><code>X86-64</code></a>\n<a href=\"https://en.wikipedia.org/wiki/X86\" rel=\"nofollow noreferrer\"><code>X86</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Tensilica\" rel=\"nofollow noreferrer\"><code>Xtensa</code></a>\n<a href=\"https://en.wikipedia.org/wiki/Zilog_Z80\" rel=\"nofollow noreferrer\"><code>Z80</code></a>\n<a href=\"https://github.com/cc65/cc65\" rel=\"nofollow noreferrer\"><code>#6502#cc65</code></a></p>\n</div>",
            "votes": "1",
            "user": "user22363",
            "time": "Jun 26, 2018 at 22:34",
            "is_accepted": false,
            "comments": [
                {
                    "user": "julian",
                    "text": "<span class=\"comment-copy\">This tool is unreliable due to its tendency to produce false positives. This is due in large part to a lack of binary file preprocessing required to identify and differentiate between data and code regions (\"de-noising\"). It is telling that in the only example given a false positive is produced.</span>",
                    "time": null
                }
            ]
        }
    ]
}