{
    "title": "Is there a tool to see kernel space mapping of a Windows exe?",
    "link": "https://reverseengineering.stackexchange.com/questions/9477/is-there-a-tool-to-see-kernel-space-mapping-of-a-windows-exe",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>In Microsoft Windows, a 32bits process <code>calc.exe</code> has <code>0x0</code>-<code>0x80000000</code> (2GB) reserved as its user-space and the rest is kernel-space (2GB). So, a process has <code>2+2 = 4GB</code> of virtual space. This ratio could be 3:1 also.</p>\n<p>The 2GB user space has the PEB information,the heap,the stack, the executable and other dll's which the the exe uses like kernel32.dll, user32.dll, etc.</p>\n<ul>\n<li><p><strong>Doubt 1&gt;</strong> What does the 2GB kernel space encompasses in itself ?</p>\n<p>Is there a tool to see kernel-space mapping (for the user-space mapping  I used OllyDbg).</p>\n</li>\n<li><p><strong>Doubt 2&gt;</strong> What happens when <code>ntoskrnl.exe</code> runs ? It doesn't use the native API (but exports implementation of these native APIs to user-space via <code>ntdll.dll</code>. So, that native application could use it before win32 kicks in). Therefore, there should be no dlls in the virtual space of <code>ntoskrnl.exe</code>.</p>\n<p>Is <code>ntoskrnl.exe</code> located in kernel-space ?</p>\n</li>\n</ul>\n</div>",
    "votes": "5",
    "answers": 3,
    "views": "616",
    "tags": [
        "windows",
        "ollydbg",
        "windbg",
        "winapi"
    ],
    "user": "rebel87",
    "time": "Jun 17, 2020 at 9:54",
    "comments": [],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p><em>Please only ask one question per post. This answer is in response to your first of two questions.</em></p>\n<blockquote>\n<p>Is there a tool to see kernel-space mapping</p>\n</blockquote>\n<p>Yes, you can use <a href=\"https://technet.microsoft.com/en-us/sysinternals/bb897415.aspx\" rel=\"nofollow\">LiveKd</a> to examine the contents of kernel space.</p>\n<p>For example, I can see the loaded modules and their addresses in kernel-space with the command <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff552026.aspx\" rel=\"nofollow\"><code>lmvk</code></a>:</p>\n<pre><code>kd&gt; lmvk\nstart    end        module name\n80bd5000 80bdd000   kdcom      (pdb symbols)          c:\\symbols\\kdcom.pdb\\F48BD9BC030C43D89689518F892586901\\kdcom.pdb\n    Loaded symbol image file: kdcom.dll\n    Image path: kdcom.dll\n    Image name: kdcom.dll\n    Timestamp:        Mon Jul 13 20:08:58 2009 (4A5BDAAA)\n    CheckSum:         000138B1\n    ImageSize:        00008000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n82816000 82c28000   nt         (pdb symbols)          c:\\symbols\\ntkrpamp.pdb\\CE18EBF87B6A4C5CBF77806534BD94782\\ntkrpamp.pdb\n    Loaded symbol image file: ntkrpamp.exe\n    Image path: ntkrpamp.exe\n    Image name: ntkrpamp.exe\n    Timestamp:        Sat Nov 19 05:51:44 2011 (4EC79850)\n    CheckSum:         003CAC28\n    ImageSize:        00412000\n    File version:     6.1.7601.17727\n    Product version:  6.1.7601.17727\n    File flags:       0 (Mask 3F)\n    File OS:          40004 NT Win32\n    File type:        1.0 App\n    File date:        00000000.00000000\n    Translations:     0409.04b0\n    CompanyName:      Microsoft Corporation\n    ProductName:      Microsoft® Windows® Operating System\n    InternalName:     ntkrpamp.exe\n    OriginalFilename: ntkrpamp.exe\n    ProductVersion:   6.1.7601.17727\n    FileVersion:      6.1.7601.17727 (win7sp1_gdr.111118-2330)\n    FileDescription:  NT Kernel &amp; System\n    LegalCopyright:   © Microsoft Corporation. All rights reserved.\n82c28000 82c5f000   hal        (pdb symbols)          c:\\symbols\\halmacpi.pdb\\AE605D6C59454802AE1D485E0B089A571\\halmacpi.pdb\n    Loaded symbol image file: halmacpi.dll\n    Image path: halmacpi.dll\n    Image name: halmacpi.dll\n    Timestamp:        Sat Nov 20 02:37:38 2010 (4CE788D2)\n    CheckSum:         00037FB1\n    ImageSize:        00037000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n82e09000 82e14000   mcupdate_AuthenticAMD   (no symbols)           \n    Loaded symbol image file: mcupdate_AuthenticAMD.dll\n    Image path: \\SystemRoot\\system32\\mcupdate_AuthenticAMD.dll\n    Image name: mcupdate_AuthenticAMD.dll\n    Timestamp:        Mon Jul 13 18:13:13 2009 (4A5BBF89)\n    CheckSum:         0000BD79\n    ImageSize:        0000B000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n82e14000 82e25000   PSHED      (pdb symbols)          c:\\symbols\\pshed.pdb\\5ACEAFD8AD3A46FEAD083AFDF675DA391\\pshed.pdb\n    Loaded symbol image file: PSHED.dll\n    Image path: \\SystemRoot\\system32\\PSHED.dll\n    Image name: PSHED.dll\n    Timestamp:        Mon Jul 13 20:09:36 2009 (4A5BDAD0)\n    CheckSum:         000108A2\n    ImageSize:        00011000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n82e25000 82e2d000   BOOTVID    (pdb symbols)          c:\\symbols\\bootvid.pdb\\10C3ABD4165D4ED3A9493BB094B44AEA1\\bootvid.pdb\n    Loaded symbol image file: BOOTVID.dll\n    Image path: \\SystemRoot\\system32\\BOOTVID.dll\n    Image name: BOOTVID.dll\n    Timestamp:        Mon Jul 13 20:04:34 2009 (4A5BD9A2)\n    CheckSum:         00010FF0\n    ImageSize:        00008000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n82e2d000 82e6f000   CLFS       (pdb symbols)          c:\\symbols\\clfs.pdb\\04F22EAC7BD04A1BA81A6FB5D319649F1\\clfs.pdb\n    Loaded symbol image file: CLFS.SYS\n    Image path: \\SystemRoot\\system32\\CLFS.SYS\n    Image name: CLFS.SYS\n    Timestamp:        Mon Jul 13 18:11:10 2009 (4A5BBF0E)\n    CheckSum:         000461C7\n    ImageSize:        00042000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n82e6f000 82f1a000   CI         (pdb symbols)          c:\\symbols\\ci.pdb\\3358E6E48A5245F6AB97EA05356E020F1\\ci.pdb\n    Loaded symbol image file: CI.dll\n    Image path: \\SystemRoot\\system32\\CI.dll\n    Image name: CI.dll\n    Timestamp:        Sat Nov 20 06:05:17 2010 (4CE7B97D)\n    CheckSum:         000ADFF9\n    ImageSize:        000AB000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n82f1a000 82f8b000   Wdf01000   (pdb symbols)          c:\\symbols\\Wdf01000.pdb\\A9E46808F4F748178D3071AA9EE76FB71\\Wdf01000.pdb\n    Loaded symbol image file: Wdf01000.sys\n    Image path: \\SystemRoot\\system32\\drivers\\Wdf01000.sys\n    Image name: Wdf01000.sys\n    Timestamp:        Mon Jul 13 18:11:36 2009 (4A5BBF28)\n    CheckSum:         000717B7\n    ImageSize:        00071000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n82f8b000 82f99000   WDFLDR     (pdb symbols)          c:\\symbols\\wdfldr.pdb\\95D9DB57778548E6B6774520468479891\\wdfldr.pdb\n    Loaded symbol image file: WDFLDR.SYS\n    Image path: \\SystemRoot\\system32\\drivers\\WDFLDR.SYS\n    Image name: WDFLDR.SYS\n    Timestamp:        Mon Jul 13 18:11:25 2009 (4A5BBF1D)\n    CheckSum:         00009DF6\n    ImageSize:        0000E000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n82f99000 82fe1000   ACPI       (pdb symbols)          c:\\symbols\\acpi.pdb\\E7300A0CC3524834A4E1E55773C1901E1\\acpi.pdb\n    Loaded symbol image file: ACPI.sys\n    Image path: \\SystemRoot\\system32\\drivers\\ACPI.sys\n    Image name: ACPI.sys\n    Timestamp:        Sat Nov 20 02:37:52 2010 (4CE788E0)\n    CheckSum:         0004F583\n    ImageSize:        00048000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n82fe1000 82fea000   WMILIB     (pdb symbols)          c:\\symbols\\wmilib.pdb\\F52B38A4800849D48BFFD48715A446A51\\wmilib.pdb\n    Loaded symbol image file: WMILIB.SYS\n    Image path: \\SystemRoot\\system32\\drivers\\WMILIB.SYS\n    Image name: WMILIB.SYS\n    Timestamp:        Mon Jul 13 18:11:22 2009 (4A5BBF1A)\n    CheckSum:         0000B93D\n    ImageSize:        00009000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n82fea000 82ff2000   msisadrv   (pdb symbols)          c:\\symbols\\msisadrv.pdb\\5D6926DA4AD1474BAE8CBDA5909F68201\\msisadrv.pdb\n    Loaded symbol image file: msisadrv.sys\n    Image path: \\SystemRoot\\system32\\drivers\\msisadrv.sys\n    Image name: msisadrv.sys\n    Timestamp:        Mon Jul 13 18:11:09 2009 (4A5BBF0D)\n    CheckSum:         0000CD81\n    ImageSize:        00008000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87800000 87811000   fileinfo   (pdb symbols)          c:\\symbols\\fileinfo.pdb\\EBD1E885413A4242AA515F1B06BB564F1\\fileinfo.pdb\n    Loaded symbol image file: fileinfo.sys\n    Image path: \\SystemRoot\\system32\\drivers\\fileinfo.sys\n    Image name: fileinfo.sys\n    Timestamp:        Mon Jul 13 18:21:51 2009 (4A5BC18F)\n    CheckSum:         0001E423\n    ImageSize:        00011000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n8781a000 87844000   pci        (pdb symbols)          c:\\symbols\\pci.pdb\\2E2A912260694615A7E97AFBA3FA934E1\\pci.pdb\n    Loaded symbol image file: pci.sys\n    Image path: \\SystemRoot\\system32\\drivers\\pci.sys\n    Image name: pci.sys\n    Timestamp:        Sat Nov 20 02:37:57 2010 (4CE788E5)\n    CheckSum:         0002B72C\n    ImageSize:        0002A000\n    File version:     6.1.7601.17514\n    Product version:  6.1.7601.17514\n    File flags:       0 (Mask 3F)\n    File OS:          40004 NT Win32\n    File type:        2.0 Dll\n    File date:        00000000.00000000\n    Translations:     0409.04b0\n    CompanyName:      Microsoft Corporation\n    ProductName:      Microsoft® Windows® Operating System\n    InternalName:     pci.sys\n    OriginalFilename: pci.sys\n    ProductVersion:   6.1.7601.17514\n    FileVersion:      6.1.7601.17514 (win7sp1_rtm.101119-1850)\n    FileDescription:  NT Plug and Play PCI Enumerator\n    LegalCopyright:   © Microsoft Corporation. All rights reserved.\n87844000 8784f000   vdrvroot   (pdb symbols)          c:\\symbols\\vdrvroot.pdb\\3C9D6939EF564015B8D0728611C88C221\\vdrvroot.pdb\n    Loaded symbol image file: vdrvroot.sys\n    Image path: \\SystemRoot\\system32\\drivers\\vdrvroot.sys\n    Image name: vdrvroot.sys\n    Timestamp:        Mon Jul 13 18:46:19 2009 (4A5BC74B)\n    CheckSum:         00009326\n    ImageSize:        0000B000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n8784f000 87860000   partmgr    (pdb symbols)          c:\\symbols\\partmgr.pdb\\7CA861FF7879483ABA38CE28186F293E2\\partmgr.pdb\n    Loaded symbol image file: partmgr.sys\n    Image path: \\SystemRoot\\System32\\drivers\\partmgr.sys\n    Image name: partmgr.sys\n    Timestamp:        Sat Nov 20 02:38:14 2010 (4CE788F6)\n    CheckSum:         0001BB55\n    ImageSize:        00011000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87860000 87868000   compbatt   (pdb symbols)          c:\\symbols\\compbatt.pdb\\EE14F03B54BF49B4B62A0EF912A59C8F1\\compbatt.pdb\n    Loaded symbol image file: compbatt.sys\n    Image path: \\SystemRoot\\system32\\DRIVERS\\compbatt.sys\n    Image name: compbatt.sys\n    Timestamp:        Mon Jul 13 18:19:18 2009 (4A5BC0F6)\n    CheckSum:         00006941\n    ImageSize:        00008000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87868000 87873000   BATTC      (pdb symbols)          c:\\symbols\\battc.pdb\\53C47BEA2F08470BB58DFD1566285EC71\\battc.pdb\n    Loaded symbol image file: BATTC.SYS\n    Image path: \\SystemRoot\\system32\\DRIVERS\\BATTC.SYS\n    Image name: BATTC.SYS\n    Timestamp:        Mon Jul 13 18:19:15 2009 (4A5BC0F3)\n    CheckSum:         0000B849\n    ImageSize:        0000B000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87873000 87883000   volmgr     (pdb symbols)          c:\\symbols\\volmgr.pdb\\4AF04B598C494297B1C69F95823AA9F81\\volmgr.pdb\n    Loaded symbol image file: volmgr.sys\n    Image path: \\SystemRoot\\system32\\drivers\\volmgr.sys\n    Image name: volmgr.sys\n    Timestamp:        Sat Nov 20 02:38:06 2010 (4CE788EE)\n    CheckSum:         00016E1A\n    ImageSize:        00010000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87883000 878ce000   volmgrx    (pdb symbols)          c:\\symbols\\volmgrx.pdb\\433F00DD3CC34DE8BC3F9E4BDDACA5EE1\\volmgrx.pdb\n    Loaded symbol image file: volmgrx.sys\n    Image path: \\SystemRoot\\System32\\drivers\\volmgrx.sys\n    Image name: volmgrx.sys\n    Timestamp:        Mon Jul 13 18:11:41 2009 (4A5BBF2D)\n    CheckSum:         0004A22A\n    ImageSize:        0004B000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n878ce000 878d5000   intelide   (no symbols)           \n    Loaded symbol image file: intelide.sys\n    Image path: \\SystemRoot\\system32\\drivers\\intelide.sys\n    Image name: intelide.sys\n    Timestamp:        Mon Jul 13 18:11:19 2009 (4A5BBF17)\n    CheckSum:         00006324\n    ImageSize:        00007000\n    File version:     6.1.7600.16385\n    Product version:  6.1.7600.16385\n    File flags:       0 (Mask 3F)\n    File OS:          40004 NT Win32\n    File type:        3.7 Driver\n    File date:        00000000.00000000\n    Translations:     0409.04b0\n    CompanyName:      Microsoft Corporation\n    ProductName:      Microsoft® Windows® Operating System\n    InternalName:     intelide.sys\n    OriginalFilename: intelide.sys\n    ProductVersion:   6.1.7600.16385\n    FileVersion:      6.1.7600.16385 (win7_rtm.090713-1255)\n    FileDescription:  Intel PCI IDE Driver\n    LegalCopyright:   © Microsoft Corporation. All rights reserved.\n878d5000 878e3000   PCIIDEX    (pdb symbols)          c:\\symbols\\pciidex.pdb\\8B7BC6201128486CB5B03916EBD5FF8E1\\pciidex.pdb\n    Loaded symbol image file: PCIIDEX.SYS\n    Image path: \\SystemRoot\\system32\\drivers\\PCIIDEX.SYS\n    Image name: PCIIDEX.SYS\n    Timestamp:        Mon Jul 13 18:11:15 2009 (4A5BBF13)\n    CheckSum:         0000FC04\n    ImageSize:        0000E000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n878e3000 878f9000   mountmgr   (pdb symbols)          c:\\symbols\\mountmgr.pdb\\356DDF9839E040638E034EEA956C28F81\\mountmgr.pdb\n    Loaded symbol image file: mountmgr.sys\n    Image path: \\SystemRoot\\System32\\drivers\\mountmgr.sys\n    Image name: mountmgr.sys\n    Timestamp:        Sat Nov 20 02:38:09 2010 (4CE788F1)\n    CheckSum:         00014708\n    ImageSize:        00016000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n878f9000 87922180   vmbus      (pdb symbols)          c:\\symbols\\vmbus.pdb\\35B5AB3E6BDF4D3FA0BDC6AC31AC97FC1\\vmbus.pdb\n    Loaded symbol image file: vmbus.sys\n    Image path: \\SystemRoot\\system32\\drivers\\vmbus.sys\n    Image name: vmbus.sys\n    Timestamp:        Sat Nov 20 03:14:58 2010 (4CE79192)\n    CheckSum:         0002F9E5\n    ImageSize:        00029180\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87923000 87935000   winhv      (pdb symbols)          c:\\symbols\\winhv.pdb\\5B6B8428A8FA4152919E805179599ED31\\winhv.pdb\n    Loaded symbol image file: winhv.sys\n    Image path: \\SystemRoot\\system32\\drivers\\winhv.sys\n    Image name: winhv.sys\n    Timestamp:        Sat Nov 20 02:38:15 2010 (4CE788F7)\n    CheckSum:         00010243\n    ImageSize:        00012000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87935000 8793e000   atapi      (pdb symbols)          c:\\symbols\\atapi.pdb\\EF544461A5D5482980C2CA01640A6D621\\atapi.pdb\n    Loaded symbol image file: atapi.sys\n    Image path: \\SystemRoot\\system32\\drivers\\atapi.sys\n    Image name: atapi.sys\n    Timestamp:        Mon Jul 13 18:11:15 2009 (4A5BBF13)\n    CheckSum:         00014C06\n    ImageSize:        00009000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n8793e000 87961000   ataport    (pdb symbols)          c:\\symbols\\ataport.pdb\\C9AF9FE9166548FD86EFAC017F6023011\\ataport.pdb\n    Loaded symbol image file: ataport.SYS\n    Image path: \\SystemRoot\\system32\\drivers\\ataport.SYS\n    Image name: ataport.SYS\n    Timestamp:        Sat Nov 20 02:38:00 2010 (4CE788E8)\n    CheckSum:         0002B87F\n    ImageSize:        00023000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87961000 87979000   lsi_sas    (pdb symbols)          c:\\symbols\\lsi_sas.pdb\\FCC2DAF36299423A9765B62D750A97461\\lsi_sas.pdb\n    Loaded symbol image file: lsi_sas.sys\n    Image path: \\SystemRoot\\system32\\DRIVERS\\lsi_sas.sys\n    Image name: lsi_sas.sys\n    Timestamp:        Mon May 18 19:19:55 2009 (4A11FB2B)\n    CheckSum:         00024959\n    ImageSize:        00018000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87979000 879c1000   storport   (pdb symbols)          c:\\symbols\\storport.pdb\\1445D4DB7BA84A0081ABB729753A93942\\storport.pdb\n    Loaded symbol image file: storport.sys\n    Image path: \\SystemRoot\\system32\\DRIVERS\\storport.sys\n    Image name: storport.sys\n    Timestamp:        Thu Mar 10 21:56:00 2011 (4D799D50)\n    CheckSum:         000277A3\n    ImageSize:        00048000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n879c1000 879ca000   amdxata    (pdb symbols)          c:\\symbols\\amdxata.pdb\\5E66F230920844408A1EE389D50B6B4A1\\amdxata.pdb\n    Loaded symbol image file: amdxata.sys\n    Image path: \\SystemRoot\\system32\\drivers\\amdxata.sys\n    Image name: amdxata.sys\n    Timestamp:        Fri Mar 19 11:19:01 2010 (4BA3A3F5)\n    CheckSum:         000147B2\n    ImageSize:        00009000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n879ca000 879fe000   fltmgr     (pdb symbols)          c:\\symbols\\fltMgr.pdb\\E6CA9E082E70438988788CB58DB340B01\\fltMgr.pdb\n    Loaded symbol image file: fltmgr.sys\n    Image path: \\SystemRoot\\system32\\drivers\\fltmgr.sys\n    Image name: fltmgr.sys\n    Timestamp:        Mon Jul 13 18:11:13 2009 (4A5BBF11)\n    CheckSum:         000382A8\n    ImageSize:        00034000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87a00000 87a0e000   pcw        (pdb symbols)          c:\\symbols\\pcw.pdb\\D368300F340A423EBBA32FBDDDEC24B91\\pcw.pdb\n    Loaded symbol image file: pcw.sys\n    Image path: \\SystemRoot\\System32\\drivers\\pcw.sys\n    Image name: pcw.sys\n    Timestamp:        Mon Jul 13 18:11:10 2009 (4A5BBF0E)\n    CheckSum:         000194CF\n    ImageSize:        0000E000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87a0e000 87a17000   Fs_Rec     (pdb symbols)          c:\\symbols\\fs_rec.pdb\\3465ED05A901452FAD07E77351F094591\\fs_rec.pdb\n    Loaded symbol image file: Fs_Rec.sys\n    Image path: \\SystemRoot\\System32\\Drivers\\Fs_Rec.sys\n    Image name: Fs_Rec.sys\n    Timestamp:        Mon Jul 13 18:11:14 2009 (4A5BBF12)\n    CheckSum:         0000845A\n    ImageSize:        00009000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87a2a000 87b59000   Ntfs       (pdb symbols)          c:\\symbols\\ntfs.pdb\\6D39EA084D324936A61D6DBDE4D1172B2\\ntfs.pdb\n    Loaded symbol image file: Ntfs.sys\n    Image path: \\SystemRoot\\System32\\Drivers\\Ntfs.sys\n    Image name: Ntfs.sys\n    Timestamp:        Thu Mar 10 21:21:11 2011 (4D799527)\n    CheckSum:         0012D977\n    ImageSize:        0012F000\n    File version:     6.1.7601.17577\n    Product version:  6.1.7601.17577\n    File flags:       0 (Mask 3F)\n    File OS:          40004 NT Win32\n    File type:        3.7 Driver\n    File date:        00000000.00000000\n    Translations:     0409.04b0\n    CompanyName:      Microsoft Corporation\n    ProductName:      Microsoft® Windows® Operating System\n    InternalName:     ntfs.sys\n    OriginalFilename: ntfs.sys\n    ProductVersion:   6.1.7601.17577\n    FileVersion:      6.1.7601.17577 (win7sp1_gdr.110310-1504)\n    FileDescription:  NT File System Driver\n    LegalCopyright:   © Microsoft Corporation. All rights reserved.\n87b59000 87b84000   msrpc      (pdb symbols)          c:\\symbols\\msrpc.pdb\\B4C428CFD1024C43BD3E2B10D1A8F0711\\msrpc.pdb\n    Loaded symbol image file: msrpc.sys\n    Image path: \\SystemRoot\\System32\\Drivers\\msrpc.sys\n    Image name: msrpc.sys\n    Timestamp:        Mon Jul 13 18:11:59 2009 (4A5BBF3F)\n    CheckSum:         00036B4F\n    ImageSize:        0002B000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87b84000 87b97000   ksecdd     (pdb symbols)          c:\\symbols\\ksecdd.pdb\\A4060D19AD914446AB889720E6B7284C1\\ksecdd.pdb\n    Loaded symbol image file: ksecdd.sys\n    Image path: \\SystemRoot\\System32\\Drivers\\ksecdd.sys\n    Image name: ksecdd.sys\n    Timestamp:        Wed Nov 16 21:15:56 2011 (4EC47C6C)\n    CheckSum:         00015ED3\n    ImageSize:        00013000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87b97000 87bf4000   cng        (pdb symbols)          c:\\symbols\\cng.pdb\\E729F2E7DC70413D986258B0E44C22CC1\\cng.pdb\n    Loaded symbol image file: cng.sys\n    Image path: \\SystemRoot\\System32\\Drivers\\cng.sys\n    Image name: cng.sys\n    Timestamp:        Wed Nov 16 21:36:35 2011 (4EC48143)\n    CheckSum:         00068127\n    ImageSize:        0005D000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87c07000 87cbe000   ndis       (pdb symbols)          c:\\symbols\\ndis.pdb\\4DAAA54E2C26455DB2471D696BC8E6A62\\ndis.pdb\n    Loaded symbol image file: ndis.sys\n    Image path: \\SystemRoot\\system32\\drivers\\ndis.sys\n    Image name: ndis.sys\n    Timestamp:        Sat Nov 20 02:39:19 2010 (4CE78937)\n    CheckSum:         000BD48D\n    ImageSize:        000B7000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87cbe000 87cfc000   NETIO      (pdb symbols)          c:\\symbols\\netio.pdb\\7A33726ABE884384BFDFB951F05D13AC2\\netio.pdb\n    Loaded symbol image file: NETIO.SYS\n    Image path: \\SystemRoot\\system32\\drivers\\NETIO.SYS\n    Image name: NETIO.SYS\n    Timestamp:        Sat Nov 20 02:40:03 2010 (4CE78963)\n    CheckSum:         0003F253\n    ImageSize:        0003E000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87cfc000 87d21000   ksecpkg    (pdb symbols)          c:\\symbols\\ksecpkg.pdb\\8C991B24F8F24A96B28B8268237920CF1\\ksecpkg.pdb\n    Loaded symbol image file: ksecpkg.sys\n    Image path: \\SystemRoot\\System32\\Drivers\\ksecpkg.sys\n    Image name: ksecpkg.sys\n    Timestamp:        Wed Nov 16 21:37:34 2011 (4EC4817E)\n    CheckSum:         0002C883\n    ImageSize:        00025000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87d21000 87d60000   volsnap    (pdb symbols)          c:\\symbols\\volsnap.pdb\\1F66E7165E8F4BD982A34A9DFA1BBFD31\\volsnap.pdb\n    Loaded symbol image file: volsnap.sys\n    Image path: \\SystemRoot\\system32\\drivers\\volsnap.sys\n    Image name: volsnap.sys\n    Timestamp:        Sat Nov 20 02:38:13 2010 (4CE788F5)\n    CheckSum:         0003CA6D\n    ImageSize:        0003F000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87d60000 87d92000   fvevol     (pdb symbols)          c:\\symbols\\fvevol.pdb\\DC4549C710EE425F8956C7D82BFE83651\\fvevol.pdb\n    Loaded symbol image file: fvevol.sys\n    Image path: \\SystemRoot\\System32\\DRIVERS\\fvevol.sys\n    Image name: fvevol.sys\n    Timestamp:        Sat Nov 20 02:40:22 2010 (4CE78976)\n    CheckSum:         000390DC\n    ImageSize:        00032000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87d92000 87db7000   CLASSPNP   (pdb symbols)          c:\\symbols\\classpnp.pdb\\64A86A6AD27D4730A78ECC25166E13562\\classpnp.pdb\n    Loaded symbol image file: CLASSPNP.SYS\n    Image path: \\SystemRoot\\system32\\DRIVERS\\CLASSPNP.SYS\n    Image name: CLASSPNP.SYS\n    Timestamp:        Mon Jul 13 18:11:20 2009 (4A5BBF18)\n    CheckSum:         0002BBFE\n    ImageSize:        00025000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87e00000 87e10000   mup        (pdb symbols)          c:\\symbols\\mup.pdb\\E96F69551E2447289250F71FB5AB6E0C2\\mup.pdb\n    Loaded symbol image file: mup.sys\n    Image path: \\SystemRoot\\System32\\Drivers\\mup.sys\n    Image name: mup.sys\n    Timestamp:        Mon Jul 13 18:14:14 2009 (4A5BBFC6)\n    CheckSum:         00014283\n    ImageSize:        00010000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87e10000 87e18000   hwpolicy   (pdb symbols)          c:\\symbols\\hwpolicy.pdb\\0F041CEBADCA48F4BC65F68463272F1D1\\hwpolicy.pdb\n    Loaded symbol image file: hwpolicy.sys\n    Image path: \\SystemRoot\\System32\\drivers\\hwpolicy.sys\n    Image name: hwpolicy.sys\n    Timestamp:        Sat Nov 20 02:37:35 2010 (4CE788CF)\n    CheckSum:         0000B2B9\n    ImageSize:        00008000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87e18000 87e29000   disk       (pdb symbols)          c:\\symbols\\disk.pdb\\D2AD04F7F4BF45C8A8F0E2BF689326F11\\disk.pdb\n    Loaded symbol image file: disk.sys\n    Image path: \\SystemRoot\\system32\\DRIVERS\\disk.sys\n    Image name: disk.sys\n    Timestamp:        Mon Jul 13 18:11:28 2009 (4A5BBF20)\n    CheckSum:         000152A4\n    ImageSize:        00011000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87e3e000 87f88000   tcpip      (pdb symbols)          c:\\symbols\\tcpip.pdb\\676C275B8EAE4B50A19255B333A152BA2\\tcpip.pdb\n    Loaded symbol image file: tcpip.sys\n    Image path: \\SystemRoot\\System32\\drivers\\tcpip.sys\n    Image name: tcpip.sys\n    Timestamp:        Wed Sep 28 22:22:11 2011 (4E83E463)\n    CheckSum:         0013EA1F\n    ImageSize:        0014A000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87f88000 87fb9000   fwpkclnt   (pdb symbols)          c:\\symbols\\fwpkclnt.pdb\\FDE8223F22C54AEA8061EE56EA16A0251\\fwpkclnt.pdb\n    Loaded symbol image file: fwpkclnt.sys\n    Image path: \\SystemRoot\\System32\\drivers\\fwpkclnt.sys\n    Image name: fwpkclnt.sys\n    Timestamp:        Sat Nov 20 02:39:08 2010 (4CE7892C)\n    CheckSum:         0003B983\n    ImageSize:        00031000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87fb9000 87fc1380   vmstorfl   (pdb symbols)          c:\\symbols\\vmstorfl.pdb\\D7FD176CC0134139B2EE4BEAF352AEE41\\vmstorfl.pdb\n    Loaded symbol image file: vmstorfl.sys\n    Image path: \\SystemRoot\\system32\\drivers\\vmstorfl.sys\n    Image name: vmstorfl.sys\n    Timestamp:        Sat Nov 20 03:14:37 2010 (4CE7917D)\n    CheckSum:         000131D0\n    ImageSize:        00008380\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87fc2000 87fca000   spldr      (no symbols)           \n    Loaded symbol image file: spldr.sys\n    Image path: \\SystemRoot\\System32\\Drivers\\spldr.sys\n    Image name: spldr.sys\n    Timestamp:        Mon May 11 11:13:47 2009 (4A084EBB)\n    CheckSum:         0000767D\n    ImageSize:        00008000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n87fca000 87ff7000   rdyboost   (pdb symbols)          c:\\symbols\\rdyboost.pdb\\53BB42ABE1404332962CA2AEA8301D331\\rdyboost.pdb\n    Loaded symbol image file: rdyboost.sys\n    Image path: \\SystemRoot\\System32\\drivers\\rdyboost.sys\n    Image name: rdyboost.sys\n    Timestamp:        Sat Nov 20 03:00:07 2010 (4CE78E17)\n    CheckSum:         000394EA\n    ImageSize:        0002D000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n8ca08000 8ca49000   rdbss      (pdb symbols)          c:\\symbols\\rdbss.pdb\\A65B6296E0414A128A1951A1350D32C02\\rdbss.pdb\n    Loaded symbol image file: rdbss.sys\n    Image path: \\SystemRoot\\system32\\DRIVERS\\rdbss.sys\n    Image name: rdbss.sys\n    Timestamp:        Sat Nov 20 02:42:44 2010 (4CE78A04)\n    CheckSum:         000464DE\n    ImageSize:        00041000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n8ca49000 8ca53000   nsiproxy   (pdb symbols)          c:\\symbols\\nsiproxy.pdb\\C05F47CD56124B77BD71E3DFB669D4FF1\\nsiproxy.pdb\n    Loaded symbol image file: nsiproxy.sys\n    Image path: \\SystemRoot\\system32\\drivers\\nsiproxy.sys\n    Image name: nsiproxy.sys\n    Timestamp:        Mon Jul 13 18:12:08 2009 (4A5BBF48)\n    CheckSum:         0000939B\n    ImageSize:        0000A000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n8ca53000 8ca5d000   mssmbios   (pdb symbols)          c:\\symbols\\mssmbios.pdb\\B9453B9B745D45DE974BA45D910B78481\\mssmbios.pdb\n    Loaded symbol image file: mssmbios.sys\n    Image path: \\SystemRoot\\system32\\drivers\\mssmbios.sys\n    Image name: mssmbios.sys\n    Timestamp:        Mon Jul 13 18:19:25 2009 (4A5BC0FD)\n    CheckSum:         0000B8F6\n    ImageSize:        0000A000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n8ca5d000 8ca69000   discache   (pdb symbols)          c:\\symbols\\discache.pdb\\1F3066C30EA34CC381D3006454C11BD11\\discache.pdb\n    Loaded symbol image file: discache.sys\n    Image path: \\SystemRoot\\System32\\drivers\\discache.sys\n    Image name: discache.sys\n    Timestamp:        Mon Jul 13 18:24:04 2009 (4A5BC214)\n    CheckSum:         0000EDA3\n    ImageSize:        0000C000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n8ca69000 8cacd000   csc        (pdb symbols)          c:\\symbols\\csc.pdb\\A6CAEC9D41C74DECA0E523C20AAB9A4F2\\csc.pdb\n    Loaded symbol image file: csc.sys\n    Image path: \\SystemRoot\\system32\\drivers\\csc.sys\n    Image name: csc.sys\n    Timestamp:        Sat Nov 20 02:44:32 2010 (4CE78A70)\n    CheckSum:         00065355\n    ImageSize:        00064000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n8cacd000 8cae5000   dfsc       (pdb symbols)          c:\\symbols\\dfsc.pdb\\52BC36B80CED4847964EF156BC67E96E1\\dfsc.pdb\n    Loaded symbol image file: dfsc.sys\n    Image path: \\SystemRoot\\System32\\Drivers\\dfsc.sys\n    Image name: dfsc.sys\n    Timestamp:        Sat Nov 20 02:42:32 2010 (4CE789F8)\n    CheckSum:         00015073\n    ImageSize:        00018000\n    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4\n...\n</code></pre>\n</div>",
            "votes": "3",
            "user": "Jason Geffner",
            "time": "Jul 28, 2015 at 15:27",
            "is_accepted": true,
            "comments": [
                {
                    "user": "rebel87",
                    "text": "<span class=\"comment-copy\">Thankyou Jason I asked two questions because they were interlinked</span>",
                    "time": null
                },
                {
                    "user": "rebel87",
                    "text": "<span class=\"comment-copy\">Next time Ill keep it in mind to ssk a single question. ..</span>",
                    "time": null
                }
            ]
        },
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>if you have windbg installed open a command prompt and execute </p>\n<p>C:&gt;cdb -c \"!address;.attach -k;g;!address;.detach;q\" calc</p>\n<pre><code>    0:000&gt; cdb: Reading initial command '!address;.attach -k;g;!address;.detach;q'\n\n      BaseAddr EndAddr+1 RgnSize     Type       State                 Protect             Usage\n    -------------------------------------------------------------------------------------------\n    *        0    10000    10000             MEM_FREE    PAGE_NOACCESS                      Free\n    *    10000    12000     2000 MEM_PRIVATE MEM_COMMIT  PAGE_READWRITE                     &lt;unclassified&gt;\n    *    12000    20000     e000             MEM_FREE    PAGE_NOACCESS                      Free\n    *    20000    21000     1000 MEM_PRIVATE MEM_COMMIT  PAGE_READWRITE                     &lt;unclassified&gt;\n\n    snip--------------------------------\nPAGE_NOACCESS                      Free\n    * 7ffb0000 7ffd4000    24000 MEM_MAPPED  MEM_COMMIT  PAGE_READONLY                      MemoryMappedFile \"PageFile\"\n    * 7ffd4000 7ffdc000     8000             MEM_FREE    PAGE_NOACCESS                      Free\n    * 7ffdc000 7ffdd000     1000 MEM_PRIVATE MEM_COMMIT  PAGE_READWRITE                     PEB [35c]\n    * 7ffdd000 7ffdf000     2000             MEM_FREE    PAGE_NOACCESS                      Free\n    * 7ffdf000 7ffe0000     1000 MEM_PRIVATE MEM_COMMIT  PAGE_READWRITE                     TEB [35c.d0; ~0]\n    * 7ffe0000 7ffe1000     1000 MEM_PRIVATE MEM_COMMIT  PAGE_READONLY                      &lt;unclassified&gt;\n    |-7ffe1000 7fff0000     f000 MEM_PRIVATE MEM_RESERVE PAGE_NOACCESS                      &lt;unclassified&gt;\n\n    Attach will occur on next execution\n    WARNING: Local kernel debugging requires booting with kernel\n    debugging support (/debug or bcdedit -debug on) to work optimally.\n\n      804d7000 - 001f9000\n              Usage       KernelSpaceUsageImage\n              ImageName   ntkrnlpa.exe\n\n      81ec6000 - 00df0000\n              Usage       KernelSpaceUsagePFNDatabase\n\n      82cb6000 - 08000000\n              Usage       KernelSpaceUsageNonPagedPool\n\n      a71b7000 - 00004000\n              Usage       KernelSpaceUsageKernelStack\n              KernelStack 8ab4eda8 : 23c.6a8\n\nsnip-----------------------------------------------------------\n      ba5a0000 - 00004000\n              Usage       KernelSpaceUsageKernelStack\n              KernelStack 8a717020 : 4.140\n\n      ba5a4000 - 00004000\n              Usage       KernelSpaceUsageKernelStack\n              KernelStack 8aac0bd8 : 190.1b8\n\n      bb800000 - 00400000\n              Usage       KernelSpaceUsageSessionPool\n\n      bbc00000 - 03400000\n              Usage       KernelSpaceUsageSessionView\n\n      bf000000 - 01000000\n              Usage       KernelSpaceUsageSessionImage\n\n      c1200000 - 1fe00000\n              Usage       KernelSpaceUsageSystemCache\n\n      e1000000 - 16800000\n              Usage       KernelSpaceUsagePagedPool\n\n      f7be0000 - 08000000\n              Usage       KernelSpaceUsageNonPagedPoolExpansion\n\n    Detached\n    quit:\n\n    C:\\&gt;\n</code></pre>\n</div>",
            "votes": "2",
            "user": "blabb",
            "time": "Jul 28, 2015 at 20:07",
            "is_accepted": false,
            "comments": [
                {
                    "user": "rebel87",
                    "text": "<span class=\"comment-copy\">thank you blabb, it shows the memory map not the contents but nevertheless I will not have to use the vmap tool from now onwards.. :-)</span>",
                    "time": null
                }
            ]
        },
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>Kernel mode memory is not process-specific. It is identical for all processes. </p>\n<p>ntoskrnl.exe is not a process in itself. It is kernel image. Microsoft decided to use same file-format (PE) for the kernel image, as they use for other executables. Kernel image is shared by all processes. </p>\n</div>",
            "votes": "0",
            "user": "Israr Khan",
            "time": "Sep 17, 2015 at 23:10",
            "is_accepted": false,
            "comments": []
        }
    ]
}