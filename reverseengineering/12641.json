{
    "title": "Extracting textures from a file (Gamecube game)",
    "link": "https://reverseengineering.stackexchange.com/questions/12641/extracting-textures-from-a-file-gamecube-game",
    "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>There is a gamecube videogame (called Winning Eleven) which i want to translate, but i had no success in extracting the textures out of the files which contain them.</p>\n<p>I have tried several tools, one of them was a tool for a specific gamecube game (Mario Sunshine iirc), but it didnt work out, most likely because it uses a different, unique decompression method.</p>\n<p>The files which contain the textures are .bin files, which i extracted from so called .txs files with the help of a zlib tool.</p>\n<p>I would really appreciate it if someone, who is knowledgable in this matter, could take a look into this file.</p>\n<p>Someone might recognize it or even knows already how to work this out.</p>\n<p>I uploaded 4 of those bin files which ive extracted out of the txs file, and i also added a tool called AFS Explorer.</p>\n<p>Download Link:\n<a href=\"http://s000.tinyupload.com/download.php?file_id=30125217858357016099&amp;t=3012521785835701609927187\" rel=\"nofollow noreferrer\">http://s000.tinyupload.com/download.php?file_id=30125217858357016099&amp;t=3012521785835701609927187</a></p>\n<p>To extract the bin files i used the built-in Zlib Manager of the AFS Explorer.</p>\n<p>How to open and explore txs files:</p>\n<ol>\n<li>Open the AFS Explorer</li>\n<li>Go to \"View\" on the top bar and choose \"Zlib Manager\"</li>\n<li>Choose \"Load sections from file\" and open the txs file.</li>\n</ol>\n<p>Im just mentioning this for you to see how the bin files were extracted in first place, for a better understanding.</p>\n<p>I would appreciate it a lot if you could help me to work this out.</p>\n<p><strong>Edit</strong>: \nThose are definitely no animations, just normal bitmaps with texts as content. I can even show you how they look like, these are from the PS2 Version of the same game, form the exact same file named \"form.txs\", the only difference obviously being that the PS2 Version uses a different compression method which was already discovered. </p>\n<ul>\n<li><a href=\"https://i.sstatic.net/RL1tC.png\" rel=\"nofollow noreferrer\">https://i.sstatic.net/RL1tC.png</a></li>\n<li><a href=\"https://i.sstatic.net/RmX43.png\" rel=\"nofollow noreferrer\">https://i.sstatic.net/RmX43.png</a></li>\n<li><a href=\"https://i.sstatic.net/oEhSe.png\" rel=\"nofollow noreferrer\">https://i.sstatic.net/oEhSe.png</a></li>\n<li><a href=\"https://i.sstatic.net/uUM9u.png\" rel=\"nofollow noreferrer\">https://i.sstatic.net/uUM9u.png</a></li>\n</ul>\n<p>There are several tools which work with the PS2 files, but not a single of them with the NGC files, obviously because of the format differences.</p>\n<p>Edit 2:</p>\n<p>Ive uploaded a Texture Tool which works with the PS2 bin files, but obviously not with the GameCube ones. Despite searching intensively for it (also on old archived websites), i couldnt find the sourcecode of this texture tool. But i thought i still should upload it, it might help too.\nI hope tinyupload.com is ok for uploads.</p>\n<p>Download Link:\n<a href=\"http://s000.tinyupload.com/index.php?file_id=92363414871112387548\" rel=\"nofollow noreferrer\">http://s000.tinyupload.com/index.php?file_id=92363414871112387548</a></p>\n</div>",
    "votes": "3",
    "answers": 1,
    "views": "3k",
    "tags": [
        "file-format",
        "decompress"
    ],
    "user": "Lenko",
    "time": "Jun 8, 2016 at 5:13",
    "comments": [],
    "answers_data": [
        {
            "content": "<div class=\"s-prose js-post-body\" itemprop=\"text\">\n<p>This looks .. interesting.</p>\n<p>When i open the first and second of your files in a hex editor, one has 20240 bytes, the other has 10240 bytes (all numbers in hex). So, 2^16+220 in one case, 2^17+220 in the other case.</p>\n<p>Both files have data that \"looks a certain way\" in their first 240 bytes, then the data starts looking differently. Example:</p>\n<p><a href=\"https://i.sstatic.net/nEnnb.png\"><img alt=\"enter image description here\" src=\"https://i.sstatic.net/nEnnb.png\"/></a></p>\n<p>To me, this smells like:</p>\n<p>0000-003F metadata, whatever\n0040-0240 palette; probably 256d entries of 2 bytes, 565 encoding?\nrest      image data</p>\n<p>Notice how regular the pattern looks when you set the width of the hex display. This seems to be a 20x20 (32x32 decimal) pixel bitmap. However, looking further down in the file, there seem to be other widths as well.</p>\n<p>So no, this is not a recognizable (by me) format, but it shouldn't be too hard to decode it.</p>\n<p>The other 2 files seem to have a different format, they're only 30 bytes larger than a power of 2, and there's not a distinct pattern change 30 bytes into the file. Not sure what to make of that, yet.</p>\n<p>Edit:</p>\n<p>Interpreting the image data of the AFS73DB.tmp_0.bin file as 32x128 tiles and placing them next to each other yields (some parts omitted):</p>\n<p><a href=\"https://i.sstatic.net/G5iUT.png\"><img alt=\"enter image description here\" src=\"https://i.sstatic.net/G5iUT.png\"/></a></p>\n<p>This looks to me like an animation, maybe of an explosion or something similar. The colors are probably way off, though. Does this ring any bells? Do you have a screenshot or two how this should look on the Gamecube?</p>\n<p>Also, it seems that the lower part of the texture isn't used and thus filled with random bytes.</p>\n<p>If you want to check out my attempt at a decoder, check <a href=\"https://github.com/gbl/GamecubeTextureDisplay\">https://github.com/gbl/GamecubeTextureDisplay</a>.</p>\n<p>Edit2:</p>\n<p>Having an example what the output should look like helped, a lot, and i was able to update my decoder.</p>\n<p>Each block of 32 input bytes is stored as an 8x4 pixel block in the output, with the next block to the right of it, until the whole line length is reached, like this:</p>\n<pre><code>00 01 02 03 04 05 06 07     20 21 22 23 24 25 26 27   ....\n08 09 0a 0b 0c 0d 0e 0f     28 29 2a 2b 2c 2d 2e 2f \n10 11 12 13 14 15 16 17     .....\n18 19 1a 1b 1c 1d 1e 1f\n</code></pre>\n<p>Each palette entry seems to be a big endian 2-byte word, with the msb unknown (alpha value?), followed by 5 bits for red, green, blue. So for example a palette entry <code>8CE2</code> translates to <code>1000 1100 1110 0010</code>, split to <code>1|00011|00111|00010|</code>, resulting (when the individual colors are filled to 8 bit) in <code>r=00011000=24</code>, <code>g=00111000=56</code>, <code>b=00010000=16</code>.</p>\n<p>Using this, your files result in</p>\n<p><a href=\"https://i.sstatic.net/KJw23.png\"><img alt=\"enter image description here\" src=\"https://i.sstatic.net/KJw23.png\"/></a>\n<a href=\"https://i.sstatic.net/6GEXJ.png\"><img alt=\"enter image description here\" src=\"https://i.sstatic.net/6GEXJ.png\"/></a></p>\n<p>which looks quite good. However, there are some red pixels in the first image that shouldn't be there, and the letters in the second one almost look like 3D letters with their shifted green/red pixels. Could this have to do with an alpha value?</p>\n<p>Still not sure what to make of the b/w pictures.</p>\n<p>(to be continued)</p>\n</div>",
            "votes": "7",
            "user": "Guntram Blohm",
            "time": "May 14, 2016 at 18:21",
            "is_accepted": false,
            "comments": [
                {
                    "user": "Guntram Blohm",
                    "text": "<span class=\"comment-copy\">Just edit the question if you have more information to share. The image files are interesting: the color files have 1 byte/pixel + 512 bytes (palette?) + 64 bytes header. The b&amp;w files have 1 nibble/pixel + 32 bytes (greyscale palette??) + 64 bytes header. So they definitely aren't compressed. Information like this helps tremendously, even though i can't make sense of the format, yet.</span>",
                    "time": null
                }
            ]
        }
    ]
}